<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
    <meta charset="utf-8">
    <meta name="generator" content="quarto-1.7.3">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


    <title>Supply Chain Data Analytics</title>
    <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      div.columns{display: flex; gap: min(4vw, 1.5em);}
      div.column{flex: auto; overflow-x: auto;}
      div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
      ul.task-list{list-style: none;}
      ul.task-list li input[type="checkbox"] {
        width: 0.8em;
        margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
        vertical-align: middle;
      }
      /* CSS for syntax highlighting */
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
        }
      pre.numberSource { margin-left: 3em;  padding-left: 4px; }
      div.sourceCode
        {   }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
    </style>

    <style>
      body.hypothesis-enabled #quarto-embed-header {
        padding-right: 36px;
      }

      #quarto-embed-header {
        height: 3em;
        width: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: solid 1px;
      }

      #quarto-embed-header h6 {
        font-size: 1.1em;
        padding-top: 0.6em;
        margin-left: 1em;
        margin-right: 1em;
        font-weight: 400;
      }

      #quarto-embed-header a.quarto-back-link,
      #quarto-embed-header a.quarto-download-embed {
        font-size: 0.8em;
        margin-top: 1em;
        margin-bottom: 1em;
        margin-left: 1em;
        margin-right: 1em;
      }

      .quarto-back-container {
        padding-left: 0.5em;
        display: flex;
      }

      .headroom {
          will-change: transform;
          transition: transform 200ms linear;
      }

      .headroom--pinned {
          transform: translateY(0%);
      }

      .headroom--unpinned {
          transform: translateY(-100%);
      }      
    </style>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script>
    window.document.addEventListener("DOMContentLoaded", function () {

      var header = window.document.querySelector("#quarto-embed-header");
      const titleBannerEl = window.document.querySelector("body > #title-block-header");
      if (titleBannerEl) {
        titleBannerEl.style.paddingTop = header.clientHeight + "px";
      }
      const contentEl = window.document.getElementById('quarto-content');
      for (const child of contentEl.children) {
        child.style.paddingTop = header.clientHeight + "px";
        child.style.marginTop = "1em";
      }

      // Use the article root if the `back` call doesn't work. This isn't perfect
      // but should typically work
      window.quartoBackToArticle = () => {
        var currentUrl = window.location.href;
        window.history.back();
        setTimeout(() => {
            // if location was not changed in 100 ms, then there is no history back
            if(currentUrl === window.location.href){              
                // redirect to site root
                window.location.href = "index.html";
            }
        }, 100);
      }

      const headroom = new window.Headroom(header, {
        tolerance: 5,
        onPin: function () {
        },
        onUnpin: function () {
        },
      });
      headroom.init();
    });
    </script>

    
<script src="site_libs/manuscript-notebook/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-81b5c3e63835cfde897ecd3d35a35a41.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-e1e378e796bdd1aa61cf7dc9c87af473.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
     <script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>  
      </head>

  <body class="quarto-notebook">
    <div id="quarto-embed-header" class="headroom fixed-top bg-primary">
      
      <a onclick="window.quartoBackToArticle(); return false;" class="btn btn-primary quarto-back-link" href=""><i class="bi bi-caret-left"></i> Back to Article</a>
      <h6><i class="bi bi-journal-code"></i> Supply Chain Data Analytics</h6>

            <a href="./index.out 3.ipynb" class="btn btn-primary quarto-download-embed" download="index.out 3.ipynb">Download Notebook</a>
          </div>

     <header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Supply Chain Data Analytics</h1>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
        
        <div class="quarto-title-meta">

                
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      </div>
    </div>



    <div class="quarto-other-links-text-target">
    </div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#forecasting-method-evaluation" id="toc-forecasting-method-evaluation" class="nav-link active" data-scroll-target="#forecasting-method-evaluation">4 Forecasting Method Evaluation</a>
  <ul class="collapse">
  <li><a href="#forecasting-top-3-product-categories-4a" id="toc-forecasting-top-3-product-categories-4a" class="nav-link" data-scroll-target="#forecasting-top-3-product-categories-4a">Forecasting top 3 product categories (4a)</a></li>
  </ul></li>
  <li><a href="#applying-to-all-data-5b" id="toc-applying-to-all-data-5b" class="nav-link" data-scroll-target="#applying-to-all-data-5b">Applying to all data (5b)</a></li>
  <li><a href="#forecast-interpretation" id="toc-forecast-interpretation" class="nav-link" data-scroll-target="#forecast-interpretation">6 Forecast interpretation</a></li>
  <li><a href="#forecasting" id="toc-forecasting" class="nav-link" data-scroll-target="#forecasting">Forecasting??</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">      

       <div id="4e831d69-8081-4574-82b0-3321713ddae1" class="cell markdown">
<p>Analyzing and Forcasting Supermarket Sales</p>
<p>Stan Brouwer (2671939) (Vrije Universiteit)<br>
Liz Chen (2840693) (Master TSCM)<br>
Maaike Lamberts (2854979) (Supply Chain Data analysis)<br>
Niek Schroor (Group 10)<br>
December 11, 2024</p>
<section id="data-selection" class="level2">
<h2 class="anchored" data-anchor-id="data-selection">1 Data selection</h2>
<p>We analyze, forecast and interpret the <a href="https://public.tableau.com/app/sample-data/sample_-_superstore.xls">Superstore sales</a> provided by <a href="https://public.tableau.com/app/learn/sample-data">Tableau</a> using different statistical and machine learning methods.</p>
<p>The dataset provided contains information about products, sales and profits of a fictitious US company. The dataset contains about 10,000 rows with 1,850 unique product names and 17 product subcategories, covering four consecutive years on a daily basis.</p>
<p>We describe our work in the PDF version. However, we would like to recommend reading our quarto manuscript <em>here</em> as it contains the <strong>relevant</strong> R code in the Article Notebook.</p>
</section>
<section id="data-pre-processing" class="level2">
<h2 class="anchored" data-anchor-id="data-pre-processing">2 Data Pre-processing</h2>
<p>The superstore data set we selected is of high quality: At first glance (which needs to be verified during the visualization), the data appears to have been recorded regularly and without interruptions. There is no sign of a sudden structural change. Since the data are consumer products, it should contain both trends and seasonality. Nevertheless, we have included hypothetical steps to demonstrate our understanding of the data preprocessing procedure. In detail, we did:</p>
</section>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [2]:</pre></div><div id="c5fb0b7c-537d-4672-aebc-5a49e2c77d2f" class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clear workspace</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>rm(<span class="bu">list</span> <span class="op">=</span> ls())</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to load (and install if necessary) dependencies</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>install_and_load <span class="op">&lt;-</span> function(packages) {</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  install.packages(setdiff(packages, rownames(installed.packages())), dependencies <span class="op">=</span> TRUE)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  invisible(lapply(packages, require, character.only <span class="op">=</span> TRUE))</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>install_and_load(c(<span class="st">"tidyverse"</span>, <span class="st">"readxl"</span>, <span class="st">"ggplot2"</span>, <span class="st">"lubridate"</span>, <span class="st">"stats"</span>, <span class="st">"Amelia"</span>,<span class="st">"forecast"</span>, <span class="st">"tseries"</span>, <span class="st">"plotly"</span>, <span class="st">"stringr"</span>, <span class="st">"knitr"</span>, <span class="st">"kableExtra"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: tidyverse── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors
Loading required package: readxl

Loading required package: AmeliaWarning: package 'Amelia' was built under R version 4.3.3Loading required package: Rcpp
## 
## Amelia II: Multiple Imputation
## (Version 1.8.3, built: 2024-11-07)
## Copyright (C) 2005-2024 James Honaker, Gary King and Matthew Blackwell
## Refer to http://gking.harvard.edu/amelia/ for more information
## 
Loading required package: forecastWarning: package 'forecast' was built under R version 4.3.3Registered S3 method overwritten by 'quantmod':
  method            from
  as.zoo.data.frame zoo 
Loading required package: tseriesWarning: package 'tseries' was built under R version 4.3.3Loading required package: plotly

Attaching package: 'plotly'

The following object is masked from 'package:ggplot2':

    last_plot

The following object is masked from 'package:stats':

    filter

The following object is masked from 'package:graphics':

    layout

Loading required package: knitrWarning: package 'knitr' was built under R version 4.3.3Loading required package: kableExtra

Attaching package: 'kableExtra'

The following object is masked from 'package:dplyr':

    group_rows</code></pre>
</div>
</div></div>
<div id="585b2374-c87d-42a2-b6c2-aa6c5aa224c0" class="cell markdown">
<ul>
<li>Remove whitespaces from column names</li>
<li>Remove the <code>Row_ID</code> column as it can be inferred by it’s index</li>
<li>Remove all columns with a single unique value, as storing these would be <a href="https://few.vu.nl/~molenaar/courses/StatR/chapters/B-06-raw_data.html">redundant</a></li>
<li>Ensure machine-readable date formats in <code>yyyy-mm-dd</code> as these usually differ per locale.</li>
<li>Ensure proper decimal separators</li>
<li>Calculate the number of missing values (both NA and empty string ““) per column.</li>
</ul>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [4]:</pre></div><div id="31c8f8a8-a6a7-4c20-8c37-76fc911f737f" class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>suppressWarnings({data <span class="op">&lt;-</span> read_excel(<span class="st">"data/sample_-_superstore.xls"</span>)}) <span class="co"># The Postal code column is stored as 'text' but coerced to numeric, causing warnings which we suppress</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Improve column names</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>colnames(data) <span class="op">&lt;-</span> str_replace_all(colnames(data), <span class="st">" "</span>, <span class="st">"_"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>colnames(data) <span class="op">&lt;-</span> str_replace_all(colnames(data), <span class="st">"-"</span>, <span class="st">"_"</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the 'Row_ID' column as it can be inferred by it's index</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>data <span class="op">&lt;-</span> subset(data, select <span class="op">=</span> <span class="op">-</span>`Row_ID`)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove all columns that have only one unique value, as storing these would be redundant</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>data <span class="op">&lt;-</span> data[, sapply(data, function(col) length(unique(col)) <span class="op">&gt;</span> <span class="dv">1</span>)]</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure a machine-readable date format as these are usually horrible in excel files</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>data$Order_Date <span class="op">&lt;-</span> <span class="im">as</span>.Date(data$Order_Date, <span class="bu">format</span> <span class="op">=</span> <span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st">"</span>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>data$Ship_Date <span class="op">&lt;-</span> <span class="im">as</span>.Date(data$Ship_Date, <span class="bu">format</span> <span class="op">=</span> <span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st">"</span>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co"># The readxl package by default uses the correct decimal separator (as opposed to base R)</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the number of missing values per column.</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Origional dates and R date objects are in unix time, which return NA when compared to text (empty string). These dates are stored as 'double' datatype, Thus we check character columns for empty strings, and all columns for NA values. </span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>missing_values <span class="op">&lt;-</span> sapply(data, function(col) {</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (inherits(col, <span class="st">"Date"</span>)) {</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="bu">sum</span>(<span class="kw">is</span>.na(col))</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">is</span>.character(col)) {</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    <span class="bu">sum</span>(<span class="kw">is</span>.na(col) <span class="op">|</span> col <span class="op">==</span> <span class="st">""</span>)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">sum</span>(<span class="kw">is</span>.na(col))</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="co"># sum(missing_values) returns 0!</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Optionally, print the missing values as a nice table</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>missing_values_table <span class="op">&lt;-</span> data.frame(</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>  Column <span class="op">=</span> names(missing_values),</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>  Missing_or_Empty <span class="op">=</span> missing_values</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that there are no missing values, thus we do not print them</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="co"># kable(missing_values_table, caption = "Missing or Empty Values in Columns", format = "pipe")</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>rm(missing_values, missing_values_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div id="37e959cd-6cbd-4cd3-8e7e-f8cd5b126d83" class="cell markdown">
<p>After these steps (and transposing the table for better document formatting), the data looks as follows:</p>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [6]:</pre></div><div id="c37dda8b-11d7-4061-af53-9331c854b2ce" class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>kable(t(head(data, <span class="dv">3</span>)), caption <span class="op">=</span> <span class="st">"First 3 Rows of the Data (Transposed)"</span>, <span class="bu">format</span> <span class="op">=</span> <span class="st">"markdown"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

</div>
</div></div>
<div id="4bcaa549-5b61-4a12-9e9c-76fa03ce2114" class="cell markdown">
<p>We did not find any missing values, confirming the quality of the data set. There is some more processing to do, for instance the removal of outliers. However, by doing so we impose our own assumptions on the data. Let’s start by evaluating the descriptive statistics of our data and check if further processing is required.</p>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [8]:</pre></div><div id="db6f500f-91c7-4960-880f-beb33a316e83" class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>descriptive_statistics <span class="op">&lt;-</span> function(column) {</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="kw">is</span>.numeric(column)) {</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    stats <span class="op">&lt;-</span> <span class="bu">list</span>(</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>      Min <span class="op">=</span> <span class="bu">min</span>(column, na.rm <span class="op">=</span> TRUE), <span class="co"># Note that handling NA values increases robustness (and I copied the funciton from some of my earlier work)</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>      Max <span class="op">=</span> <span class="bu">max</span>(column, na.rm <span class="op">=</span> TRUE),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>      Mean <span class="op">=</span> mean(column, na.rm <span class="op">=</span> TRUE),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>      Median <span class="op">=</span> median(column, na.rm <span class="op">=</span> TRUE),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>      StdDev <span class="op">=</span> sd(column, na.rm <span class="op">=</span> TRUE)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (inherits(column, <span class="st">"Date"</span>)) {</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    stats <span class="op">&lt;-</span> <span class="bu">list</span>(</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>      Earliest <span class="op">=</span> <span class="bu">format</span>(<span class="bu">min</span>(column, na.rm <span class="op">=</span> TRUE), <span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st">"</span>),</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>      Latest <span class="op">=</span> <span class="bu">format</span>(<span class="bu">max</span>(column, na.rm <span class="op">=</span> TRUE), <span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st">"</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">is</span>.character(column)) {</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    stats <span class="op">&lt;-</span> <span class="bu">list</span>(</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>      Unique <span class="op">=</span> length(unique(column)),</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>      Mode <span class="op">=</span> names(sort(table(column), decreasing <span class="op">=</span> TRUE)[<span class="dv">1</span>])</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    stats <span class="op">&lt;-</span> NULL</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span>(stats)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Call function on dataframe</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>descriptive_stats <span class="op">&lt;-</span> lapply(data, descriptive_statistics)</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate to tables dependent on data type</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>numeric_stats <span class="op">&lt;-</span> <span class="im">as</span>.data.frame(do.call(rbind, lapply(names(data), function(col_name) {</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="kw">is</span>.numeric(data[[col_name]])) {</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    c(Column <span class="op">=</span> col_name, descriptive_stats[[col_name]])</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>})), stringsAsFactors <span class="op">=</span> FALSE)</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>date_stats <span class="op">&lt;-</span> <span class="im">as</span>.data.frame(do.call(rbind, lapply(names(data), function(col_name) {</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (inherits(data[[col_name]], <span class="st">"Date"</span>)) {</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>    c(Column <span class="op">=</span> col_name, descriptive_stats[[col_name]])</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>})), stringsAsFactors <span class="op">=</span> FALSE)</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>character_stats <span class="op">&lt;-</span> <span class="im">as</span>.data.frame(do.call(rbind, lapply(names(data), function(col_name) {</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="kw">is</span>.character(data[[col_name]])) {</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>    c(Column <span class="op">=</span> col_name, descriptive_stats[[col_name]])</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>})), stringsAsFactors <span class="op">=</span> FALSE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [9]:</pre></div><div id="146bde98-3186-4212-9cc1-67b5ee969af4" class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>kable(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  numeric_stats,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  caption <span class="op">=</span> <span class="st">"Descriptive Statistics for Numeric Columns"</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="bu">format</span> <span class="op">=</span> <span class="st">"pipe"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
</div></div>
<div id="490404c5-b39a-4494-926f-a028b2a5b13b" class="cell markdown">
<p>We inspect the orders with the lowest and highest Sales amount (in USD). The most expensive orders were professional printers, cameras and teleconferencing units with high unit prices. The orders with the lowest sales amount were often binders and had a high Discount rate.</p>
<p>Interestingly there are orders with a negative profit. They typically have high Discount rates and often concern the same item, such as the “Cubify CubeX 3D Printer Triple Head Print”. The orders with a negative Profit were often part of a larger order (for instance CA-2016-108196), and placed by customers with multiple orders. We suspect these negative Profit’s to be caused by items of lower quality that receive discounts, general discount codes, or volume discounts. However, due to the high discounts especially on orders with negative profit, we assume these to be valid orders.</p>
<p>** Some negative profit products **</p>
<p>In figure x we plotted the quantities of the most sold products. Unfortunately, the sold quantities of individual products were too low to determine any meaningful trends.</p>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [11]:</pre></div><div id="b8c249ca-c6b2-488b-b976-bb04b6f98f61" class="cell" data-warnng="false">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Optionally: print top 10 sale quantity barplot</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># # Sum of Quantity for top products</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># top_products &lt;- data %&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(Product_Name) %&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarize(total_quantity = sum(Quantity, na.rm = TRUE)) %&gt;%</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   arrange(desc(total_quantity)) %&gt;%</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   slice_head(n = 10) %&gt;% </span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(ProdName8 = substr(Product_Name, 1, 8)) # Truncate product names to the first 8 characters. Long names mess up formatting</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co"># # Plot</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(top_products, aes(x = reorder(ProdName8, -total_quantity), y = total_quantity)) +</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_bar(stat = "identity", fill = "steelblue") +</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title = "Top 20 Most Sold Products",</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">#        x = "Product ID",</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co">#        y = "Total Quantity") +</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal() +</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   coord_flip()</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate quantity by Product Name and Order Date to create a time series</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>time_series_data <span class="op">&lt;-</span> data <span class="op">%&gt;%</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  group_by(Product_Name, Order_Date) <span class="op">%&gt;%</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  summarize(total_quantity <span class="op">=</span> <span class="bu">sum</span>(Quantity, na.rm <span class="op">=</span> TRUE)) <span class="op">%&gt;%</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  ungroup()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Product_Name'. You can override using the
`.groups` argument.</code></pre>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [12]:</pre></div><div id="85f09d31-5e0d-4e29-8ed4-5118d65c16b7" class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot interactive figure in html, plot ggplot2 in pdf:</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating the ggplotly object</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>p_ly <span class="op">&lt;-</span> ggplotly(ggplot(filtered_time_series_data, aes(x <span class="op">=</span> Order_Date, y <span class="op">=</span> total_quantity, color <span class="op">=</span> ProdName10)) <span class="op">+</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  geom_line(size <span class="op">=</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  labs(title <span class="op">=</span> <span class="st">"Quantity Sold Over Time per Product"</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>       x <span class="op">=</span> <span class="st">"Order Date"</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>       y <span class="op">=</span> <span class="st">"Quantity Sold"</span>) <span class="op">+</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  theme_minimal() <span class="op">+</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  theme(legend.position <span class="op">=</span> <span class="st">"bottom"</span>) <span class="op">+</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  scale_color_discrete(name <span class="op">=</span> <span class="st">"Product Name"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-fb2edfeca71fa7663c1f" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-fb2edfeca71fa7663c1f">{"x":{"data":[{"x":[16164,16213,16299,16353,16371,16679,16709,16731,16732,16892,16941,16957,17075,17087,17122,17237,17270,17277,17419,17426],"y":[2,5,4,1,2,4,5,1,4,1,2,6,4,7,3,9,3,3,2,3],"text":["Order_Date: 2014-04-04<br />total_quantity:  2<br />ProdName10: Avery Non-","Order_Date: 2014-05-23<br />total_quantity:  5<br />ProdName10: Avery Non-","Order_Date: 2014-08-17<br />total_quantity:  4<br />ProdName10: Avery Non-","Order_Date: 2014-10-10<br />total_quantity:  1<br />ProdName10: Avery Non-","Order_Date: 2014-10-28<br />total_quantity:  2<br />ProdName10: Avery Non-","Order_Date: 2015-09-01<br />total_quantity:  4<br />ProdName10: Avery Non-","Order_Date: 2015-10-01<br />total_quantity:  5<br />ProdName10: Avery Non-","Order_Date: 2015-10-23<br />total_quantity:  1<br />ProdName10: Avery Non-","Order_Date: 2015-10-24<br />total_quantity:  4<br />ProdName10: Avery Non-","Order_Date: 2016-04-01<br />total_quantity:  1<br />ProdName10: Avery Non-","Order_Date: 2016-05-20<br />total_quantity:  2<br />ProdName10: Avery Non-","Order_Date: 2016-06-05<br />total_quantity:  6<br />ProdName10: Avery Non-","Order_Date: 2016-10-01<br />total_quantity:  4<br />ProdName10: Avery Non-","Order_Date: 2016-10-13<br />total_quantity:  7<br />ProdName10: Avery Non-","Order_Date: 2016-11-17<br />total_quantity:  3<br />ProdName10: Avery Non-","Order_Date: 2017-03-12<br />total_quantity:  9<br />ProdName10: Avery Non-","Order_Date: 2017-04-14<br />total_quantity:  3<br />ProdName10: Avery Non-","Order_Date: 2017-04-21<br />total_quantity:  3<br />ProdName10: Avery Non-","Order_Date: 2017-09-10<br />total_quantity:  2<br />ProdName10: Avery Non-","Order_Date: 2017-09-17<br />total_quantity:  3<br />ProdName10: Avery Non-"],"type":"scatter","mode":"lines","line":{"width":3.7795275590551185,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"Avery Non-","legendgroup":"Avery Non-","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","visible":true,"frame":null},{"x":[16195,16225,16262,16315,16328,16370,16375,16444,16487,16516,16536,16584,16618,16629,16704,16728,16756,16768,16789,16831,16861,16942,16956,17014,17019,17026,17075,17131,17139,17140,17227,17245,17262,17325,17326,17355,17416,17426,17452,17458,17466,17475,17476,17509],"y":[1,2,5,3,3,3,5,3,4,4,2,3,3,2,5,2,3,4,4,5,1,2,3,2,2,3,1,7,4,1,6,2,3,3,4,4,9,3,3,3,7,3,5,3],"text":["Order_Date: 2014-05-05<br />total_quantity:  1<br />ProdName10: Easy-stapl","Order_Date: 2014-06-04<br />total_quantity:  2<br />ProdName10: Easy-stapl","Order_Date: 2014-07-11<br />total_quantity:  5<br />ProdName10: Easy-stapl","Order_Date: 2014-09-02<br />total_quantity:  3<br />ProdName10: Easy-stapl","Order_Date: 2014-09-15<br />total_quantity:  3<br />ProdName10: Easy-stapl","Order_Date: 2014-10-27<br />total_quantity:  3<br />ProdName10: Easy-stapl","Order_Date: 2014-11-01<br />total_quantity:  5<br />ProdName10: Easy-stapl","Order_Date: 2015-01-09<br />total_quantity:  3<br />ProdName10: Easy-stapl","Order_Date: 2015-02-21<br />total_quantity:  4<br />ProdName10: Easy-stapl","Order_Date: 2015-03-22<br />total_quantity:  4<br />ProdName10: Easy-stapl","Order_Date: 2015-04-11<br />total_quantity:  2<br />ProdName10: Easy-stapl","Order_Date: 2015-05-29<br />total_quantity:  3<br />ProdName10: Easy-stapl","Order_Date: 2015-07-02<br />total_quantity:  3<br />ProdName10: Easy-stapl","Order_Date: 2015-07-13<br />total_quantity:  2<br />ProdName10: Easy-stapl","Order_Date: 2015-09-26<br />total_quantity:  5<br />ProdName10: Easy-stapl","Order_Date: 2015-10-20<br />total_quantity:  2<br />ProdName10: Easy-stapl","Order_Date: 2015-11-17<br />total_quantity:  3<br />ProdName10: Easy-stapl","Order_Date: 2015-11-29<br />total_quantity:  4<br />ProdName10: Easy-stapl","Order_Date: 2015-12-20<br />total_quantity:  4<br />ProdName10: Easy-stapl","Order_Date: 2016-01-31<br />total_quantity:  5<br />ProdName10: Easy-stapl","Order_Date: 2016-03-01<br />total_quantity:  1<br />ProdName10: Easy-stapl","Order_Date: 2016-05-21<br />total_quantity:  2<br />ProdName10: Easy-stapl","Order_Date: 2016-06-04<br />total_quantity:  3<br />ProdName10: Easy-stapl","Order_Date: 2016-08-01<br />total_quantity:  2<br />ProdName10: Easy-stapl","Order_Date: 2016-08-06<br />total_quantity:  2<br />ProdName10: Easy-stapl","Order_Date: 2016-08-13<br />total_quantity:  3<br />ProdName10: Easy-stapl","Order_Date: 2016-10-01<br />total_quantity:  1<br />ProdName10: Easy-stapl","Order_Date: 2016-11-26<br />total_quantity:  7<br />ProdName10: Easy-stapl","Order_Date: 2016-12-04<br />total_quantity:  4<br />ProdName10: Easy-stapl","Order_Date: 2016-12-05<br />total_quantity:  1<br />ProdName10: Easy-stapl","Order_Date: 2017-03-02<br />total_quantity:  6<br />ProdName10: Easy-stapl","Order_Date: 2017-03-20<br />total_quantity:  2<br />ProdName10: Easy-stapl","Order_Date: 2017-04-06<br />total_quantity:  3<br />ProdName10: Easy-stapl","Order_Date: 2017-06-08<br />total_quantity:  3<br />ProdName10: Easy-stapl","Order_Date: 2017-06-09<br />total_quantity:  4<br />ProdName10: Easy-stapl","Order_Date: 2017-07-08<br />total_quantity:  4<br />ProdName10: Easy-stapl","Order_Date: 2017-09-07<br />total_quantity:  9<br />ProdName10: Easy-stapl","Order_Date: 2017-09-17<br />total_quantity:  3<br />ProdName10: Easy-stapl","Order_Date: 2017-10-13<br />total_quantity:  3<br />ProdName10: Easy-stapl","Order_Date: 2017-10-19<br />total_quantity:  3<br />ProdName10: Easy-stapl","Order_Date: 2017-10-27<br />total_quantity:  7<br />ProdName10: Easy-stapl","Order_Date: 2017-11-05<br />total_quantity:  3<br />ProdName10: Easy-stapl","Order_Date: 2017-11-06<br />total_quantity:  5<br />ProdName10: Easy-stapl","Order_Date: 2017-12-09<br />total_quantity:  3<br />ProdName10: Easy-stapl"],"type":"scatter","mode":"lines","line":{"width":3.7795275590551185,"color":"rgba(216,144,0,1)","dash":"solid"},"hoveron":"points","name":"Easy-stapl","legendgroup":"Easy-stapl","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","visible":"legendonly","frame":null},{"x":[16277,16551,16641,16741,16980,17043,17127,17160,17368,17496,17503,17505,17520],"y":[4,3,4,14,2,6,8,2,3,8,5,5,3],"text":["Order_Date: 2014-07-26<br />total_quantity:  4<br />ProdName10: GBC Premiu","Order_Date: 2015-04-26<br />total_quantity:  3<br />ProdName10: GBC Premiu","Order_Date: 2015-07-25<br />total_quantity:  4<br />ProdName10: GBC Premiu","Order_Date: 2015-11-02<br />total_quantity: 14<br />ProdName10: GBC Premiu","Order_Date: 2016-06-28<br />total_quantity:  2<br />ProdName10: GBC Premiu","Order_Date: 2016-08-30<br />total_quantity:  6<br />ProdName10: GBC Premiu","Order_Date: 2016-11-22<br />total_quantity:  8<br />ProdName10: GBC Premiu","Order_Date: 2016-12-25<br />total_quantity:  2<br />ProdName10: GBC Premiu","Order_Date: 2017-07-21<br />total_quantity:  3<br />ProdName10: GBC Premiu","Order_Date: 2017-11-26<br />total_quantity:  8<br />ProdName10: GBC Premiu","Order_Date: 2017-12-03<br />total_quantity:  5<br />ProdName10: GBC Premiu","Order_Date: 2017-12-05<br />total_quantity:  5<br />ProdName10: GBC Premiu","Order_Date: 2017-12-20<br />total_quantity:  3<br />ProdName10: GBC Premiu"],"type":"scatter","mode":"lines","line":{"width":3.7795275590551185,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"GBC Premiu","legendgroup":"GBC Premiu","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","visible":"legendonly","frame":null},{"x":[16166,16224,16248,16320,16327,16410,16510,16684,16795,16903,17054,17132,17217,17236,17444,17446,17462,17496],"y":[3,6,1,5,9,5,2,1,1,4,5,7,9,3,3,3,4,3],"text":["Order_Date: 2014-04-06<br />total_quantity:  3<br />ProdName10: KI Adjusta","Order_Date: 2014-06-03<br />total_quantity:  6<br />ProdName10: KI Adjusta","Order_Date: 2014-06-27<br />total_quantity:  1<br />ProdName10: KI Adjusta","Order_Date: 2014-09-07<br />total_quantity:  5<br />ProdName10: KI Adjusta","Order_Date: 2014-09-14<br />total_quantity:  9<br />ProdName10: KI Adjusta","Order_Date: 2014-12-06<br />total_quantity:  5<br />ProdName10: KI Adjusta","Order_Date: 2015-03-16<br />total_quantity:  2<br />ProdName10: KI Adjusta","Order_Date: 2015-09-06<br />total_quantity:  1<br />ProdName10: KI Adjusta","Order_Date: 2015-12-26<br />total_quantity:  1<br />ProdName10: KI Adjusta","Order_Date: 2016-04-12<br />total_quantity:  4<br />ProdName10: KI Adjusta","Order_Date: 2016-09-10<br />total_quantity:  5<br />ProdName10: KI Adjusta","Order_Date: 2016-11-27<br />total_quantity:  7<br />ProdName10: KI Adjusta","Order_Date: 2017-02-20<br />total_quantity:  9<br />ProdName10: KI Adjusta","Order_Date: 2017-03-11<br />total_quantity:  3<br />ProdName10: KI Adjusta","Order_Date: 2017-10-05<br />total_quantity:  3<br />ProdName10: KI Adjusta","Order_Date: 2017-10-07<br />total_quantity:  3<br />ProdName10: KI Adjusta","Order_Date: 2017-10-23<br />total_quantity:  4<br />ProdName10: KI Adjusta","Order_Date: 2017-11-26<br />total_quantity:  3<br />ProdName10: KI Adjusta"],"type":"scatter","mode":"lines","line":{"width":3.7795275590551185,"color":"rgba(57,182,0,1)","dash":"solid"},"hoveron":"points","name":"KI Adjusta","legendgroup":"KI Adjusta","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","visible":"legendonly","frame":null},{"x":[16229,16259,16499,16563,16766,16776,16869,17049,17062,17133,17136,17305,17344,17365,17522],"y":[3,1,2,2,5,4,5,7,2,7,5,12,3,4,2],"text":["Order_Date: 2014-06-08<br />total_quantity:  3<br />ProdName10: Situations","Order_Date: 2014-07-08<br />total_quantity:  1<br />ProdName10: Situations","Order_Date: 2015-03-05<br />total_quantity:  2<br />ProdName10: Situations","Order_Date: 2015-05-08<br />total_quantity:  2<br />ProdName10: Situations","Order_Date: 2015-11-27<br />total_quantity:  5<br />ProdName10: Situations","Order_Date: 2015-12-07<br />total_quantity:  4<br />ProdName10: Situations","Order_Date: 2016-03-09<br />total_quantity:  5<br />ProdName10: Situations","Order_Date: 2016-09-05<br />total_quantity:  7<br />ProdName10: Situations","Order_Date: 2016-09-18<br />total_quantity:  2<br />ProdName10: Situations","Order_Date: 2016-11-28<br />total_quantity:  7<br />ProdName10: Situations","Order_Date: 2016-12-01<br />total_quantity:  5<br />ProdName10: Situations","Order_Date: 2017-05-19<br />total_quantity: 12<br />ProdName10: Situations","Order_Date: 2017-06-27<br />total_quantity:  3<br />ProdName10: Situations","Order_Date: 2017-07-18<br />total_quantity:  4<br />ProdName10: Situations","Order_Date: 2017-12-22<br />total_quantity:  2<br />ProdName10: Situations"],"type":"scatter","mode":"lines","line":{"width":3.7795275590551185,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"Situations","legendgroup":"Situations","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","visible":"legendonly","frame":null},{"x":[16083,16090,16131,16163,16182,16211,16237,16242,16327,16334,16381,16396,16397,16416,16435,16469,16499,16602,16691,16694,16717,16723,16751,16762,16767,16796,16831,16856,16872,16930,17048,17049,17070,17077,17121,17158,17159,17178,17227,17257,17279,17388,17395,17431,17435,17438,17489,17522],"y":[2,3,2,2,8,6,5,4,7,2,3,2,3,3,2,9,3,3,1,4,7,1,2,2,8,3,2,5,3,1,2,3,2,2,5,2,7,1,7,5,2,6,2,3,6,3,3,1],"text":["Order_Date: 2014-01-13<br />total_quantity:  2<br />ProdName10: Staple env","Order_Date: 2014-01-20<br />total_quantity:  3<br />ProdName10: Staple env","Order_Date: 2014-03-02<br />total_quantity:  2<br />ProdName10: Staple env","Order_Date: 2014-04-03<br />total_quantity:  2<br />ProdName10: Staple env","Order_Date: 2014-04-22<br />total_quantity:  8<br />ProdName10: Staple env","Order_Date: 2014-05-21<br />total_quantity:  6<br />ProdName10: Staple env","Order_Date: 2014-06-16<br />total_quantity:  5<br />ProdName10: Staple env","Order_Date: 2014-06-21<br />total_quantity:  4<br />ProdName10: Staple env","Order_Date: 2014-09-14<br />total_quantity:  7<br />ProdName10: Staple env","Order_Date: 2014-09-21<br />total_quantity:  2<br />ProdName10: Staple env","Order_Date: 2014-11-07<br />total_quantity:  3<br />ProdName10: Staple env","Order_Date: 2014-11-22<br />total_quantity:  2<br />ProdName10: Staple env","Order_Date: 2014-11-23<br />total_quantity:  3<br />ProdName10: Staple env","Order_Date: 2014-12-12<br />total_quantity:  3<br />ProdName10: Staple env","Order_Date: 2014-12-31<br />total_quantity:  2<br />ProdName10: Staple env","Order_Date: 2015-02-03<br />total_quantity:  9<br />ProdName10: Staple env","Order_Date: 2015-03-05<br />total_quantity:  3<br />ProdName10: Staple env","Order_Date: 2015-06-16<br />total_quantity:  3<br />ProdName10: Staple env","Order_Date: 2015-09-13<br />total_quantity:  1<br />ProdName10: Staple env","Order_Date: 2015-09-16<br />total_quantity:  4<br />ProdName10: Staple env","Order_Date: 2015-10-09<br />total_quantity:  7<br />ProdName10: Staple env","Order_Date: 2015-10-15<br />total_quantity:  1<br />ProdName10: Staple env","Order_Date: 2015-11-12<br />total_quantity:  2<br />ProdName10: Staple env","Order_Date: 2015-11-23<br />total_quantity:  2<br />ProdName10: Staple env","Order_Date: 2015-11-28<br />total_quantity:  8<br />ProdName10: Staple env","Order_Date: 2015-12-27<br />total_quantity:  3<br />ProdName10: Staple env","Order_Date: 2016-01-31<br />total_quantity:  2<br />ProdName10: Staple env","Order_Date: 2016-02-25<br />total_quantity:  5<br />ProdName10: Staple env","Order_Date: 2016-03-12<br />total_quantity:  3<br />ProdName10: Staple env","Order_Date: 2016-05-09<br />total_quantity:  1<br />ProdName10: Staple env","Order_Date: 2016-09-04<br />total_quantity:  2<br />ProdName10: Staple env","Order_Date: 2016-09-05<br />total_quantity:  3<br />ProdName10: Staple env","Order_Date: 2016-09-26<br />total_quantity:  2<br />ProdName10: Staple env","Order_Date: 2016-10-03<br />total_quantity:  2<br />ProdName10: Staple env","Order_Date: 2016-11-16<br />total_quantity:  5<br />ProdName10: Staple env","Order_Date: 2016-12-23<br />total_quantity:  2<br />ProdName10: Staple env","Order_Date: 2016-12-24<br />total_quantity:  7<br />ProdName10: Staple env","Order_Date: 2017-01-12<br />total_quantity:  1<br />ProdName10: Staple env","Order_Date: 2017-03-02<br />total_quantity:  7<br />ProdName10: Staple env","Order_Date: 2017-04-01<br />total_quantity:  5<br />ProdName10: Staple env","Order_Date: 2017-04-23<br />total_quantity:  2<br />ProdName10: Staple env","Order_Date: 2017-08-10<br />total_quantity:  6<br />ProdName10: Staple env","Order_Date: 2017-08-17<br />total_quantity:  2<br />ProdName10: Staple env","Order_Date: 2017-09-22<br />total_quantity:  3<br />ProdName10: Staple env","Order_Date: 2017-09-26<br />total_quantity:  6<br />ProdName10: Staple env","Order_Date: 2017-09-29<br />total_quantity:  3<br />ProdName10: Staple env","Order_Date: 2017-11-19<br />total_quantity:  3<br />ProdName10: Staple env","Order_Date: 2017-12-22<br />total_quantity:  1<br />ProdName10: Staple env"],"type":"scatter","mode":"lines","line":{"width":3.7795275590551185,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"Staple env","legendgroup":"Staple env","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","visible":"legendonly","frame":null},{"x":[16276,16397,16399,16559,16749,16783,16928,16956,16998,17031,17259,17332,17374,17503,17510,17521],"y":[8,2,3,7,3,3,8,3,3,3,4,4,3,3,3,2],"text":["Order_Date: 2014-07-25<br />total_quantity:  8<br />ProdName10: Staple-bas","Order_Date: 2014-11-23<br />total_quantity:  2<br />ProdName10: Staple-bas","Order_Date: 2014-11-25<br />total_quantity:  3<br />ProdName10: Staple-bas","Order_Date: 2015-05-04<br />total_quantity:  7<br />ProdName10: Staple-bas","Order_Date: 2015-11-10<br />total_quantity:  3<br />ProdName10: Staple-bas","Order_Date: 2015-12-14<br />total_quantity:  3<br />ProdName10: Staple-bas","Order_Date: 2016-05-07<br />total_quantity:  8<br />ProdName10: Staple-bas","Order_Date: 2016-06-04<br />total_quantity:  3<br />ProdName10: Staple-bas","Order_Date: 2016-07-16<br />total_quantity:  3<br />ProdName10: Staple-bas","Order_Date: 2016-08-18<br />total_quantity:  3<br />ProdName10: Staple-bas","Order_Date: 2017-04-03<br />total_quantity:  4<br />ProdName10: Staple-bas","Order_Date: 2017-06-15<br />total_quantity:  4<br />ProdName10: Staple-bas","Order_Date: 2017-07-27<br />total_quantity:  3<br />ProdName10: Staple-bas","Order_Date: 2017-12-03<br />total_quantity:  3<br />ProdName10: Staple-bas","Order_Date: 2017-12-10<br />total_quantity:  3<br />ProdName10: Staple-bas","Order_Date: 2017-12-21<br />total_quantity:  2<br />ProdName10: Staple-bas"],"type":"scatter","mode":"lines","line":{"width":3.7795275590551185,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"Staple-bas","legendgroup":"Staple-bas","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","visible":"legendonly","frame":null},{"x":[16103,16147,16173,16203,16249,16251,16345,16374,16375,16401,16403,16431,16514,16517,16529,16541,16670,16706,16767,16781,16795,16859,16892,17010,17040,17045,17049,17056,17094,17124,17173,17188,17199,17217,17251,17306,17391,17413,17441,17444,17446,17463,17472,17482,17525],"y":[5,3,13,2,1,6,2,3,5,2,7,3,9,4,2,4,8,3,2,2,5,6,5,7,4,7,8,3,4,12,1,5,9,3,2,3,5,6,3,5,3,4,3,3,13],"text":["Order_Date: 2014-02-02<br />total_quantity:  5<br />ProdName10: Staples","Order_Date: 2014-03-18<br />total_quantity:  3<br />ProdName10: Staples","Order_Date: 2014-04-13<br />total_quantity: 13<br />ProdName10: Staples","Order_Date: 2014-05-13<br />total_quantity:  2<br />ProdName10: Staples","Order_Date: 2014-06-28<br />total_quantity:  1<br />ProdName10: Staples","Order_Date: 2014-06-30<br />total_quantity:  6<br />ProdName10: Staples","Order_Date: 2014-10-02<br />total_quantity:  2<br />ProdName10: Staples","Order_Date: 2014-10-31<br />total_quantity:  3<br />ProdName10: Staples","Order_Date: 2014-11-01<br />total_quantity:  5<br />ProdName10: Staples","Order_Date: 2014-11-27<br />total_quantity:  2<br />ProdName10: Staples","Order_Date: 2014-11-29<br />total_quantity:  7<br />ProdName10: Staples","Order_Date: 2014-12-27<br />total_quantity:  3<br />ProdName10: Staples","Order_Date: 2015-03-20<br />total_quantity:  9<br />ProdName10: Staples","Order_Date: 2015-03-23<br />total_quantity:  4<br />ProdName10: Staples","Order_Date: 2015-04-04<br />total_quantity:  2<br />ProdName10: Staples","Order_Date: 2015-04-16<br />total_quantity:  4<br />ProdName10: Staples","Order_Date: 2015-08-23<br />total_quantity:  8<br />ProdName10: Staples","Order_Date: 2015-09-28<br />total_quantity:  3<br />ProdName10: Staples","Order_Date: 2015-11-28<br />total_quantity:  2<br />ProdName10: Staples","Order_Date: 2015-12-12<br />total_quantity:  2<br />ProdName10: Staples","Order_Date: 2015-12-26<br />total_quantity:  5<br />ProdName10: Staples","Order_Date: 2016-02-28<br />total_quantity:  6<br />ProdName10: Staples","Order_Date: 2016-04-01<br />total_quantity:  5<br />ProdName10: Staples","Order_Date: 2016-07-28<br />total_quantity:  7<br />ProdName10: Staples","Order_Date: 2016-08-27<br />total_quantity:  4<br />ProdName10: Staples","Order_Date: 2016-09-01<br />total_quantity:  7<br />ProdName10: Staples","Order_Date: 2016-09-05<br />total_quantity:  8<br />ProdName10: Staples","Order_Date: 2016-09-12<br />total_quantity:  3<br />ProdName10: Staples","Order_Date: 2016-10-20<br />total_quantity:  4<br />ProdName10: Staples","Order_Date: 2016-11-19<br />total_quantity: 12<br />ProdName10: Staples","Order_Date: 2017-01-07<br />total_quantity:  1<br />ProdName10: Staples","Order_Date: 2017-01-22<br />total_quantity:  5<br />ProdName10: Staples","Order_Date: 2017-02-02<br />total_quantity:  9<br />ProdName10: Staples","Order_Date: 2017-02-20<br />total_quantity:  3<br />ProdName10: Staples","Order_Date: 2017-03-26<br />total_quantity:  2<br />ProdName10: Staples","Order_Date: 2017-05-20<br />total_quantity:  3<br />ProdName10: Staples","Order_Date: 2017-08-13<br />total_quantity:  5<br />ProdName10: Staples","Order_Date: 2017-09-04<br />total_quantity:  6<br />ProdName10: Staples","Order_Date: 2017-10-02<br />total_quantity:  3<br />ProdName10: Staples","Order_Date: 2017-10-05<br />total_quantity:  5<br />ProdName10: Staples","Order_Date: 2017-10-07<br />total_quantity:  3<br />ProdName10: Staples","Order_Date: 2017-10-24<br />total_quantity:  4<br />ProdName10: Staples","Order_Date: 2017-11-02<br />total_quantity:  3<br />ProdName10: Staples","Order_Date: 2017-11-12<br />total_quantity:  3<br />ProdName10: Staples","Order_Date: 2017-12-25<br />total_quantity: 13<br />ProdName10: Staples"],"type":"scatter","mode":"lines","line":{"width":3.7795275590551185,"color":"rgba(149,144,255,1)","dash":"solid"},"hoveron":"points","name":"Staples","legendgroup":"Staples","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","visible":"legendonly","frame":null},{"x":[16118,16234,16399,16552,16611,16779,17075,17186,17202,17250,17286,17313,17358,17385,17410,17445,17490,17518,17528],"y":[14,3,3,3,2,1,8,5,5,9,3,3,4,10,1,2,3,6,1],"text":["Order_Date: 2014-02-17<br />total_quantity: 14<br />ProdName10: Staples in","Order_Date: 2014-06-13<br />total_quantity:  3<br />ProdName10: Staples in","Order_Date: 2014-11-25<br />total_quantity:  3<br />ProdName10: Staples in","Order_Date: 2015-04-27<br />total_quantity:  3<br />ProdName10: Staples in","Order_Date: 2015-06-25<br />total_quantity:  2<br />ProdName10: Staples in","Order_Date: 2015-12-10<br />total_quantity:  1<br />ProdName10: Staples in","Order_Date: 2016-10-01<br />total_quantity:  8<br />ProdName10: Staples in","Order_Date: 2017-01-20<br />total_quantity:  5<br />ProdName10: Staples in","Order_Date: 2017-02-05<br />total_quantity:  5<br />ProdName10: Staples in","Order_Date: 2017-03-25<br />total_quantity:  9<br />ProdName10: Staples in","Order_Date: 2017-04-30<br />total_quantity:  3<br />ProdName10: Staples in","Order_Date: 2017-05-27<br />total_quantity:  3<br />ProdName10: Staples in","Order_Date: 2017-07-11<br />total_quantity:  4<br />ProdName10: Staples in","Order_Date: 2017-08-07<br />total_quantity: 10<br />ProdName10: Staples in","Order_Date: 2017-09-01<br />total_quantity:  1<br />ProdName10: Staples in","Order_Date: 2017-10-06<br />total_quantity:  2<br />ProdName10: Staples in","Order_Date: 2017-11-20<br />total_quantity:  3<br />ProdName10: Staples in","Order_Date: 2017-12-18<br />total_quantity:  6<br />ProdName10: Staples in","Order_Date: 2017-12-28<br />total_quantity:  1<br />ProdName10: Staples in"],"type":"scatter","mode":"lines","line":{"width":3.7795275590551185,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"Staples in","legendgroup":"Staples in","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","visible":"legendonly","frame":null},{"x":[16090,16195,16586,16679,16747,16803,17005,17054,17110,17268,17309,17314,17440,17462,17474,17504,17528],"y":[5,2,3,1,11,2,4,3,3,5,1,3,13,3,2,3,7],"text":["Order_Date: 2014-01-20<br />total_quantity:  5<br />ProdName10: Storex Dur","Order_Date: 2014-05-05<br />total_quantity:  2<br />ProdName10: Storex Dur","Order_Date: 2015-05-31<br />total_quantity:  3<br />ProdName10: Storex Dur","Order_Date: 2015-09-01<br />total_quantity:  1<br />ProdName10: Storex Dur","Order_Date: 2015-11-08<br />total_quantity: 11<br />ProdName10: Storex Dur","Order_Date: 2016-01-03<br />total_quantity:  2<br />ProdName10: Storex Dur","Order_Date: 2016-07-23<br />total_quantity:  4<br />ProdName10: Storex Dur","Order_Date: 2016-09-10<br />total_quantity:  3<br />ProdName10: Storex Dur","Order_Date: 2016-11-05<br />total_quantity:  3<br />ProdName10: Storex Dur","Order_Date: 2017-04-12<br />total_quantity:  5<br />ProdName10: Storex Dur","Order_Date: 2017-05-23<br />total_quantity:  1<br />ProdName10: Storex Dur","Order_Date: 2017-05-28<br />total_quantity:  3<br />ProdName10: Storex Dur","Order_Date: 2017-10-01<br />total_quantity: 13<br />ProdName10: Storex Dur","Order_Date: 2017-10-23<br />total_quantity:  3<br />ProdName10: Storex Dur","Order_Date: 2017-11-04<br />total_quantity:  2<br />ProdName10: Storex Dur","Order_Date: 2017-12-04<br />total_quantity:  3<br />ProdName10: Storex Dur","Order_Date: 2017-12-28<br />total_quantity:  7<br />ProdName10: Storex Dur"],"type":"scatter","mode":"lines","line":{"width":3.7795275590551185,"color":"rgba(255,98,188,1)","dash":"solid"},"hoveron":"points","name":"Storex Dur","legendgroup":"Storex Dur","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","visible":"legendonly","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826498,"l":37.260273972602747},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Quantity Sold Over Time per Product","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[16010.75,17600.25],"tickmode":"array","ticktext":["2014","2015","2016","2017","2018"],"tickvals":[16071,16436,16801,17167,17532],"categoryorder":"array","categoryarray":["2014","2015","2016","2017","2018"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Order Date","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.34999999999999998,14.65],"tickmode":"array","ticktext":["5","10"],"tickvals":[5,10],"categoryorder":"array","categoryarray":["5","10"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Quantity Sold","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Product Name","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"5ef8c94d56a":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"5ef8c94d56a","visdat":{"5ef8c94d56a":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div></div>
<div id="1a512a92-e0c1-444c-9075-d3a8203dc1dd" class="cell markdown">
<p>Our proposed workaround is to aggregate <code>Product_Name</code> by <code>Sub_Category</code>, and treat it as a single product for the rest of the assignment, which we plotted in figure X.</p>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [14]:</pre></div><div id="ded84e69-c1c0-4856-a093-26c394c65f51" class="cell" data-fig-caption="Aggregated Sub_Category sales (toggle )">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plots</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># # Count frequency of top 20 products</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># top_products &lt;- data %&gt;%</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   count(Product_Name, sort = TRUE) %&gt;%</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   top_n(20, n) %&gt;%</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(ProdName8 = substr(Product_Name, 1, 8))</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co"># # Plot!</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(top_products, aes(x = reorder(`ProdName8`, -n), y = n)) +</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_bar(stat = "identity", fill = "steelblue") +</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title = "Top 20 Most Sold Products",</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co">#        x = "Product Name",</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co">#        y = "Quantity sold") +</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal() +</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   coord_flip()</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Count frequency of top 20 products</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>top_categories <span class="op">&lt;-</span> data <span class="op">%&gt;%</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>  count(Sub_Category, sort <span class="op">=</span> TRUE)</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="co"># # Plot!</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(top_categories, aes(x = reorder(Sub_Category, -n), y = n)) +</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_bar(stat = "identity", fill = "steelblue") +</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title = "Sub_Categories sorted",</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a><span class="co">#        x = "Product Name",</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a><span class="co">#        y = "Quantity sold") +</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal() +</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a><span class="co">#   coord_flip()</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Find top 10 most sold product names</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>top_10_categories <span class="op">&lt;-</span> top_categories$Sub_Category[<span class="dv">0</span>:<span class="dv">10</span>]</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data for  top 10 products</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>top_10_data <span class="op">&lt;-</span> data <span class="op">%&gt;%</span> <span class="bu">filter</span>(Sub_Category <span class="op">%</span><span class="kw">in</span><span class="op">%</span> top_10_categories)</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate sales per month</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>top_10_data <span class="op">&lt;-</span> top_10_data <span class="op">%&gt;%</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>  mutate(Month <span class="op">=</span> floor_date(Order_Date, unit <span class="op">=</span> <span class="st">"month"</span>))</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate data by month for each sub-category</span></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>top_10_data_aggregated <span class="op">&lt;-</span> top_10_data <span class="op">%&gt;%</span></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>  group_by(Month, Sub_Category) <span class="op">%&gt;%</span></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>  summarise(Sales_Count <span class="op">=</span> n(), .groups <span class="op">=</span> <span class="st">'drop'</span>)</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Some special interactive plot formatting (see previous plot)</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>p_ly <span class="op">&lt;-</span> ggplotly(ggplot(top_10_data_aggregated, aes(x <span class="op">=</span> Month, y <span class="op">=</span> Sales_Count, color <span class="op">=</span> Sub_Category, group <span class="op">=</span> Sub_Category)) <span class="op">+</span></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>    geom_line(size <span class="op">=</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>    geom_point(size <span class="op">=</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>    labs(title <span class="op">=</span> <span class="st">"Monthly Sales for the Top 3 Most Sold Sub Categories"</span>,</span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>         x <span class="op">=</span> <span class="st">"Month"</span>,</span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>         y <span class="op">=</span> <span class="st">"Sales Count"</span>,</span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>         color <span class="op">=</span> <span class="st">"Sub Category"</span>) <span class="op">+</span></span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>    theme_minimal())</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Modify the visibility of traces</span></span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="kw">in</span> seq_along(p_ly$x$data)) {</span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="op">==</span> <span class="dv">1</span>) {</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>    p_ly$x$data[[i]]$visible <span class="op">&lt;-</span> TRUE  <span class="co"># Make the first trace visible</span></span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>    p_ly$x$data[[i]]$visible <span class="op">&lt;-</span> <span class="st">"legendonly"</span>  <span class="co"># Hide the rest</span></span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>p_ly</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-c0746223e29dc6be89cf" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-c0746223e29dc6be89cf">{"x":{"data":[{"x":[16071,16102,16130,16161,16191,16222,16252,16283,16314,16344,16375,16405,16436,16467,16495,16526,16556,16587,16617,16648,16679,16709,16740,16770,16801,16832,16861,16892,16922,16953,16983,17014,17045,17075,17106,17136,17167,17198,17226,17257,17287,17318,17348,17379,17410,17440,17471,17501],"y":[3,5,8,13,9,5,13,13,19,15,22,23,3,8,10,12,7,10,8,12,22,16,27,31,12,6,13,7,16,16,8,14,18,12,37,27,12,6,21,15,20,18,20,16,50,22,40,35],"text":["Month: 2014-01-01<br />Sales_Count:  3<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2014-02-01<br />Sales_Count:  5<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2014-03-01<br />Sales_Count:  8<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2014-04-01<br />Sales_Count: 13<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2014-05-01<br />Sales_Count:  9<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2014-06-01<br />Sales_Count:  5<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2014-07-01<br />Sales_Count: 13<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2014-08-01<br />Sales_Count: 13<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2014-09-01<br />Sales_Count: 19<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2014-10-01<br />Sales_Count: 15<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2014-11-01<br />Sales_Count: 22<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2014-12-01<br />Sales_Count: 23<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2015-01-01<br />Sales_Count:  3<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2015-02-01<br />Sales_Count:  8<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2015-03-01<br />Sales_Count: 10<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2015-04-01<br />Sales_Count: 12<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2015-05-01<br />Sales_Count:  7<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2015-06-01<br />Sales_Count: 10<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2015-07-01<br />Sales_Count:  8<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2015-08-01<br />Sales_Count: 12<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2015-09-01<br />Sales_Count: 22<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2015-10-01<br />Sales_Count: 16<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2015-11-01<br />Sales_Count: 27<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2015-12-01<br />Sales_Count: 31<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2016-01-01<br />Sales_Count: 12<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2016-02-01<br />Sales_Count:  6<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2016-03-01<br />Sales_Count: 13<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2016-04-01<br />Sales_Count:  7<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2016-05-01<br />Sales_Count: 16<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2016-06-01<br />Sales_Count: 16<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2016-07-01<br />Sales_Count:  8<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2016-08-01<br />Sales_Count: 14<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2016-09-01<br />Sales_Count: 18<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2016-10-01<br />Sales_Count: 12<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2016-11-01<br />Sales_Count: 37<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2016-12-01<br />Sales_Count: 27<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2017-01-01<br />Sales_Count: 12<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2017-02-01<br />Sales_Count:  6<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2017-03-01<br />Sales_Count: 21<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2017-04-01<br />Sales_Count: 15<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2017-05-01<br />Sales_Count: 20<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2017-06-01<br />Sales_Count: 18<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2017-07-01<br />Sales_Count: 20<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2017-08-01<br />Sales_Count: 16<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2017-09-01<br />Sales_Count: 50<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2017-10-01<br />Sales_Count: 22<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2017-11-01<br />Sales_Count: 40<br />Sub_Category: Accessories<br />Sub_Category: Accessories","Month: 2017-12-01<br />Sales_Count: 35<br />Sub_Category: Accessories<br />Sub_Category: Accessories"],"type":"scatter","mode":"lines+markers","line":{"width":3.7795275590551185,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"Accessories","legendgroup":"Accessories","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)"}},"visible":true,"frame":null},{"x":[16071,16102,16130,16161,16191,16222,16252,16283,16314,16344,16375,16405,16436,16467,16495,16526,16556,16587,16617,16648,16679,16709,16740,16770,16801,16832,16861,16892,16922,16953,16983,17014,17045,17075,17106,17136,17167,17198,17226,17257,17287,17318,17348,17379,17410,17440,17471,17501],"y":[2,2,5,3,8,7,4,10,19,4,13,16,2,2,7,16,8,1,3,7,11,7,16,14,1,3,7,6,11,12,10,10,12,6,15,21,6,9,13,8,15,12,9,14,22,11,22,24],"text":["Month: 2014-01-01<br />Sales_Count:  2<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2014-02-01<br />Sales_Count:  2<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2014-03-01<br />Sales_Count:  5<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2014-04-01<br />Sales_Count:  3<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2014-05-01<br />Sales_Count:  8<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2014-06-01<br />Sales_Count:  7<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2014-07-01<br />Sales_Count:  4<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2014-08-01<br />Sales_Count: 10<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2014-09-01<br />Sales_Count: 19<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2014-10-01<br />Sales_Count:  4<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2014-11-01<br />Sales_Count: 13<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2014-12-01<br />Sales_Count: 16<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2015-01-01<br />Sales_Count:  2<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2015-02-01<br />Sales_Count:  2<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2015-03-01<br />Sales_Count:  7<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2015-04-01<br />Sales_Count: 16<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2015-05-01<br />Sales_Count:  8<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2015-06-01<br />Sales_Count:  1<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2015-07-01<br />Sales_Count:  3<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2015-08-01<br />Sales_Count:  7<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2015-09-01<br />Sales_Count: 11<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2015-10-01<br />Sales_Count:  7<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2015-11-01<br />Sales_Count: 16<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2015-12-01<br />Sales_Count: 14<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2016-01-01<br />Sales_Count:  1<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2016-02-01<br />Sales_Count:  3<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2016-03-01<br />Sales_Count:  7<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2016-04-01<br />Sales_Count:  6<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2016-05-01<br />Sales_Count: 11<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2016-06-01<br />Sales_Count: 12<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2016-07-01<br />Sales_Count: 10<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2016-08-01<br />Sales_Count: 10<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2016-09-01<br />Sales_Count: 12<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2016-10-01<br />Sales_Count:  6<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2016-11-01<br />Sales_Count: 15<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2016-12-01<br />Sales_Count: 21<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2017-01-01<br />Sales_Count:  6<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2017-02-01<br />Sales_Count:  9<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2017-03-01<br />Sales_Count: 13<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2017-04-01<br />Sales_Count:  8<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2017-05-01<br />Sales_Count: 15<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2017-06-01<br />Sales_Count: 12<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2017-07-01<br />Sales_Count:  9<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2017-08-01<br />Sales_Count: 14<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2017-09-01<br />Sales_Count: 22<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2017-10-01<br />Sales_Count: 11<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2017-11-01<br />Sales_Count: 22<br />Sub_Category: Appliances<br />Sub_Category: Appliances","Month: 2017-12-01<br />Sales_Count: 24<br />Sub_Category: Appliances<br />Sub_Category: Appliances"],"type":"scatter","mode":"lines+markers","line":{"width":3.7795275590551185,"color":"rgba(216,144,0,1)","dash":"solid"},"hoveron":"points","name":"Appliances","legendgroup":"Appliances","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(216,144,0,1)","opacity":1,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(216,144,0,1)"}},"visible":"legendonly","frame":null},{"x":[16071,16102,16130,16161,16191,16222,16252,16283,16314,16344,16375,16405,16436,16467,16495,16526,16556,16587,16617,16648,16679,16709,16740,16770,16801,16832,16861,16892,16922,16953,16983,17014,17045,17075,17106,17136,17167,17198,17226,17257,17287,17318,17348,17379,17410,17440,17471,17501],"y":[9,2,22,16,9,19,12,10,20,9,21,15,7,7,9,17,12,11,8,14,21,10,22,29,8,3,8,18,17,11,15,9,30,16,24,24,16,7,18,22,22,20,22,15,42,22,40,36],"text":["Month: 2014-01-01<br />Sales_Count:  9<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2014-02-01<br />Sales_Count:  2<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2014-03-01<br />Sales_Count: 22<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2014-04-01<br />Sales_Count: 16<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2014-05-01<br />Sales_Count:  9<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2014-06-01<br />Sales_Count: 19<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2014-07-01<br />Sales_Count: 12<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2014-08-01<br />Sales_Count: 10<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2014-09-01<br />Sales_Count: 20<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2014-10-01<br />Sales_Count:  9<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2014-11-01<br />Sales_Count: 21<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2014-12-01<br />Sales_Count: 15<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2015-01-01<br />Sales_Count:  7<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2015-02-01<br />Sales_Count:  7<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2015-03-01<br />Sales_Count:  9<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2015-04-01<br />Sales_Count: 17<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2015-05-01<br />Sales_Count: 12<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2015-06-01<br />Sales_Count: 11<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2015-07-01<br />Sales_Count:  8<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2015-08-01<br />Sales_Count: 14<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2015-09-01<br />Sales_Count: 21<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2015-10-01<br />Sales_Count: 10<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2015-11-01<br />Sales_Count: 22<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2015-12-01<br />Sales_Count: 29<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2016-01-01<br />Sales_Count:  8<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2016-02-01<br />Sales_Count:  3<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2016-03-01<br />Sales_Count:  8<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2016-04-01<br />Sales_Count: 18<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2016-05-01<br />Sales_Count: 17<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2016-06-01<br />Sales_Count: 11<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2016-07-01<br />Sales_Count: 15<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2016-08-01<br />Sales_Count:  9<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2016-09-01<br />Sales_Count: 30<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2016-10-01<br />Sales_Count: 16<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2016-11-01<br />Sales_Count: 24<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2016-12-01<br />Sales_Count: 24<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2017-01-01<br />Sales_Count: 16<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2017-02-01<br />Sales_Count:  7<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2017-03-01<br />Sales_Count: 18<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2017-04-01<br />Sales_Count: 22<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2017-05-01<br />Sales_Count: 22<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2017-06-01<br />Sales_Count: 20<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2017-07-01<br />Sales_Count: 22<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2017-08-01<br />Sales_Count: 15<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2017-09-01<br />Sales_Count: 42<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2017-10-01<br />Sales_Count: 22<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2017-11-01<br />Sales_Count: 40<br />Sub_Category: Art<br />Sub_Category: Art","Month: 2017-12-01<br />Sales_Count: 36<br />Sub_Category: Art<br />Sub_Category: Art"],"type":"scatter","mode":"lines+markers","line":{"width":3.7795275590551185,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"Art","legendgroup":"Art","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(163,165,0,1)","opacity":1,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(163,165,0,1)"}},"visible":"legendonly","frame":null},{"x":[16071,16102,16130,16161,16191,16222,16252,16283,16314,16344,16375,16405,16436,16467,16495,16526,16556,16587,16617,16648,16679,16709,16740,16770,16801,16832,16861,16892,16922,16953,16983,17014,17045,17075,17106,17136,17167,17198,17226,17257,17287,17318,17348,17379,17410,17440,17471,17501],"y":[12,13,22,18,19,22,24,26,37,25,42,30,6,10,15,22,19,29,27,24,53,23,51,39,13,9,25,29,36,27,30,31,60,33,66,56,30,11,38,36,35,35,31,35,64,42,63,80],"text":["Month: 2014-01-01<br />Sales_Count: 12<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2014-02-01<br />Sales_Count: 13<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2014-03-01<br />Sales_Count: 22<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2014-04-01<br />Sales_Count: 18<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2014-05-01<br />Sales_Count: 19<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2014-06-01<br />Sales_Count: 22<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2014-07-01<br />Sales_Count: 24<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2014-08-01<br />Sales_Count: 26<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2014-09-01<br />Sales_Count: 37<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2014-10-01<br />Sales_Count: 25<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2014-11-01<br />Sales_Count: 42<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2014-12-01<br />Sales_Count: 30<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2015-01-01<br />Sales_Count:  6<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2015-02-01<br />Sales_Count: 10<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2015-03-01<br />Sales_Count: 15<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2015-04-01<br />Sales_Count: 22<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2015-05-01<br />Sales_Count: 19<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2015-06-01<br />Sales_Count: 29<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2015-07-01<br />Sales_Count: 27<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2015-08-01<br />Sales_Count: 24<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2015-09-01<br />Sales_Count: 53<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2015-10-01<br />Sales_Count: 23<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2015-11-01<br />Sales_Count: 51<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2015-12-01<br />Sales_Count: 39<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2016-01-01<br />Sales_Count: 13<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2016-02-01<br />Sales_Count:  9<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2016-03-01<br />Sales_Count: 25<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2016-04-01<br />Sales_Count: 29<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2016-05-01<br />Sales_Count: 36<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2016-06-01<br />Sales_Count: 27<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2016-07-01<br />Sales_Count: 30<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2016-08-01<br />Sales_Count: 31<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2016-09-01<br />Sales_Count: 60<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2016-10-01<br />Sales_Count: 33<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2016-11-01<br />Sales_Count: 66<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2016-12-01<br />Sales_Count: 56<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2017-01-01<br />Sales_Count: 30<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2017-02-01<br />Sales_Count: 11<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2017-03-01<br />Sales_Count: 38<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2017-04-01<br />Sales_Count: 36<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2017-05-01<br />Sales_Count: 35<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2017-06-01<br />Sales_Count: 35<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2017-07-01<br />Sales_Count: 31<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2017-08-01<br />Sales_Count: 35<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2017-09-01<br />Sales_Count: 64<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2017-10-01<br />Sales_Count: 42<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2017-11-01<br />Sales_Count: 63<br />Sub_Category: Binders<br />Sub_Category: Binders","Month: 2017-12-01<br />Sales_Count: 80<br />Sub_Category: Binders<br />Sub_Category: Binders"],"type":"scatter","mode":"lines+markers","line":{"width":3.7795275590551185,"color":"rgba(57,182,0,1)","dash":"solid"},"hoveron":"points","name":"Binders","legendgroup":"Binders","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(57,182,0,1)","opacity":1,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(57,182,0,1)"}},"visible":"legendonly","frame":null},{"x":[16071,16102,16130,16161,16191,16222,16252,16283,16314,16344,16375,16405,16436,16467,16495,16526,16556,16587,16617,16648,16679,16709,16740,16770,16801,16832,16861,16892,16922,16953,16983,17014,17045,17075,17106,17136,17167,17198,17226,17257,17287,17318,17348,17379,17410,17440,17471,17501],"y":[3,2,12,7,9,8,13,5,15,12,18,25,4,5,8,11,10,6,14,5,17,13,21,19,3,5,11,13,10,9,14,7,27,14,27,25,6,5,11,5,18,14,15,10,32,15,27,32],"text":["Month: 2014-01-01<br />Sales_Count:  3<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2014-02-01<br />Sales_Count:  2<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2014-03-01<br />Sales_Count: 12<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2014-04-01<br />Sales_Count:  7<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2014-05-01<br />Sales_Count:  9<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2014-06-01<br />Sales_Count:  8<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2014-07-01<br />Sales_Count: 13<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2014-08-01<br />Sales_Count:  5<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2014-09-01<br />Sales_Count: 15<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2014-10-01<br />Sales_Count: 12<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2014-11-01<br />Sales_Count: 18<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2014-12-01<br />Sales_Count: 25<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2015-01-01<br />Sales_Count:  4<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2015-02-01<br />Sales_Count:  5<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2015-03-01<br />Sales_Count:  8<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2015-04-01<br />Sales_Count: 11<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2015-05-01<br />Sales_Count: 10<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2015-06-01<br />Sales_Count:  6<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2015-07-01<br />Sales_Count: 14<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2015-08-01<br />Sales_Count:  5<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2015-09-01<br />Sales_Count: 17<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2015-10-01<br />Sales_Count: 13<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2015-11-01<br />Sales_Count: 21<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2015-12-01<br />Sales_Count: 19<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2016-01-01<br />Sales_Count:  3<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2016-02-01<br />Sales_Count:  5<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2016-03-01<br />Sales_Count: 11<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2016-04-01<br />Sales_Count: 13<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2016-05-01<br />Sales_Count: 10<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2016-06-01<br />Sales_Count:  9<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2016-07-01<br />Sales_Count: 14<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2016-08-01<br />Sales_Count:  7<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2016-09-01<br />Sales_Count: 27<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2016-10-01<br />Sales_Count: 14<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2016-11-01<br />Sales_Count: 27<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2016-12-01<br />Sales_Count: 25<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2017-01-01<br />Sales_Count:  6<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2017-02-01<br />Sales_Count:  5<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2017-03-01<br />Sales_Count: 11<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2017-04-01<br />Sales_Count:  5<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2017-05-01<br />Sales_Count: 18<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2017-06-01<br />Sales_Count: 14<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2017-07-01<br />Sales_Count: 15<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2017-08-01<br />Sales_Count: 10<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2017-09-01<br />Sales_Count: 32<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2017-10-01<br />Sales_Count: 15<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2017-11-01<br />Sales_Count: 27<br />Sub_Category: Chairs<br />Sub_Category: Chairs","Month: 2017-12-01<br />Sales_Count: 32<br />Sub_Category: Chairs<br />Sub_Category: Chairs"],"type":"scatter","mode":"lines+markers","line":{"width":3.7795275590551185,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"Chairs","legendgroup":"Chairs","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(0,191,125,1)","opacity":1,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,191,125,1)"}},"visible":"legendonly","frame":null},{"x":[16071,16102,16130,16161,16191,16222,16252,16283,16314,16344,16375,16405,16436,16467,16495,16526,16556,16587,16617,16648,16679,16709,16740,16770,16801,16832,16861,16892,16922,16953,16983,17014,17045,17075,17106,17136,17167,17198,17226,17257,17287,17318,17348,17379,17410,17440,17471,17501],"y":[11,4,10,11,9,11,12,12,28,12,28,36,6,3,12,14,17,18,15,14,26,12,34,29,11,11,17,15,27,15,19,9,36,25,37,35,11,13,18,28,20,19,26,20,35,27,49,50],"text":["Month: 2014-01-01<br />Sales_Count: 11<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2014-02-01<br />Sales_Count:  4<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2014-03-01<br />Sales_Count: 10<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2014-04-01<br />Sales_Count: 11<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2014-05-01<br />Sales_Count:  9<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2014-06-01<br />Sales_Count: 11<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2014-07-01<br />Sales_Count: 12<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2014-08-01<br />Sales_Count: 12<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2014-09-01<br />Sales_Count: 28<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2014-10-01<br />Sales_Count: 12<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2014-11-01<br />Sales_Count: 28<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2014-12-01<br />Sales_Count: 36<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2015-01-01<br />Sales_Count:  6<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2015-02-01<br />Sales_Count:  3<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2015-03-01<br />Sales_Count: 12<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2015-04-01<br />Sales_Count: 14<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2015-05-01<br />Sales_Count: 17<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2015-06-01<br />Sales_Count: 18<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2015-07-01<br />Sales_Count: 15<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2015-08-01<br />Sales_Count: 14<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2015-09-01<br />Sales_Count: 26<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2015-10-01<br />Sales_Count: 12<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2015-11-01<br />Sales_Count: 34<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2015-12-01<br />Sales_Count: 29<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2016-01-01<br />Sales_Count: 11<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2016-02-01<br />Sales_Count: 11<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2016-03-01<br />Sales_Count: 17<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2016-04-01<br />Sales_Count: 15<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2016-05-01<br />Sales_Count: 27<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2016-06-01<br />Sales_Count: 15<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2016-07-01<br />Sales_Count: 19<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2016-08-01<br />Sales_Count:  9<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2016-09-01<br />Sales_Count: 36<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2016-10-01<br />Sales_Count: 25<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2016-11-01<br />Sales_Count: 37<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2016-12-01<br />Sales_Count: 35<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2017-01-01<br />Sales_Count: 11<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2017-02-01<br />Sales_Count: 13<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2017-03-01<br />Sales_Count: 18<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2017-04-01<br />Sales_Count: 28<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2017-05-01<br />Sales_Count: 20<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2017-06-01<br />Sales_Count: 19<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2017-07-01<br />Sales_Count: 26<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2017-08-01<br />Sales_Count: 20<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2017-09-01<br />Sales_Count: 35<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2017-10-01<br />Sales_Count: 27<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2017-11-01<br />Sales_Count: 49<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings","Month: 2017-12-01<br />Sales_Count: 50<br />Sub_Category: Furnishings<br />Sub_Category: Furnishings"],"type":"scatter","mode":"lines+markers","line":{"width":3.7795275590551185,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"Furnishings","legendgroup":"Furnishings","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":1,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)"}},"visible":"legendonly","frame":null},{"x":[16071,16102,16130,16161,16191,16222,16252,16283,16314,16344,16375,16405,16436,16467,16495,16526,16556,16587,16617,16648,16679,16709,16740,16770,16801,16832,16861,16892,16922,16953,16983,17014,17045,17075,17106,17136,17167,17198,17226,17257,17287,17318,17348,17379,17410,17440,17471,17501],"y":[3,3,7,6,4,3,4,3,10,6,16,11,3,5,5,3,9,6,4,9,9,4,6,14,3,3,1,2,8,14,9,9,20,6,12,10,3,2,11,15,10,6,9,9,14,13,11,11],"text":["Month: 2014-01-01<br />Sales_Count:  3<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2014-02-01<br />Sales_Count:  3<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2014-03-01<br />Sales_Count:  7<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2014-04-01<br />Sales_Count:  6<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2014-05-01<br />Sales_Count:  4<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2014-06-01<br />Sales_Count:  3<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2014-07-01<br />Sales_Count:  4<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2014-08-01<br />Sales_Count:  3<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2014-09-01<br />Sales_Count: 10<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2014-10-01<br />Sales_Count:  6<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2014-11-01<br />Sales_Count: 16<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2014-12-01<br />Sales_Count: 11<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2015-01-01<br />Sales_Count:  3<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2015-02-01<br />Sales_Count:  5<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2015-03-01<br />Sales_Count:  5<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2015-04-01<br />Sales_Count:  3<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2015-05-01<br />Sales_Count:  9<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2015-06-01<br />Sales_Count:  6<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2015-07-01<br />Sales_Count:  4<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2015-08-01<br />Sales_Count:  9<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2015-09-01<br />Sales_Count:  9<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2015-10-01<br />Sales_Count:  4<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2015-11-01<br />Sales_Count:  6<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2015-12-01<br />Sales_Count: 14<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2016-01-01<br />Sales_Count:  3<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2016-02-01<br />Sales_Count:  3<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2016-03-01<br />Sales_Count:  1<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2016-04-01<br />Sales_Count:  2<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2016-05-01<br />Sales_Count:  8<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2016-06-01<br />Sales_Count: 14<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2016-07-01<br />Sales_Count:  9<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2016-08-01<br />Sales_Count:  9<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2016-09-01<br />Sales_Count: 20<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2016-10-01<br />Sales_Count:  6<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2016-11-01<br />Sales_Count: 12<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2016-12-01<br />Sales_Count: 10<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2017-01-01<br />Sales_Count:  3<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2017-02-01<br />Sales_Count:  2<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2017-03-01<br />Sales_Count: 11<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2017-04-01<br />Sales_Count: 15<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2017-05-01<br />Sales_Count: 10<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2017-06-01<br />Sales_Count:  6<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2017-07-01<br />Sales_Count:  9<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2017-08-01<br />Sales_Count:  9<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2017-09-01<br />Sales_Count: 14<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2017-10-01<br />Sales_Count: 13<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2017-11-01<br />Sales_Count: 11<br />Sub_Category: Labels<br />Sub_Category: Labels","Month: 2017-12-01<br />Sales_Count: 11<br />Sub_Category: Labels<br />Sub_Category: Labels"],"type":"scatter","mode":"lines+markers","line":{"width":3.7795275590551185,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"Labels","legendgroup":"Labels","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(0,176,246,1)","opacity":1,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,176,246,1)"}},"visible":"legendonly","frame":null},{"x":[16071,16102,16130,16161,16191,16222,16252,16283,16314,16344,16375,16405,16436,16467,16495,16526,16556,16587,16617,16648,16679,16709,16740,16770,16801,16832,16861,16892,16922,16953,16983,17014,17045,17075,17106,17136,17167,17198,17226,17257,17287,17318,17348,17379,17410,17440,17471,17501],"y":[10,6,23,17,18,14,17,29,38,17,48,36,10,9,22,13,20,22,18,20,31,18,38,51,11,10,21,22,41,38,26,28,52,28,45,44,17,16,30,24,30,39,31,28,76,44,63,61],"text":["Month: 2014-01-01<br />Sales_Count: 10<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2014-02-01<br />Sales_Count:  6<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2014-03-01<br />Sales_Count: 23<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2014-04-01<br />Sales_Count: 17<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2014-05-01<br />Sales_Count: 18<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2014-06-01<br />Sales_Count: 14<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2014-07-01<br />Sales_Count: 17<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2014-08-01<br />Sales_Count: 29<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2014-09-01<br />Sales_Count: 38<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2014-10-01<br />Sales_Count: 17<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2014-11-01<br />Sales_Count: 48<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2014-12-01<br />Sales_Count: 36<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2015-01-01<br />Sales_Count: 10<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2015-02-01<br />Sales_Count:  9<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2015-03-01<br />Sales_Count: 22<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2015-04-01<br />Sales_Count: 13<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2015-05-01<br />Sales_Count: 20<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2015-06-01<br />Sales_Count: 22<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2015-07-01<br />Sales_Count: 18<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2015-08-01<br />Sales_Count: 20<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2015-09-01<br />Sales_Count: 31<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2015-10-01<br />Sales_Count: 18<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2015-11-01<br />Sales_Count: 38<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2015-12-01<br />Sales_Count: 51<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2016-01-01<br />Sales_Count: 11<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2016-02-01<br />Sales_Count: 10<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2016-03-01<br />Sales_Count: 21<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2016-04-01<br />Sales_Count: 22<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2016-05-01<br />Sales_Count: 41<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2016-06-01<br />Sales_Count: 38<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2016-07-01<br />Sales_Count: 26<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2016-08-01<br />Sales_Count: 28<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2016-09-01<br />Sales_Count: 52<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2016-10-01<br />Sales_Count: 28<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2016-11-01<br />Sales_Count: 45<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2016-12-01<br />Sales_Count: 44<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2017-01-01<br />Sales_Count: 17<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2017-02-01<br />Sales_Count: 16<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2017-03-01<br />Sales_Count: 30<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2017-04-01<br />Sales_Count: 24<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2017-05-01<br />Sales_Count: 30<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2017-06-01<br />Sales_Count: 39<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2017-07-01<br />Sales_Count: 31<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2017-08-01<br />Sales_Count: 28<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2017-09-01<br />Sales_Count: 76<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2017-10-01<br />Sales_Count: 44<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2017-11-01<br />Sales_Count: 63<br />Sub_Category: Paper<br />Sub_Category: Paper","Month: 2017-12-01<br />Sales_Count: 61<br />Sub_Category: Paper<br />Sub_Category: Paper"],"type":"scatter","mode":"lines+markers","line":{"width":3.7795275590551185,"color":"rgba(149,144,255,1)","dash":"solid"},"hoveron":"points","name":"Paper","legendgroup":"Paper","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(149,144,255,1)","opacity":1,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(149,144,255,1)"}},"visible":"legendonly","frame":null},{"x":[16071,16102,16130,16161,16191,16222,16252,16283,16314,16344,16375,16405,16436,16467,16495,16526,16556,16587,16617,16648,16679,16709,16740,16770,16801,16832,16861,16892,16922,16953,16983,17014,17045,17075,17106,17136,17167,17198,17226,17257,17287,17318,17348,17379,17410,17440,17471,17501],"y":[6,3,10,12,15,13,14,12,14,13,36,23,6,6,16,20,12,16,13,15,22,21,25,27,9,9,20,13,19,15,21,21,26,13,29,30,15,15,26,9,21,24,24,17,36,30,44,33],"text":["Month: 2014-01-01<br />Sales_Count:  6<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2014-02-01<br />Sales_Count:  3<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2014-03-01<br />Sales_Count: 10<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2014-04-01<br />Sales_Count: 12<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2014-05-01<br />Sales_Count: 15<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2014-06-01<br />Sales_Count: 13<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2014-07-01<br />Sales_Count: 14<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2014-08-01<br />Sales_Count: 12<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2014-09-01<br />Sales_Count: 14<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2014-10-01<br />Sales_Count: 13<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2014-11-01<br />Sales_Count: 36<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2014-12-01<br />Sales_Count: 23<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2015-01-01<br />Sales_Count:  6<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2015-02-01<br />Sales_Count:  6<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2015-03-01<br />Sales_Count: 16<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2015-04-01<br />Sales_Count: 20<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2015-05-01<br />Sales_Count: 12<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2015-06-01<br />Sales_Count: 16<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2015-07-01<br />Sales_Count: 13<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2015-08-01<br />Sales_Count: 15<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2015-09-01<br />Sales_Count: 22<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2015-10-01<br />Sales_Count: 21<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2015-11-01<br />Sales_Count: 25<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2015-12-01<br />Sales_Count: 27<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2016-01-01<br />Sales_Count:  9<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2016-02-01<br />Sales_Count:  9<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2016-03-01<br />Sales_Count: 20<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2016-04-01<br />Sales_Count: 13<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2016-05-01<br />Sales_Count: 19<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2016-06-01<br />Sales_Count: 15<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2016-07-01<br />Sales_Count: 21<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2016-08-01<br />Sales_Count: 21<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2016-09-01<br />Sales_Count: 26<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2016-10-01<br />Sales_Count: 13<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2016-11-01<br />Sales_Count: 29<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2016-12-01<br />Sales_Count: 30<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2017-01-01<br />Sales_Count: 15<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2017-02-01<br />Sales_Count: 15<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2017-03-01<br />Sales_Count: 26<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2017-04-01<br />Sales_Count:  9<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2017-05-01<br />Sales_Count: 21<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2017-06-01<br />Sales_Count: 24<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2017-07-01<br />Sales_Count: 24<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2017-08-01<br />Sales_Count: 17<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2017-09-01<br />Sales_Count: 36<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2017-10-01<br />Sales_Count: 30<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2017-11-01<br />Sales_Count: 44<br />Sub_Category: Phones<br />Sub_Category: Phones","Month: 2017-12-01<br />Sales_Count: 33<br />Sub_Category: Phones<br />Sub_Category: Phones"],"type":"scatter","mode":"lines+markers","line":{"width":3.7795275590551185,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"Phones","legendgroup":"Phones","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(231,107,243,1)","opacity":1,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(231,107,243,1)"}},"visible":"legendonly","frame":null},{"x":[16071,16102,16130,16161,16191,16222,16252,16283,16314,16344,16375,16405,16436,16467,16495,16526,16556,16587,16617,16648,16679,16709,16740,16770,16801,16832,16861,16892,16922,16953,16983,17014,17045,17075,17106,17136,17167,17198,17226,17257,17287,17318,17348,17379,17410,17440,17471,17501],"y":[8,3,16,13,6,9,13,9,24,19,27,30,2,3,13,11,14,11,9,16,34,14,27,17,4,11,12,18,16,16,21,7,30,15,30,30,14,7,21,15,18,27,16,25,36,24,42,43],"text":["Month: 2014-01-01<br />Sales_Count:  8<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2014-02-01<br />Sales_Count:  3<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2014-03-01<br />Sales_Count: 16<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2014-04-01<br />Sales_Count: 13<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2014-05-01<br />Sales_Count:  6<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2014-06-01<br />Sales_Count:  9<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2014-07-01<br />Sales_Count: 13<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2014-08-01<br />Sales_Count:  9<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2014-09-01<br />Sales_Count: 24<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2014-10-01<br />Sales_Count: 19<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2014-11-01<br />Sales_Count: 27<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2014-12-01<br />Sales_Count: 30<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2015-01-01<br />Sales_Count:  2<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2015-02-01<br />Sales_Count:  3<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2015-03-01<br />Sales_Count: 13<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2015-04-01<br />Sales_Count: 11<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2015-05-01<br />Sales_Count: 14<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2015-06-01<br />Sales_Count: 11<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2015-07-01<br />Sales_Count:  9<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2015-08-01<br />Sales_Count: 16<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2015-09-01<br />Sales_Count: 34<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2015-10-01<br />Sales_Count: 14<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2015-11-01<br />Sales_Count: 27<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2015-12-01<br />Sales_Count: 17<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2016-01-01<br />Sales_Count:  4<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2016-02-01<br />Sales_Count: 11<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2016-03-01<br />Sales_Count: 12<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2016-04-01<br />Sales_Count: 18<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2016-05-01<br />Sales_Count: 16<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2016-06-01<br />Sales_Count: 16<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2016-07-01<br />Sales_Count: 21<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2016-08-01<br />Sales_Count:  7<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2016-09-01<br />Sales_Count: 30<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2016-10-01<br />Sales_Count: 15<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2016-11-01<br />Sales_Count: 30<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2016-12-01<br />Sales_Count: 30<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2017-01-01<br />Sales_Count: 14<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2017-02-01<br />Sales_Count:  7<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2017-03-01<br />Sales_Count: 21<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2017-04-01<br />Sales_Count: 15<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2017-05-01<br />Sales_Count: 18<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2017-06-01<br />Sales_Count: 27<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2017-07-01<br />Sales_Count: 16<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2017-08-01<br />Sales_Count: 25<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2017-09-01<br />Sales_Count: 36<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2017-10-01<br />Sales_Count: 24<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2017-11-01<br />Sales_Count: 42<br />Sub_Category: Storage<br />Sub_Category: Storage","Month: 2017-12-01<br />Sales_Count: 43<br />Sub_Category: Storage<br />Sub_Category: Storage"],"type":"scatter","mode":"lines+markers","line":{"width":3.7795275590551185,"color":"rgba(255,98,188,1)","dash":"solid"},"hoveron":"points","name":"Storage","legendgroup":"Storage","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(255,98,188,1)","opacity":1,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(255,98,188,1)"}},"visible":"legendonly","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826498,"l":37.260273972602747},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Monthly Sales for the Top 3 Most Sold Sub Categories","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[15999.5,17572.5],"tickmode":"array","ticktext":["2014","2015","2016","2017","2018"],"tickvals":[16071,16436,16801,17167,17532],"categoryorder":"array","categoryarray":["2014","2015","2016","2017","2018"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Month","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-2.9500000000000002,83.950000000000003],"tickmode":"array","ticktext":["0","20","40","60","80"],"tickvals":[0,20.000000000000004,40,59.999999999999993,80],"categoryorder":"array","categoryarray":["0","20","40","60","80"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Sales Count","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Sub Category","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"5ef850211a37":{"x":{},"y":{},"colour":{},"type":"scatter"},"5ef82d4039fa":{"x":{},"y":{},"colour":{}}},"cur_data":"5ef850211a37","visdat":{"5ef850211a37":["function (y) ","x"],"5ef82d4039fa":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div></div>
<div id="63b6b803-535d-4c11-88ca-864cb2ac3a70" class="cell markdown">
<p>This aggregated Quantity starts to show trends and seasonality, and is much more useful to base predictions on! We will use these aggregated sub-categories for the rest of the assignment.</p>
<p>To properly finish our data preprocessing we ran some statistics on Quantity aggregated by Sub_Category. Table x contains some descriptive statistics.</p>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [16]:</pre></div><div id="7975bfd5-303a-4a60-a019-2926de193a0b" class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>library(dplyr)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>library(kableExtra)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the data</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>outlier_summary <span class="op">&lt;-</span> data <span class="op">%&gt;%</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  group_by(Sub_Category) <span class="op">%&gt;%</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  summarize(</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    Min <span class="op">=</span> <span class="bu">round</span>(<span class="bu">min</span>(Quantity), <span class="dv">2</span>),</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    Mean <span class="op">=</span> <span class="bu">round</span>(mean(Quantity), <span class="dv">2</span>),</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    Max <span class="op">=</span> <span class="bu">round</span>(<span class="bu">max</span>(Quantity), <span class="dv">2</span>),</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    Sd <span class="op">=</span> <span class="bu">round</span>(sd(Quantity), <span class="dv">2</span>),</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    CI_lower <span class="op">=</span> <span class="bu">round</span>(Mean <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> (Sd <span class="op">/</span> sqrt(n())), <span class="dv">2</span>),</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    CI_upper <span class="op">=</span> <span class="bu">round</span>(Mean <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> (Sd <span class="op">/</span> sqrt(n())), <span class="dv">2</span>),</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Output tables</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>kable(</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  outlier_summary,</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>  caption <span class="op">=</span> <span class="st">"Statistics for Sub_Category quantity"</span>,</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  <span class="bu">format</span> <span class="op">=</span> <span class="st">"pipe"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

</div>
</div></div>
<div id="71d8e557-5c41-4207-bf1a-fc92687234ff" class="cell markdown">
<p>The statistics for <code>Quantity</code> aggregated by <code>Sub_Category</code> looks valid. We can visualize it as histogram and check for anomalies. Figure y contains histograms of <code>Quantity</code> per <code>Sub_Category</code>.</p>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [18]:</pre></div><div id="0af7d6e2-9515-432c-aeb9-c3fe137a48ee" class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>sub_categories <span class="op">&lt;-</span> unique(data$Sub_Category)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>p <span class="op">&lt;-</span> plot_ly()</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="kw">in</span> seq_along(sub_categories)) {</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  sub <span class="op">&lt;-</span> sub_categories[i]</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  subset_data <span class="op">&lt;-</span> data <span class="op">%&gt;%</span> <span class="bu">filter</span>(Sub_Category <span class="op">==</span> sub)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  p <span class="op">&lt;-</span> add_trace(</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    p,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> subset_data$Quantity,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">type</span> <span class="op">=</span> <span class="st">"histogram"</span>,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    name <span class="op">=</span> sub,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    visible <span class="op">=</span> ifelse(i <span class="op">==</span> <span class="dv">1</span>, TRUE, FALSE)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co"># We add a drop down menu for Sub_Category as toggling visibility in default ggplot2 adds the histograms up. Instead we want to be able to show each histogram seperately. </span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>dropdown_buttons <span class="op">&lt;-</span> lapply(seq_along(sub_categories), function(i) {</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="bu">list</span>(</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>    method <span class="op">=</span> <span class="st">"update"</span>,</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    args <span class="op">=</span> <span class="bu">list</span>(</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>      <span class="bu">list</span>(visible <span class="op">=</span> lapply(seq_along(sub_categories), function(j) j <span class="op">==</span> i)),</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>      <span class="bu">list</span>(xaxis <span class="op">=</span> <span class="bu">list</span>(title <span class="op">=</span> <span class="st">"Quantity"</span>, autorange <span class="op">=</span> TRUE), </span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>           yaxis <span class="op">=</span> <span class="bu">list</span>(title <span class="op">=</span> <span class="st">"Frequency"</span>, autorange <span class="op">=</span> TRUE))</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    label <span class="op">=</span> sub_categories[i]</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Style drop down layout</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>p <span class="op">&lt;-</span> p <span class="op">%&gt;%</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>  layout(</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"Distribution of Quantity Sold per Order by Sub Category"</span>,</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>    xaxis <span class="op">=</span> <span class="bu">list</span>(title <span class="op">=</span> <span class="st">"Quantity"</span>),</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>    yaxis <span class="op">=</span> <span class="bu">list</span>(title <span class="op">=</span> <span class="st">"Frequency"</span>),</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>    showlegend <span class="op">=</span> FALSE,  <span class="co"># Drop down instead of legend</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>    updatemenus <span class="op">=</span> <span class="bu">list</span>(</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>      <span class="bu">list</span>(</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>        <span class="bu">type</span> <span class="op">=</span> <span class="st">"dropdown"</span>,</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>        buttons <span class="op">=</span> dropdown_buttons,</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>        direction <span class="op">=</span> <span class="st">"down"</span>,</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="fl">0.99</span>,</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> <span class="fl">0.99</span>,</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>        showactive <span class="op">=</span> TRUE,</span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>        xanchor <span class="op">=</span> <span class="st">"left"</span>,</span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>        yanchor <span class="op">=</span> <span class="st">"top"</span></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-b9d6d592383b63c2bc21" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-b9d6d592383b63c2bc21">{"x":{"visdat":{"5ef8564c3753":["function () ","plotlyVisDat"]},"cur_data":"5ef8564c3753","attrs":{"5ef8564c3753":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[2,7,3,4,3,5,3,6,4,4,13,2,2,5,2,5,1,1,4,4,2,3,1,4,3,2,7,2,2,3,7,3,2,2,3,4,3,2,1,3,2,2,1,2,1,3,2,2,1,7,7,2,4,3,1,7,1,5,3,3,2,3,5,2,9,2,4,2,4,3,1,2,3,2,2,2,4,9,2,3,6,5,5,3,3,5,5,2,9,1,1,8,3,7,2,4,5,2,3,5,2,9,6,7,4,3,4,3,3,4,7,5,9,3,8,3,3,2,3,3,8,6,5,5,5,7,4,1,5,4,9,6,3,2,6,5,3,4,1,5,2,2,5,10,1,2,5,2,4,2,2,10,3,2,3,3,6,2,12,5,3,2,3,5,2,6,2,5,9,5,8,7,4,1,2,1,2,2,6,2,3,6,3,2,1,2,3,7,2,5,4,2,5,2,5,3,3,2,3,6,2,2,5,4,7,6,3,7,1,3,1,2,4,3,2,10,1,2,3,1,3,8,3,5,5,5,4,4],"type":"histogram","name":"Bookcases","visible":true,"inherit":true},"5ef8564c3753.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[3,2,3,1,5,5,8,2,3,2,8,2,9,7,7,2,8,7,2,3,2,1,4,3,2,4,5,4,3,3,2,3,2,2,3,1,4,2,3,1,2,3,2,3,2,3,2,3,5,5,2,3,5,4,2,6,5,5,3,3,14,2,4,9,3,1,2,3,4,3,3,2,9,6,5,2,2,3,2,4,2,14,5,7,6,3,6,1,5,2,5,2,6,9,1,8,3,3,1,3,2,4,7,2,2,3,5,6,4,5,1,4,3,8,7,3,5,5,4,4,3,3,3,2,4,4,1,7,3,2,8,4,1,3,1,2,5,7,5,2,8,2,2,6,3,2,3,2,1,4,4,1,6,3,2,4,2,2,1,4,8,4,2,3,2,7,5,2,2,3,1,1,7,3,2,3,2,2,7,6,4,5,4,8,2,6,5,2,7,4,8,5,5,3,2,5,5,2,3,5,2,7,2,2,2,10,1,2,6,4,2,1,6,2,5,12,2,5,3,3,5,9,1,5,3,7,5,1,2,3,3,3,1,7,3,6,2,3,2,5,6,4,7,3,5,4,2,3,1,2,5,1,4,7,2,2,2,2,5,2,6,2,3,1,6,1,2,3,9,3,3,4,3,1,3,4,2,3,6,3,3,2,9,3,2,1,4,3,3,5,6,4,3,2,3,3,3,9,1,1,2,6,3,3,4,6,3,3,2,3,3,5,7,7,6,2,3,6,5,2,3,9,6,3,3,4,3,6,10,2,1,5,2,1,2,3,6,3,3,3,2,4,10,7,1,1,2,1,2,1,5,2,5,4,2,9,2,3,2,3,5,3,2,1,3,8,3,1,11,5,7,9,2,6,14,6,4,5,5,1,4,2,9,5,4,2,1,3,2,2,2,5,3,8,5,2,3,3,5,6,6,4,9,4,3,3,8,6,2,4,3,5,2,4,3,4,2,3,2,4,2,3,2,2,2,4,2,3,5,8,7,5,3,4,2,3,3,3,4,5,6,3,2,3,2,9,4,9,2,2,2,3,2,1,3,7,2,3,2,3,2,2,5,9,7,2,5,4,2,5,1,4,3,2,2,3,4,7,8,1,3,3,4,6,7,1,4,5,3,5,1,3,4,2,4,2,4,3,2,6,4,1,5,5,6,4,4,2,5,2,4,3,2,2,2,4,2,5,8,4,3,3,3,5,6,3,4,2,3,4,3,3,4,3,3,2,3,7,5,3,2,3,2,2,4,5,3,3,2,9,3,3,5,7,2,5,1,2,11,3,5,3,3,1,1,1,3,3,1,2,3,6,1,2,2,5,3,2,3,3,1,8,2,5,6,8,2,2,14,7,7,1,5,5,9,6,2,4,3,3,13,4,5,5,3,2,2,4,4,3,4,7,4,3,3,5,6],"type":"histogram","name":"Chairs","visible":false,"inherit":true},"5ef8564c3753.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[2,6,2,2,4,2,3,8,3,10,2,2,9,7,2,2,1,7,3,4,3,7,2,4,4,2,3,3,2,7,2,2,1,4,7,5,2,2,3,3,2,5,1,2,3,4,3,1,1,4,5,2,2,14,4,3,7,2,7,6,1,4,8,2,7,6,3,8,1,2,1,2,2,3,4,2,2,3,4,6,6,4,2,2,2,4,5,2,9,3,2,2,8,5,1,1,7,2,7,6,4,2,5,4,1,2,2,5,5,1,5,4,7,4,3,8,10,4,4,3,1,8,6,2,4,3,5,3,5,8,1,3,4,7,5,3,3,2,6,5,2,3,9,11,12,2,3,3,3,5,4,3,1,3,9,5,1,2,5,2,7,2,8,5,1,2,2,3,2,2,2,5,3,3,3,4,2,5,8,1,2,3,3,8,3,6,4,4,2,6,2,3,3,4,3,3,6,4,2,1,2,3,5,6,1,3,9,4,3,3,4,7,1,4,6,3,1,2,3,4,9,4,4,7,2,8,2,5,2,2,8,5,1,5,10,4,2,3,2,1,1,3,6,6,8,5,9,2,3,3,2,5,8,5,2,8,3,2,5,3,3,2,7,2,1,2,3,3,4,9,3,13,5,2,5,5,3,4,2,5,5,6,2,4,2,2,2,2,7,4,3,2,6,2,2,7,3,7,1,2,1,3,5,2,1,2,2,4,3,9,1,2,1,6,2,2,3,5,3,5,3,2,1,3,2,2,3,4,7,7,7,3,3,4,2,2,2,5,6,2,3,4,6,2,3,3,2,1,3,9,5,3,3,5,5,3,2,3,2,1,4,3,5,10],"type":"histogram","name":"Labels","visible":false,"inherit":true},"5ef8564c3753.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[5,9,3,3,6,2,5,2,3,5,5,3,3,7,3,7,2,6,3,2,4,5,1,3,3,2,10,4,5,2,4,3,12,7,13,4,8,5,4,7,2,6,12,1,5,5,3,2,3,3,3,2,6,4,2,5,9,4,6,6,7,5,2,7,3,1,5,1,1,3,3,1,7,2,3,3,1,3,1,1,1,2,5,7,4,3,3,2,2,2,3,5,5,9,3,5,3,4,3,3,3,3,2,1,2,3,2,2,2,1,3,3,1,1,3,2,2,6,3,2,7,8,2,6,3,2,6,3,3,2,3,5,2,3,2,1,3,2,1,8,4,9,5,4,3,3,2,2,3,3,7,3,3,4,2,3,1,5,1,3,4,7,5,2,5,9,5,1,2,1,7,1,10,7,7,8,6,9,9,6,5,2,1,3,5,2,2,7,2,8,5,3,3,2,2,2,3,6,4,2,3,2,1,5,8,3,9,5,1,1,2,1,9,3,9,3,1,7,3,6,3,3,2,3,3,7,4,3,1,6,3,2,1,2,4,5,4,1,9,4,9,3,2,4,10,3,2,4,4,2,3,6,3,12,7,4,2,7,7,4,8,1,4,1,4,3,5,5,3,3,4,4,1,4,3,6,7,2,7,2,5,1,2,3,3,2,3,4,2,6,1,2,7,4,1,3,7,4,3,3,5,3,2,1,2,3,7,3,3,4,13,2,2,2,8,1,2,2,1],"type":"histogram","name":"Tables","visible":false,"inherit":true},"5ef8564c3753.4":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[2,6,2,2,2,4,6,1,3,1,3,7,6,7,7,6,3,2,3,3,4,1,6,1,2,6,2,5,3,1,4,6,8,1,2,4,4,7,3,3,2,3,4,3,2,5,3,3,3,2,3,6,5,5,3,3,3,2,3,2,9,9,2,2,1,4,3,2,7,14,5,2,4,3,3,3,3,3,4,2,6,1,3,2,2,12,7,2,2,1,2,3,5,3,3,3,1,5,3,2,7,6,4,3,1,2,3,4,6,2,2,2,3,1,9,3,2,3,1,4,5,2,3,2,3,2,4,2,3,11,5,1,3,6,4,4,4,3,1,3,3,6,1,6,3,2,5,2,2,7,2,3,2,5,3,6,3,5,3,1,5,3,3,2,9,2,9,1,2,8,1,5,5,4,2,4,6,8,2,1,7,2,3,3,4,3,3,4,9,5,5,4,5,3,3,2,6,3,3,4,1,5,2,2,6,5,4,3,2,3,7,5,6,2,3,3,8,3,4,1,2,6,2,3,4,4,2,6,4,2,2,8,8,7,1,2,3,2,2,5,2,5,11,4,2,5,3,6,2,5,5,1,2,1,3,3,3,8,2,5,2,9,4,4,2,3,9,5,5,8,8,7,2,3,6,3,1,2,4,3,5,9,3,3,1,2,3,5,5,2,1,9,4,4,3,2,3,6,2,5,1,2,5,3,4,7,3,3,7,2,1,12,3,5,3,2,5,2,8,2,3,7,5,2,2,7,5,5,2,4,7,1,6,10,5,3,5,4,4,2,2,14,4,4,2,3,4,4,2,6,5,2,5,2,7,6,7,3,1,4,2,9,4,7,3,2,2,2,1,4,3,1,3,8,2,4,1,3,5,5,4,2,3,1,1,8,3,4,6,2,7,3,5,2,5,2,3,1,3,5,2,3,5,1,2,2,3,7,4,4,3,4,2,3,2,5,6,3,3,3,2,4,3,6,2,4,4,5,5,1,3,3,5,3,7,4,6,9,4,5,1,3,2,6,1,5,4,2,5,3,3,3,6,3,2,3,3,3,3,2,3,1,3,5,4,2,5,1,4,1,3,1,1,2,2,5,2,2,5,5,4,3,3,2,1,2,4,2,9,1,2,5,5,3,7,4,6,2,9,4,5,5,7,3,7,1,1,2,3,3,5,4,3,4,5,6,5,2,2,4,5,3,4,4,2,2,9,4,2,3,4,4,3,1,4,3,2,7,2,8,3,3,3,2,7,7,3,2,2,3,5,3,1,2,4,3,5,5,5,2,1,7,3,2,5,3,1,2,6,5,5,3,4,3,1,5,3,4,3,6,2,1,1,4,3,9,3,2,3,2,3,5,2,2,5,4,4,3,5,1,3,1,4,4,2,1,2,3,2,3,7,3,2,4,2,1,4,2,10,3,6,5,8,4,4,9,5,5,7,1,6,2,11,3,6,3,6,5,2,3,2,2,2,2,5,7,1,1,5,2,3,9,2,2,3,1,2,2,3,2,3,2,3,4,1,6,9,3,3,2,3,3,2,2,3,10,3,4,5,1,4,1,4,6,5,9,3,5,10,7,5,7,1,3,3,10,3,2,4,6,1,5,4,3,2,2,5,2,2,3,2,3,4,7,3,3,3,1,5,1,7,7,3,1,1,1,5,1,3,4,2,3,3,3,1,2,7,2,9,2,5,2,4,4,3,5,5,2,3,6,1,3,9,3,4,3,1,3,2,1,5,4,3,2,3,6,3,1,6,1,2,2,6,3,5,8,2,2,4,3,3,1,13,3,6,1,7,3,3,2,6,7,7,4,6,2,2,5,5,6,1,9,2,6,3,2,3,2,2,2,6,5,2,1,4,4,3,7,5,2,4,3,1,2,11,3,6,2,5,2,3,1,4,2,3,5,2,7,2,4,3,1,4,3,9,3],"type":"histogram","name":"Storage","visible":false,"inherit":true},"5ef8564c3753.5":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[7,3,5,2,4,2,3,5,3,7,3,2,3,3,14,2,4,7,4,3,5,3,3,9,3,8,3,4,2,4,1,3,1,8,1,4,2,1,1,5,7,3,4,9,3,3,3,4,1,3,3,1,8,3,2,2,3,7,5,3,4,5,3,3,1,3,3,2,3,6,5,11,4,2,7,1,2,2,2,4,2,1,3,5,2,6,1,7,6,4,2,6,5,5,7,4,3,2,3,9,2,3,2,9,2,2,3,2,4,2,6,2,4,1,2,3,1,3,2,3,1,1,2,5,3,2,6,3,1,8,6,3,3,2,1,5,3,3,2,4,3,4,2,4,4,3,2,2,2,6,2,5,3,2,13,2,2,2,5,3,7,2,2,3,2,5,4,8,2,2,9,5,1,7,5,2,2,4,1,4,2,2,3,5,3,4,2,5,3,2,3,4,5,7,6,3,3,2,3,7,5,1,3,1,5,8,2,6,3,1,1,5,2,2,7,6,3,5,4,5,2,6,8,7,4,8,7,2,9,2,8,8,3,7,6,8,5,3,3,1,2,4,3,2,2,8,3,6,5,1,2,3,7,4,3,1,2,6,4,3,8,5,5,3,6,2,6,1,4,2,4,11,2,7,1,3,4,1,7,3,2,2,6,2,2,4,1,3,3,3,3,2,5,2,2,3,5,2,5,3,2,2,3,7,5,3,2,3,2,5,5,3,3,3,2,3,7,5,3,1,4,3,3,3,9,7,4,4,2,3,2,3,6,2,2,4,3,4,3,2,4,5,7,4,3,2,2,4,2,1,2,2,3,4,3,2,2,6,3,9,2,1,5,6,4,4,1,2,2,2,1,3,3,3,8,4,3,5,2,3,6,11,11,5,6,5,3,4,4,2,3,5,3,5,2,3,3,9,5,5,3,11,4,2,3,2,4,6,2,3,1,5,2,5,3,5,2,5,1,4,2,1,2,4,6,4,3,1,5,3,4,3,3,8,3,2,3,4,3,2,2,3,1,4,2,3,3,1,9,5,1,3,9,3,3,2,3,3,4,9,3,2,2,5,7,3,4,9,3,6,3,9,8,4,2,4,3,2,2,5,7,1,3,2,4,4,2,1,2,5,2,2,1,2,6,1,4,6,2,3,5,6,2,2,3,2,2,3,5,1,5,2,2,2,2,6,1,2,2,2,11,2,3,4,5,14,2,4,3,6,3,2,2,1,7,3,4,3,5,1,4,4,2,2,4,3,3,5,3,2,4,3,3,4,5,1,2,4,3,6,3,4,3,2,7,4,3,3,2,3,4,1,3,5,3,8,2,3,3,3,9,2,3,3,4,3,8,3,3,8,3,5,2,8,3,3,3,3,4,5,5,4,2,4,3,3,4,3,5,7,2,6,4,3,4,5,2,3,5,3,3,6,2,2,5,4,7,6,2,4,6,3,4,6,5,5,2,4,3,1,2,2,5,3,8,3,3,2,1,4,6,4,2,2,2,1,5,4,3,7,2,1,3,2,3,3,4,2,5,5,6,2,2,5,3,2,4,8,7,7,2,5,8,7,2,3,7,1,2,5,2,2,6,2,3,3,2,14,5,1,3,8,1,3,2,5,1,5,7,4,2,6,3,3,5,3,3,2,6,3,6,3,9,3,2,3,9,4,4,3,4,3,3,3,2,3,3,2,6,2,4,3,5,1,5,1,2,3,6,5,3,5,7,3,2,3,6,2,3,9,1,1,2,6,5,3,5,3,3,2,5,3,9,6,3,1,4,2,3,5,3,2,4,3,2,3,2,4,3,5,1,5,2,3,3,2,5,4,2,2,5,10,5,4,2,5,3,10,7,2,6,1,14,6,1,4,4,2,6,1,3,3,2,2,5,7,1,3,4,5,3,1,4,2,3,3,1,2,3,2,2,10,4,12,9,3,3,2,3,5,2,3,2,5,5,3,2,2,7,6,3,3,3,3,4,7,3,4,5,2,3,4,2,2,2,1,2,3,9,2,3,2,3,1,4,3,4,4,2,8,2,1,3,4,8,2,1,5,3,5,5,2,5,2,3,3,5,3,7,5,2,2,3,5,5,3,4,2,6,3,3,3,4,8,4,2,2,2,2,3,2,1,2,7,7,4,7,5,2,5,4,2,2,5,3,2,3,3,7,5,3,3,3,5,1,3,2],"type":"histogram","name":"Furnishings","visible":false,"inherit":true},"5ef8564c3753.6":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[4,2,7,6,2,1,8,5,3,1,2,4,3,3,3,6,1,5,2,3,2,1,2,3,1,3,6,1,4,4,3,2,4,2,1,1,6,8,4,6,3,6,3,3,5,2,2,1,3,3,3,2,4,3,2,9,9,5,8,1,7,2,7,3,4,2,3,4,2,6,2,2,4,4,4,3,3,2,3,1,3,2,3,7,3,5,2,3,7,7,9,4,3,7,3,1,7,2,3,2,7,1,2,2,1,6,2,2,3,3,3,3,4,3,6,7,3,5,3,2,2,2,6,2,3,7,5,4,8,9,5,6,2,2,3,5,1,3,4,7,4,3,6,3,5,3,3,5,4,3,2,3,3,2,5,4,3,2,5,3,5,1,3,3,5,3,2,3,3,2,2,7,7,3,1,7,5,3,5,4,3,4,3,9,4,1,1,3,2,3,3,4,2,8,8,2,5,5,5,1,2,7,6,2,9,2,6,5,6,3,2,3,9,1,4,2,1,3,3,5,4,3,9,5,3,1,2,10,7,4,1,2,7,3,3,1,2,3,5,4,1,3,1,2,5,5,8,2,6,5,3,3,7,7,1,3,3,6,7,7,2,2,9,3,4,5,3,4,2,3,7,2,9,3,5,4,5,1,4,2,10,2,2,1,4,3,2,1,2,1,5,4,3,6,3,5,8,3,2,7,2,1,1,3,6,3,4,5,3,4,3,2,7,3,5,2,4,2,3,3,3,4,4,6,1,1,2,4,7,3,9,3,1,6,7,3,3,2,2,5,2,7,1,1,2,1,2,1,2,3,3,2,4,3,4,10,2,2,3,3,2,2,3,6,3,3,3,1,7,5,9,4,4,3,4,3,3,5,2,5,3,8,3,5,4,3,2,2,2,2,3,1,3,4,1,4,5,3,2,3,11,1,2,8,7,3,2,3,2,2,7,2,5,2,5,2,3,7,3,3,5,3,5,2,9,5,3,2,1,2,4,2,5,5,3,5,5,2,2,3,2,4,1,3,2,2,3,2,1,2,4,5,2,5,3,2,5,5,6,1,4,1,4,2,9,1,2,3,1,7,3,2,2,2,2,1,3,7,2,5,2,3,3,5,3,9,4,3,4,6,4,4,2,10,6,7,4,6,5,3,4,3,2,7,3,2,6,5,3,5,1,2,7,2,5,5,3,6,10,5,3,5,2,3,6,6,3,7,6,3,2,7,6,5,5,3,6,2,3,3,5,1,2,5,4,2,3,4,3,2,3,3,2,2,7,5,3,3,2,2,2,5,4,2,4,2,2,2,3,4,3,3,8,5,2,2,2,5,3,3,7,2,5,7,7,5,2,8,3,2,1,1,4,3,3,5,3,2,4,2,1,4,2,5,5,9,1,3,4,7,3,2,3,7,2,3,1,3,4,5,5,3,2,3,3,4,3,9,3,2,1,3,5,3,2,3,3,3,3,3,5,6,9,8,1,3,2,3,9,3,4,4,5,6,5,4,8,2,7,5,1,3,2,2,2,1,2,5,3,9,7,1,8,2,2,2,7,5,7,2,3,3,3,12,2,3,2,2,5,5,6,2,3,2,8,4,4,5,4,2,2,2,2,5,4,2,4,3,3,5,5,5,7,4,9,2,8,5,5,3,2,2,3,2,2,6,2,7,1,5,8,3,4,7,3,2,3,1,7,3,3,3,5,2,2,6,4,1,2,1,6,5,3,2,3,4,6,7,3,9,1,2,3,9,14,2,5,5,4,2,3,5,9,4,7,3,6,4,3,4,8,2,3,2,2,4,3,2,2,2,2,3,7,2,5,7],"type":"histogram","name":"Art","visible":false,"inherit":true},"5ef8564c3753.7":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[6,4,3,7,4,4,2,5,4,2,1,7,5,11,3,2,7,3,4,5,6,4,2,3,3,2,6,4,7,2,6,3,2,12,3,2,4,4,6,5,6,1,3,5,8,1,3,3,3,2,4,2,5,3,4,2,3,9,10,1,4,3,3,1,2,1,1,3,3,5,2,4,2,1,3,7,2,3,8,3,7,4,1,1,3,7,2,3,2,5,2,3,5,12,3,3,2,2,5,7,1,1,3,7,5,8,5,7,8,4,4,3,3,2,3,5,3,7,2,1,3,5,4,2,5,3,3,2,7,5,8,9,2,3,4,7,2,1,3,3,2,5,4,5,2,2,5,4,1,3,5,3,4,3,2,2,2,5,6,3,3,2,3,7,7,3,2,8,1,4,3,3,3,2,2,9,3,3,1,3,3,5,4,1,5,3,7,2,4,7,4,2,5,3,9,7,4,7,4,2,1,4,3,3,3,2,3,1,1,4,4,7,10,3,4,5,2,6,1,4,4,7,5,3,1,4,1,5,7,2,13,2,3,2,3,4,8,1,1,3,11,1,3,3,2,3,5,7,2,3,2,3,5,2,2,4,14,4,5,3,3,3,3,3,4,1,3,2,2,1,4,5,2,3,8,3,3,7,5,2,2,4,1,3,2,2,7,1,3,4,8,9,2,2,3,7,5,2,2,1,2,1,1,3,6,2,3,2,3,3,4,3,2,2,4,5,2,4,2,1,2,4,5,1,2,2,3,6,3,4,8,6,1,3,1,1,8,7,3,3,5,1,7,2,1,5,3,2,3,5,1,5,3,5,2,5,1,2,3,3,5,2,3,3,2,2,5,2,5,3,4,2,3,7,9,6,3,2,3,5,2,3,3,5,3,3,7,2,9,3,13,5,7,3,3,6,4,3,2,3,5,2,3,2,5,2,7,3,2,2,2,7,4,3,7,2,1,2,4,1,9,9,2,2,3,4,3,8,2,5,1,2,4,5,6,3,2,2,2,2,2,3,2,1,4,3,6,4,1,6,6,4,3,2,2,3,2,2,7,4,1,3,3,3,2,2,2,2,8,5,3,5,3,3,8,2,2,5,2,1,3,3,14,3,5,5,2,2,3,6,1,3,4,2,3,3,5,4,4,1,1,2,3,2,3,3,3,6,7,1,1,3,3,7,2,5,3,4,2,3,4,4,4,4,3,4,2,3,3,1,4,9,3,10,7,3,3,8,5,3,2,3,4,3,2,2,3,5,3,4,2,3,8,3,6,2,3,4,5,3,2,1,2,3,3,5,1,5,5,4,3,2,2,6,1,2,4,5,3,1,4,3,5,3,3,1,5,2,5,4,6,7,2,1,1,3,6,7,4,5,4,5,14,4,4,7,3,2,3,7,5,2,6,3,3,5,1,3,5,2,2,8,2,2,2,7,1,2,5,5,3,2,2,1,5,3,9,6,9,1,2,4,2,5,3,2,3,3,2,1,3,3,1,5,5,2,1,5,1,4,8,6,3,2,5,3,1,3,6,2,2,2,4,6,3,1,2,9,2,6,6,7,6,1,7,3,5,5,7,1,4,3,5,5,2,3,3,4,2,4,4,1,2,2,4,3,2,2,12,5,5,1,3,4,1,1,4,3,3,5,4,2,7,1,3,4,3,6,4,4,2,5,2,8,2,8,2,4,2,2,7,3,10,2,2,4,2,3,2,2,3,5,2,3,2,2,1,1,2,3,3,3,3,4,7,5,6,2,2,3,8,8,4,6,2,2,3,3,5,7,5,4,5,2,5,2,2,1,2,1,2,2,3,3,3,7,9,3,4,3,2,5,2,2,2,3,2,2,6,3,2,2,7,5,2,5,5,4,9,3,2,3,2,5,4,7,4,4,2,3,2,3,3,1,7,1,5,9,2,6,3,5,4,2,4,2,1,6,2,2,7,3,3,3,4,3,3,2,6,3,9,3,5,5,9,4,3,5,5,2,5,5,1,3,2,4,3,1,8,4,3,5,2,3,5,2,2,5,2],"type":"histogram","name":"Phones","visible":false,"inherit":true},"5ef8564c3753.8":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[3,3,3,4,2,2,6,2,6,4,6,1,3,3,2,1,3,3,3,6,1,4,2,3,5,2,2,2,4,4,7,2,5,3,5,7,5,1,3,6,6,2,3,1,4,2,10,1,4,4,5,4,3,4,3,3,8,2,2,3,5,3,8,2,2,3,5,5,9,5,7,4,6,3,7,7,7,7,3,3,4,2,2,9,5,5,3,4,2,2,3,3,3,2,3,8,5,3,6,4,5,2,3,1,3,3,2,5,1,5,2,4,8,7,3,3,4,4,4,6,5,7,4,3,3,7,3,3,2,4,3,3,2,6,2,5,2,2,2,3,2,2,2,2,7,3,2,2,3,3,3,4,4,2,5,4,2,5,7,1,7,3,3,5,2,2,2,2,7,3,2,3,5,4,5,4,6,7,4,3,3,2,2,1,1,5,3,3,4,3,8,1,7,4,4,2,2,3,6,3,6,3,8,5,6,10,6,14,4,1,4,7,2,9,2,5,6,5,2,3,1,3,5,3,9,2,2,3,5,3,3,5,4,2,3,7,7,3,2,5,9,4,2,1,3,2,6,2,6,2,3,2,3,3,2,2,5,3,2,3,2,2,4,8,6,6,4,5,7,2,3,8,6,1,10,2,4,9,8,2,2,4,2,6,5,2,4,9,8,3,3,4,2,3,4,3,2,3,5,2,4,3,4,2,7,2,6,3,4,2,3,1,2,3,8,1,3,5,3,3,4,9,4,2,3,7,3,3,5,7,2,3,2,7,10,1,13,4,2,1,7,5,5,2,1,3,4,5,7,3,4,5,12,3,2,6,2,5,5,4,4,4,2,5,3,1,4,4,5,3,3,5,2,5,1,4,4,5,4,3,6,4,2,5,5,8,3,1,6,13,10,5,3,3,3,3,2,2,2,7,2,5,4,9,2,5,3,2,2,1,3,5,3,5,3,7,5,5,5,2,2,5,3,3,6,6,5,2,3,3,2,3,4,2,2,7,3,14,1,4,5,8,5,4,4,7,4,4,2,5,4,3,3,5,2,6,5,11,2,7,7,2,2,1,4,7,3,7,5,2,3,5,2,2,5,6,2,2,3,4,7,3,3,7,3,3,1,1,3,13,3,2,2,7,5,8,7,1,3,3,6,5,3,5,1,9,5,5,4,2,1,2,2,4,6,6,6,1,1,8,2,2,2,4,4,3,6,2,1,2,4,2,2,5,4,5,3,4,2,8,1,2,4,5,2,3,1,1,3,3,5,2,2,7,7,2,5,2,4,4,6,3,9,6,2,7,3,2,5,4,2,3,2,3,3,2,6,3,2,3,3,6,9,2,2,4,8,3,3,3,7,5,4,5,4,4,4,5,1,2,3,6,7,8,5,7,8,3,3,3,3,9,4,2,1,3,3,3,3,3,5,2,2,2,5,2,8,2,5,5,6,9,3,4,3,6,3,2,2,9,5,7,1,4,2,3,6,2,9,1,4,3,6,4,2,3,3,3,1,5,3,5,3,2,3,3,2,2,5,6,2,8,7,5,5,3,3,1,1,8,4,6,1,4,2,4,1,12,2,5,3,4,5,2,6,7,2,3,7,2,3,1,6,6,2,1,3,6,2,4,3,4,2,9,10,4,2,2,5,4,5,1,2,7,2,2,2,3,2,2,7,2,2,3,3,3,3,2,8,2,6,4,3,3,5,4,2,3,2,3,3,2,1,3,11,1,3,5,8,6,4,8,5,2,3,2,2,7,2,7,2,4,5,2,2,3,5,4,4,1,3,3,2,8,7,3,7,9,2,2,3,2,3,2,3,3,9,4,2,1,1,4,2,2,3,3,7,3,7,5,6,2,7,2,3,1,2,2,2,4,8,6,3,4,2,5,4,3,2,3,8,5,9,3,7,3,4,1,1,3,7,2,3,4,5,2,13,2,6,10,3,1,4,4,6,3,3,3,2,6,2,1,4,4,2,1,7,2,6,2,7,5,5,5,4,7,14,1,3,9,1,3,3,3,1,1,3,7,3,2,3,4,4,5,3,3,2,1,6,7,3,7,3,2,1,9,2,3,5,6,2,2,2,1,7,2,1,4,6,9,5,7,1,3,6,6,2,3,3,6,1,4,2,5,3,5,2,6,5,9,5,4,1,2,1,1,4,3,7,3,5,5,3,6,1,3,3,3,5,5,5,2,2,1,1,5,5,5,4,1,2,1,3,5,1,7,2,3,3,9,6,3,3,1,4,5,5,3,3,5,1,3,4,3,2,5,1,3,3,5,11,6,6,7,7,2,2,2,4,11,3,3,3,4,8,4,3,4,1,2,7,3,2,1,2,5,3,1,1,2,4,3,5,2,7,3,7,2,5,3,3,6,2,3,6,2,2,4,7,3,4,5,5,2,4,5,4,5,4,2,2,5,4,3,3,3,5,3,9,2,3,2,4,7,5,5,6,2,5,3,2,2,1,2,1,5,4,1,5,5,3,2,3,5,4,4,12,3,2,2,3,6,2,2,6,3,3,2,3,2,3,5,2,2,7,1,7,6,5,8,3,2,3,3,1,5,3,2,5,3,6,5,5,5,1,4,2,4,5,2,4,2,4,2,6,3,3,8,5,1,3,3,3,7,4,9,5,1,4,4,2,4,5,7,1,3,9,1,4,3,2,2,4,2,2,2,2,3,3,1,3,5,5,2,7,3,3,3,2,4,3,5,2,6,10,2,3,3,4,3,8,9,5,3,2,2,8,2,3,1,5,4,3,6,5,1,2,6,9,3,5,1,5,2,2,5,14,1,8,7,2,11,3,2,7,3,6,1,7,5,6,4,1,2,3,2,2,6,1,4,7,3,2,3,4,7,2,2,4,7,4,9,4,5,5,1,6,3,5,5,4,5,8,2,11,4,1,3,3,3,5,2,4,5,8,1,6,9,2,2,3,4,5,2,3,7,13,2,7,2,4,3,1,3,3,6,2,6,3,5,6,7,3,1,4,8,5,1,2,5,3,2,3,3,2,3,1,2,5,2,4,9,3,3,2,10,2,2,3,2,3,5,4,5,2,5,4,3,8,2,4,6,4,3,2,7,5,2,2,2,1,2,4,5,3,4,2,1,3,13,2,2,4,13,2,4,4,3,3,1,2,6,10,3,9,7,2,2,3,4,3,5,3,3,3,2,7,1,3,3,6,2,4,3,6,1,3,6,1,8,2,2,3,3,7,6,3,7,3,3,1,6,2,1,8,3,1,6,7,5,4,5,6,2,1,2,2,2,6,5,6,1,3,3,5,8,9,2,5,3,5,6,2,2,5,2,3,5,6,5,9,2,2,3,2,3,2,2,1,7,9,5,3,3,2,2,13,2,1,6,5,1,2,2,5,8,4,5,2,3,3,3,2,8,2,5,2,4,3,3,2,5,3,2,3,5,3,3,7,7,3,3,8,2,3,2,2,3,5,2,2,4,14],"type":"histogram","name":"Binders","visible":false,"inherit":true},"5ef8564c3753.9":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[5,5,7,1,6,3,5,5,2,4,1,2,5,2,2,8,3,3,4,2,3,5,3,2,5,2,3,2,2,2,3,3,2,5,6,9,4,3,2,5,2,2,4,9,3,2,2,2,2,3,4,13,3,13,2,5,2,2,3,2,3,6,3,5,2,2,14,5,3,2,4,2,2,6,7,1,2,4,1,3,2,6,5,2,2,7,4,3,3,3,6,2,2,1,6,3,2,7,2,5,2,4,6,7,9,3,2,4,3,4,2,4,4,4,3,3,2,3,2,4,1,5,5,1,8,2,7,2,3,1,7,4,1,3,3,2,1,5,5,4,4,2,2,5,3,5,11,2,3,3,4,7,3,3,2,5,2,7,5,2,6,4,8,3,7,4,9,3,3,2,1,4,2,7,3,5,3,3,6,2,1,1,3,4,4,4,1,2,1,6,2,5,6,3,4,3,3,2,3,2,2,2,3,2,5,3,2,7,4,2,3,7,2,2,8,6,5,1,1,2,1,2,1,4,3,4,2,7,4,2,7,3,8,3,1,5,2,4,12,6,2,5,5,3,3,2,4,3,3,2,5,5,3,3,4,3,4,2,2,1,3,2,3,6,3,2,5,2,2,4,5,2,8,2,5,2,2,6,2,2,1,6,4,1,3,2,7,4,2,5,1,4,2,2,5,6,3,2,3,2,4,5,4,5,2,7,4,5,2,3,4,3,1,3,2,3,9,3,3,7,8,4,7,2,3,4,5,3,2,6,4,3,8,2,5,3,8,1,5,6,2,3,1,3,6,3,1,2,1,4,2,2,4,3,1,7,2,9,4,4,4,4,10,3,3,5,7,6,2,5,3,9,4,6,6,3,2,5,5,3,6,2,3,2,6,1,2,3,1,3,4,5,2,4,2,3,2,7,8,2,4,2,3,4,6,3,2,4,3,1,7,4,1,5,5,3,5,4,3,2,7,3,5,5,2,2,3,5,1,7,5,5,2,4,4,3,1,2,6,5,3,1,4,3,3,1,4,1,6,2,8,2,4,4,7,3,2,2,2,3,5,3,3,8,7,2],"type":"histogram","name":"Appliances","visible":false,"inherit":true},"5ef8564c3753.10":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[3,3,5,2,3,2,3,1,2,7,4,3,2,3,1,3,7,4,1,3,2,3,8,3,3,6,2,5,6,4,1,2,2,4,5,6,5,3,3,2,2,4,5,5,5,4,7,2,2,5,1,1,7,1,7,8,4,1,7,5,1,2,2,5,8,3,14,4,4,2,3,2,3,1,10,2,3,8,5,3,5,2,1,3,8,1,1,4,9,3,4,1,4,7,2,2,8,1,8,4,2,6,2,1,3,2,5,6,1,8,3,2,3,3,3,8,3,2,2,5,3,6,3,2,4,3,5,3,3,5,5,3,3,5,3,2,3,4,1,1,5,3,2,5,2,1,3,2,1,3,2,4,4,4,3,4,2,2,3,3,5,5,7,6,4,1,8,7,3,3,4,8,9,3,7,2,1,5,4,5,6,4,2,7,2,4,7,1,1,3,9,5,8,2,3,4,4,2,3,3,1,3,3,4,4,1,2,2,3,3,2,2,2,2,3,3,1,2,5,2,2,6,8,2,4,3,2,2,2,11,9,2,4,1,3,7,3,1,6,7,2,6,5,2,6,1,2,7,2,1,1,7,3,2,1,5,2,4,5,3,4,3,4,2,6,3,3,2,3,3,3,1,13,5,5,7,6,3,4,3,1,7,1,4,3,3,6,3,3,2,2,9,8,4,3,1,3,2,3,3,2,1,2,2,1,7,3,2,4,3,3,2,5,5,1,4,4,5,2,7,4,4,9,5,2,1,7,5,2,2,4,3,1,5,3,4,6,2,2,2,2,5,8,4,2,3,2,3,3,3,4,3,4,6,2,3,1,3,2,3,5,3,2,4,3,3,4,4,7,2,5,2,1,2,3,6,2,9,8,6,2,3,7,4,7,4,3,2,5,5,2,5,7,5,7,2,7,5,5,3,6,4,4,2,4,3,3,4,5,2,1,2,8,7,6,2,3,2,6,3,1,8,6,4,5,3,9,3,13,2,6,4,8,5,2,4,7,2,1,2,5,5,8,3,9,9,4,3,2,3,3,2,6,4,6,2,9,2,8,4,6,9,14,2,2,1,9,3,2,7,2,2,3,2,3,9,7,7,8,3,7,4,2,1,3,1,5,1,3,2,5,2,2,3,1,1,3,2,2,3,6,5,5,2,1,9,3,7,5,2,2,3,3,3,1,2,2,3,7,2,3,2,3,2,3,2,6,5,1,3,5,3,1,2,2,10,9,2,1,4,2,5,5,2,4,5,4,3,4,3,9,3,5,8,3,3,6,3,3,3,3,3,6,3,2,3,5,3,1,5,6,7,2,2,3,2,2,1,3,6,3,2,3,3,2,3,2,5,3,5,9,3,3,1,2,2,2,6,7,2,3,3,3,2,4,5,6,1,5,3,2,3,2,5,3,3,3,7,6,2,2,5,5,5,2,3,4,11,1,4,7,5,4,3,9,5,4,2,2,5,2,2,7,7,2,6,3,5,3,4,5,3,3,4,6,2,10,4,3,3,2,6,7,5,2,1,2,7,2,6,3,3,2,2,3,2,2,2,2,3,5,4,2,3,5,2,4,5,4,3,4,2,1,3,6,4,3,3,2,9,5,3,3,3,3,7,7,5,5,3,3,2,4,2,6,5,3,2,3,4,3,4,2,6,2,4,2,3,3,1,7,5,9,4,2,3,3,2,3,5,2,7,4,4,7,5,1,2,6,4,3,3,3,2,2,2,4,3,5,12,2,3,3,2,7,1,3,3,3,9,5,9,3,5,1,2,2,2,2,1,3,5,5,6,3,2,4,2,2,4,3,4,1,4,2,2,3,4,3,4,5,5,2,2,3,3,4,9,2,1,5,3,4,5,2,3,4,4,4,2,1,4,2,2,6,6,4,4,3,5,3,1,2,7,7,3,8,5,3,3,1,9,2,4,2,5,6,5,3,3,2,2,4,5,5,7,2,7,3,11,1,9,2,9,4,3,1,3,1,3,2,6,2,5,4,4,1,8,2,2,2,3,2,1,3,2,5,2,2,3,4,14,5,3,4,5,3,7,7,6,1,3,2,1,2,1,1,2,3,7,4,5,2,4,5,4,3,3,1,2,4,5,4,4,6,3,2,5,6,4,4,7,2,3,4,2,2,3,2,2,9,1,1,5,5,3,7,4,5,4,7,1,2,3,3,2,9,9,5,3,4,2,1,3,3,6,9,5,2,2,3,1,6,9,1,2,1,3,5,9,6,2,2,3,7,3,3,5,7,3,2,1,3,3,4,2,3,4,5,3,4,2,3,6,7,2,2,3,3,5,3,3,3,3,5,5,9,7,5,2,4,2,1,2,5,2,8,3,1,5,2,3,2,6,2,4,6,3,4,4,3,5,6,2,4,3,2,2,6,4,6,3,5,4,3,2,5,2,3,5,2,4,3,2,4,7,3,2,2,5,8,5,2,1,6,11,5,2,2,4,4,3,2,2,2,6,2,5,3,8,2,5,2,4,8,4,2,3,2,3,6,2,5,3,3,5,2,3,4,2,1,5,2,3,4,4,3,2,3,4,3,9,3,6,2,3,1,6,2,10,1,1,4,9,3,9,6,5,3,5,3,1,3,4,5,1,2,3,3,2,2,7,2,4,10,3,2,3,4,8,2,1,2,2,2,3,8,2,2,4,7,4,2,5,4,6,3,2,2,1,3,2,3,1,6,7,4,2,3,5,3,7,6,3,3,4,8,3,8,3,2,2,4,6,6,4,2,5,7,2,5,2,4,6,11,3,4,4,2,9,8,2,3,3,3,2,7,2,5,2,7,3,1,3,4,2,13,4,3,5,3,5,2,7,4,5,1,3,6,13,1,14,2,1,3,2,2,2,8,3,5,4,9,7,5,2,3,4,1,3,3,2,8,3,3,3,2,2,2,3,4,4,1,2,3,2,3,7,2,2,6,3,2,2,7,9,1,3,10,2,6,3,2,5,2,2,2,2,7,2,1,3,2,2,8,5,6,4,2,7,2,2,2,6,2,5,6,3,1,2,1,4,1,6,4,5,5,1,5,4,5,7,10,3,1,5,2,2,6,1,1,3,2,2,2,1,2,2,5,7,1,1,5,4,2,2,1,2,7,4],"type":"histogram","name":"Paper","visible":false,"inherit":true},"5ef8564c3753.11":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[3,2,3,2,2,1,3,6,8,5,2,7,2,8,2,2,3,13,3,2,7,5,2,4,1,1,8,10,2,3,2,2,5,6,7,5,5,4,9,3,2,2,2,2,1,2,6,2,3,5,3,4,4,8,3,3,3,1,1,4,3,3,2,4,6,2,2,3,2,7,3,4,3,7,6,1,3,5,7,9,3,5,1,7,1,2,1,2,1,2,5,9,3,9,3,3,1,8,1,3,4,1,6,3,4,2,3,3,3,2,3,4,3,3,4,3,1,4,3,2,3,2,2,4,3,2,2,2,4,4,4,2,5,7,2,6,3,6,5,2,7,3,5,2,3,5,2,8,4,2,3,5,6,4,7,3,5,7,2,5,1,9,4,3,7,2,3,7,3,3,5,2,5,7,3,1,2,4,7,4,5,3,7,3,1,4,9,2,2,9,5,1,7,5,3,8,5,6,6,4,2,4,4,2,1,4,7,3,4,1,3,5,6,2,4,2,1,4,3,3,1,7,3,3,4,3,4,3,4,1,4,7,6,4,3,3,5,2,5,2,5,6,2,3,2,3,1,5,3,1,1,3,2,3,8,2,5,1,2,3,3,2,5,7,3,2,1,2,2,5,9,4,5,3,3,3,8,3,3,4,2,4,6,9,2,2,1,7,6,1,10,10,4,7,1,5,2,3,3,7,2,1,3,5,7,2,6,9,2,8,7,5,2,2,2,5,6,9,4,6,10,3,1,4,4,1,2,7,4,6,3,4,5,3,1,6,3,2,4,2,5,3,1,2,3,3,3,4,6,7,3,3,2,12,3,3,3,3,2,4,5,4,6,5,9,6,2,9,4,1,3,3,2,3,3,2,5,2,5,3,4,1,3,4,2,2,4,6,7,2,3,5,4,4,5,1,6,2,5,1,1,6,3,2,2,1,3,2,5,3,1,5,5,2,4,2,2,4,4,6,3,3,7,3,3,2,3,2,9,5,4,2,3,3,3,3,4,5,1,5,3,4,9,3,3,3,6,1,4,5,3,3,1,2,10,3,2,12,5,3,2,2,2,6,2,2,2,2,3,5,5,3,3,12,2,2,3,3,2,7,3,3,3,1,2,8,6,7,3,7,7,1,2,2,2,14,1,5,4,3,8,3,1,2,1,5,3,4,3,3,5,6,9,3,2,2,2,3,11,3,3,4,7,4,3,4,2,2,2,2,4,4,3,6,9,4,4,3,5,2,4,3,5,2,3,10,3,7,4,1,4,2,2,7,4,2,2,5,9,9,3,5,2,3,4,2,10,2,5,3,2,3,4,8,3,3,3,4,3,1,2,5,3,2,3,2,4,2,2,6,8,2,2,3,2,3,3,2,2,5,6,8,1,6,2,4,3,3,5,3,2,2,2,5,5,3,5,4,3,3,5,8,7,2,5,4,5,6,3,5,3,2,3,6,2,4,2,3,3,5,11,2,3,2,3,8,7,2,5,3,2,3,2,5,3,5,5,5,2,4,2,5,3,7,5,5,3,7,5,3,4,4,3,3,3,2,3,6,3,7,3,3,2,3,14,2,3,1,1,5,2,1,6,2,2,3,4,4,3,5,5,2,2,5,3,3,2,2,7,2,2,2,9,3,4,4,4,3,5,2,2,4,1,2,3,9,3,2,4,3,2,6,5,2,4,5,3,4,7,5,2,3,7,2,2,1,5,2,5,3,3,2,3,9,1,2,4,7,4,4,13,3,2,1,7,11,2,4,14,3,3,1,1,1,1],"type":"histogram","name":"Accessories","visible":false,"inherit":true},"5ef8564c3753.12":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[2,9,7,2,6,9,3,5,7,4,3,2,1,2,3,2,6,2,7,4,2,2,3,3,2,2,3,2,4,1,3,2,3,2,3,6,5,8,1,2,2,9,2,3,5,4,1,3,7,3,1,2,3,5,6,3,3,5,2,6,2,2,3,9,3,2,2,2,5,3,2,3,5,2,2,5,1,5,4,2,2,5,2,2,5,3,3,4,6,3,3,1,3,3,3,3,1,5,6,4,4,4,3,3,3,3,4,2,7,2,2,1,2,2,5,5,3,2,2,2,2,2,3,7,9,2,1,3,3,2,2,3,1,8,2,3,1,6,7,3,2,3,1,2,9,2,4,6,1,7,1,5,3,3,4,5,3,5,2,7,3,7,4,1,4,4,3,3,2,3,2,1,8,3,3,5,2,2,4,5,5,3,5,7,9,3,1,2,2,5,3,5,3,8,7,4,3,1,2,7,6,3,5,7,3,2,4,9,3,3,3,3,4,5,1,2,5,6,3,1,3,9,2,7,3,3,2,8,2,3,5,3,2,5,3,1,2,7,2,2,1,4,2,3,6,2,4,6,2,2,1,1,7,2],"type":"histogram","name":"Envelopes","visible":false,"inherit":true},"5ef8564c3753.13":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[7,14,9,2,9,2,6,7,3,2,4,13,5,3,2,4,5,3,7,2,3,3,7,1,12,4,2,7,2,4,5,2,2,7,3,6,3,5,2,2,2,3,5,4,4,2,2,3,3,2,5,7,7,6,2,2,1,1,3,2,2,2,13,7,3,3,2,2,3,3,5,1,4,3,8,3,2,7,3,3,4,3,1,2,2,2,6,4,5,3,2,3,5,2,3,2,3,5,4,9,7,4,3,4,5,4,7,6,3,4,3,4,9,1,9,7,2,4,2,2,3,2,9,5,3,3,5,1,1,4,8,3,5,1,5,7,5,5,7,5,2,2,6,2,4,3,8,6,2,6,3,5,3,6,6,3,5,3,5,4,2,4,4,6,3,8,1,3,4,4,3,1,6,6,3,3,8,5,5,5,5,12,1,3,4,2,2,6,5,4,3,4,3,4,11,5,2,5,1,5,3,6,4,5,7,5,5,5,3,7,2,6,4,2,2,3,7],"type":"histogram","name":"Fasteners","visible":false,"inherit":true},"5ef8564c3753.14":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[6,5,5,2,4,2,1,5,2,4,2,2,3,7,5,4,4,2,10,2,1,3,3,5,1,1,7,1,2,4,7,5,4,1,3,2,5,2,1,5,7,2,4,4,5,3,4,6,4,2,5,3,2,5,2,2,1,4,5,5,2,5,2,2,2,2,7,1,3,3,1,3,5,2,9,2,3,3,5,7,3,3,2,3,3,7,1,3,5,2,3,1,8,3,2,2,4,3,5,2,3,6,3,3,3,3,6,2,3,3,3,3,2,5,8,2,3,3,2,7,2,1,2,2,5,2,3,2,3,5,2,2,1,2,2,2,2,2,5,2,2,7,2,4,3,3,2,7,7,7,2,4,2,4,2,2,2,2,5,5,2,3,2,5,2,3,3,2,4,2,2,7,6,3,4,6,5,2,3,5,1,2,2,2,7,2,4,5,2,4],"type":"histogram","name":"Supplies","visible":false,"inherit":true},"5ef8564c3753.15":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[8,9,4,3,7,2,4,1,3,4,1,2,3,8,7,2,2,2,8,4,4,3,3,5,3,10,3,7,3,4,6,3,2,3,5,3,2,11,3,2,2,4,6,3,2,3,3,6,7,3,3,2,5,7,4,2,3,7,2,7,4,4,6,2,2,3,3,6,3,1,3,4,1,6,8,3,4,2,3,2,1,2,2,11,3,5,3,2,4,3,5,6,2,5,5,3,7,4,2,4,5,5,1,2,2,2,4,3,2,3,4,2,1,3,2],"type":"histogram","name":"Machines","visible":false,"inherit":true},"5ef8564c3753.16":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[2,3,3,5,3,3,2,2,1,7,4,2,2,4,4,2,5,6,1,3,2,2,5,2,3,2,1,2,2,6,8,4,1,5,2,7,5,1,1,5,4,4,4,2,5,5,2,5,5,4,5,2,9,2,4,4,2,1,3,2,3,2,5,2,7,3,3,5],"type":"histogram","name":"Copiers","visible":false,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Distribution of Quantity Sold per Order by Sub Category","xaxis":{"domain":[0,1],"automargin":true,"title":"Quantity"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Frequency"},"showlegend":false,"updatemenus":[{"type":"dropdown","buttons":[{"method":"update","args":[{"visible":[true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"xaxis":{"title":"Quantity","autorange":true},"yaxis":{"title":"Frequency","autorange":true}}],"label":"Bookcases"},{"method":"update","args":[{"visible":[false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"xaxis":{"title":"Quantity","autorange":true},"yaxis":{"title":"Frequency","autorange":true}}],"label":"Chairs"},{"method":"update","args":[{"visible":[false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"xaxis":{"title":"Quantity","autorange":true},"yaxis":{"title":"Frequency","autorange":true}}],"label":"Labels"},{"method":"update","args":[{"visible":[false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"xaxis":{"title":"Quantity","autorange":true},"yaxis":{"title":"Frequency","autorange":true}}],"label":"Tables"},{"method":"update","args":[{"visible":[false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false]},{"xaxis":{"title":"Quantity","autorange":true},"yaxis":{"title":"Frequency","autorange":true}}],"label":"Storage"},{"method":"update","args":[{"visible":[false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false]},{"xaxis":{"title":"Quantity","autorange":true},"yaxis":{"title":"Frequency","autorange":true}}],"label":"Furnishings"},{"method":"update","args":[{"visible":[false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false]},{"xaxis":{"title":"Quantity","autorange":true},"yaxis":{"title":"Frequency","autorange":true}}],"label":"Art"},{"method":"update","args":[{"visible":[false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false]},{"xaxis":{"title":"Quantity","autorange":true},"yaxis":{"title":"Frequency","autorange":true}}],"label":"Phones"},{"method":"update","args":[{"visible":[false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false]},{"xaxis":{"title":"Quantity","autorange":true},"yaxis":{"title":"Frequency","autorange":true}}],"label":"Binders"},{"method":"update","args":[{"visible":[false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false]},{"xaxis":{"title":"Quantity","autorange":true},"yaxis":{"title":"Frequency","autorange":true}}],"label":"Appliances"},{"method":"update","args":[{"visible":[false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false]},{"xaxis":{"title":"Quantity","autorange":true},"yaxis":{"title":"Frequency","autorange":true}}],"label":"Paper"},{"method":"update","args":[{"visible":[false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false]},{"xaxis":{"title":"Quantity","autorange":true},"yaxis":{"title":"Frequency","autorange":true}}],"label":"Accessories"},{"method":"update","args":[{"visible":[false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false]},{"xaxis":{"title":"Quantity","autorange":true},"yaxis":{"title":"Frequency","autorange":true}}],"label":"Envelopes"},{"method":"update","args":[{"visible":[false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false]},{"xaxis":{"title":"Quantity","autorange":true},"yaxis":{"title":"Frequency","autorange":true}}],"label":"Fasteners"},{"method":"update","args":[{"visible":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false]},{"xaxis":{"title":"Quantity","autorange":true},"yaxis":{"title":"Frequency","autorange":true}}],"label":"Supplies"},{"method":"update","args":[{"visible":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false]},{"xaxis":{"title":"Quantity","autorange":true},"yaxis":{"title":"Frequency","autorange":true}}],"label":"Machines"},{"method":"update","args":[{"visible":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true]},{"xaxis":{"title":"Quantity","autorange":true},"yaxis":{"title":"Frequency","autorange":true}}],"label":"Copiers"}],"direction":"down","x":0.98999999999999999,"y":0.98999999999999999,"showactive":true,"xanchor":"left","yanchor":"top"}],"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[2,7,3,4,3,5,3,6,4,4,13,2,2,5,2,5,1,1,4,4,2,3,1,4,3,2,7,2,2,3,7,3,2,2,3,4,3,2,1,3,2,2,1,2,1,3,2,2,1,7,7,2,4,3,1,7,1,5,3,3,2,3,5,2,9,2,4,2,4,3,1,2,3,2,2,2,4,9,2,3,6,5,5,3,3,5,5,2,9,1,1,8,3,7,2,4,5,2,3,5,2,9,6,7,4,3,4,3,3,4,7,5,9,3,8,3,3,2,3,3,8,6,5,5,5,7,4,1,5,4,9,6,3,2,6,5,3,4,1,5,2,2,5,10,1,2,5,2,4,2,2,10,3,2,3,3,6,2,12,5,3,2,3,5,2,6,2,5,9,5,8,7,4,1,2,1,2,2,6,2,3,6,3,2,1,2,3,7,2,5,4,2,5,2,5,3,3,2,3,6,2,2,5,4,7,6,3,7,1,3,1,2,4,3,2,10,1,2,3,1,3,8,3,5,5,5,4,4],"type":"histogram","name":"Bookcases","visible":true,"marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[3,2,3,1,5,5,8,2,3,2,8,2,9,7,7,2,8,7,2,3,2,1,4,3,2,4,5,4,3,3,2,3,2,2,3,1,4,2,3,1,2,3,2,3,2,3,2,3,5,5,2,3,5,4,2,6,5,5,3,3,14,2,4,9,3,1,2,3,4,3,3,2,9,6,5,2,2,3,2,4,2,14,5,7,6,3,6,1,5,2,5,2,6,9,1,8,3,3,1,3,2,4,7,2,2,3,5,6,4,5,1,4,3,8,7,3,5,5,4,4,3,3,3,2,4,4,1,7,3,2,8,4,1,3,1,2,5,7,5,2,8,2,2,6,3,2,3,2,1,4,4,1,6,3,2,4,2,2,1,4,8,4,2,3,2,7,5,2,2,3,1,1,7,3,2,3,2,2,7,6,4,5,4,8,2,6,5,2,7,4,8,5,5,3,2,5,5,2,3,5,2,7,2,2,2,10,1,2,6,4,2,1,6,2,5,12,2,5,3,3,5,9,1,5,3,7,5,1,2,3,3,3,1,7,3,6,2,3,2,5,6,4,7,3,5,4,2,3,1,2,5,1,4,7,2,2,2,2,5,2,6,2,3,1,6,1,2,3,9,3,3,4,3,1,3,4,2,3,6,3,3,2,9,3,2,1,4,3,3,5,6,4,3,2,3,3,3,9,1,1,2,6,3,3,4,6,3,3,2,3,3,5,7,7,6,2,3,6,5,2,3,9,6,3,3,4,3,6,10,2,1,5,2,1,2,3,6,3,3,3,2,4,10,7,1,1,2,1,2,1,5,2,5,4,2,9,2,3,2,3,5,3,2,1,3,8,3,1,11,5,7,9,2,6,14,6,4,5,5,1,4,2,9,5,4,2,1,3,2,2,2,5,3,8,5,2,3,3,5,6,6,4,9,4,3,3,8,6,2,4,3,5,2,4,3,4,2,3,2,4,2,3,2,2,2,4,2,3,5,8,7,5,3,4,2,3,3,3,4,5,6,3,2,3,2,9,4,9,2,2,2,3,2,1,3,7,2,3,2,3,2,2,5,9,7,2,5,4,2,5,1,4,3,2,2,3,4,7,8,1,3,3,4,6,7,1,4,5,3,5,1,3,4,2,4,2,4,3,2,6,4,1,5,5,6,4,4,2,5,2,4,3,2,2,2,4,2,5,8,4,3,3,3,5,6,3,4,2,3,4,3,3,4,3,3,2,3,7,5,3,2,3,2,2,4,5,3,3,2,9,3,3,5,7,2,5,1,2,11,3,5,3,3,1,1,1,3,3,1,2,3,6,1,2,2,5,3,2,3,3,1,8,2,5,6,8,2,2,14,7,7,1,5,5,9,6,2,4,3,3,13,4,5,5,3,2,2,4,4,3,4,7,4,3,3,5,6],"type":"histogram","name":"Chairs","visible":false,"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2,6,2,2,4,2,3,8,3,10,2,2,9,7,2,2,1,7,3,4,3,7,2,4,4,2,3,3,2,7,2,2,1,4,7,5,2,2,3,3,2,5,1,2,3,4,3,1,1,4,5,2,2,14,4,3,7,2,7,6,1,4,8,2,7,6,3,8,1,2,1,2,2,3,4,2,2,3,4,6,6,4,2,2,2,4,5,2,9,3,2,2,8,5,1,1,7,2,7,6,4,2,5,4,1,2,2,5,5,1,5,4,7,4,3,8,10,4,4,3,1,8,6,2,4,3,5,3,5,8,1,3,4,7,5,3,3,2,6,5,2,3,9,11,12,2,3,3,3,5,4,3,1,3,9,5,1,2,5,2,7,2,8,5,1,2,2,3,2,2,2,5,3,3,3,4,2,5,8,1,2,3,3,8,3,6,4,4,2,6,2,3,3,4,3,3,6,4,2,1,2,3,5,6,1,3,9,4,3,3,4,7,1,4,6,3,1,2,3,4,9,4,4,7,2,8,2,5,2,2,8,5,1,5,10,4,2,3,2,1,1,3,6,6,8,5,9,2,3,3,2,5,8,5,2,8,3,2,5,3,3,2,7,2,1,2,3,3,4,9,3,13,5,2,5,5,3,4,2,5,5,6,2,4,2,2,2,2,7,4,3,2,6,2,2,7,3,7,1,2,1,3,5,2,1,2,2,4,3,9,1,2,1,6,2,2,3,5,3,5,3,2,1,3,2,2,3,4,7,7,7,3,3,4,2,2,2,5,6,2,3,4,6,2,3,3,2,1,3,9,5,3,3,5,5,3,2,3,2,1,4,3,5,10],"type":"histogram","name":"Labels","visible":false,"marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[5,9,3,3,6,2,5,2,3,5,5,3,3,7,3,7,2,6,3,2,4,5,1,3,3,2,10,4,5,2,4,3,12,7,13,4,8,5,4,7,2,6,12,1,5,5,3,2,3,3,3,2,6,4,2,5,9,4,6,6,7,5,2,7,3,1,5,1,1,3,3,1,7,2,3,3,1,3,1,1,1,2,5,7,4,3,3,2,2,2,3,5,5,9,3,5,3,4,3,3,3,3,2,1,2,3,2,2,2,1,3,3,1,1,3,2,2,6,3,2,7,8,2,6,3,2,6,3,3,2,3,5,2,3,2,1,3,2,1,8,4,9,5,4,3,3,2,2,3,3,7,3,3,4,2,3,1,5,1,3,4,7,5,2,5,9,5,1,2,1,7,1,10,7,7,8,6,9,9,6,5,2,1,3,5,2,2,7,2,8,5,3,3,2,2,2,3,6,4,2,3,2,1,5,8,3,9,5,1,1,2,1,9,3,9,3,1,7,3,6,3,3,2,3,3,7,4,3,1,6,3,2,1,2,4,5,4,1,9,4,9,3,2,4,10,3,2,4,4,2,3,6,3,12,7,4,2,7,7,4,8,1,4,1,4,3,5,5,3,3,4,4,1,4,3,6,7,2,7,2,5,1,2,3,3,2,3,4,2,6,1,2,7,4,1,3,7,4,3,3,5,3,2,1,2,3,7,3,3,4,13,2,2,2,8,1,2,2,1],"type":"histogram","name":"Tables","visible":false,"marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2,6,2,2,2,4,6,1,3,1,3,7,6,7,7,6,3,2,3,3,4,1,6,1,2,6,2,5,3,1,4,6,8,1,2,4,4,7,3,3,2,3,4,3,2,5,3,3,3,2,3,6,5,5,3,3,3,2,3,2,9,9,2,2,1,4,3,2,7,14,5,2,4,3,3,3,3,3,4,2,6,1,3,2,2,12,7,2,2,1,2,3,5,3,3,3,1,5,3,2,7,6,4,3,1,2,3,4,6,2,2,2,3,1,9,3,2,3,1,4,5,2,3,2,3,2,4,2,3,11,5,1,3,6,4,4,4,3,1,3,3,6,1,6,3,2,5,2,2,7,2,3,2,5,3,6,3,5,3,1,5,3,3,2,9,2,9,1,2,8,1,5,5,4,2,4,6,8,2,1,7,2,3,3,4,3,3,4,9,5,5,4,5,3,3,2,6,3,3,4,1,5,2,2,6,5,4,3,2,3,7,5,6,2,3,3,8,3,4,1,2,6,2,3,4,4,2,6,4,2,2,8,8,7,1,2,3,2,2,5,2,5,11,4,2,5,3,6,2,5,5,1,2,1,3,3,3,8,2,5,2,9,4,4,2,3,9,5,5,8,8,7,2,3,6,3,1,2,4,3,5,9,3,3,1,2,3,5,5,2,1,9,4,4,3,2,3,6,2,5,1,2,5,3,4,7,3,3,7,2,1,12,3,5,3,2,5,2,8,2,3,7,5,2,2,7,5,5,2,4,7,1,6,10,5,3,5,4,4,2,2,14,4,4,2,3,4,4,2,6,5,2,5,2,7,6,7,3,1,4,2,9,4,7,3,2,2,2,1,4,3,1,3,8,2,4,1,3,5,5,4,2,3,1,1,8,3,4,6,2,7,3,5,2,5,2,3,1,3,5,2,3,5,1,2,2,3,7,4,4,3,4,2,3,2,5,6,3,3,3,2,4,3,6,2,4,4,5,5,1,3,3,5,3,7,4,6,9,4,5,1,3,2,6,1,5,4,2,5,3,3,3,6,3,2,3,3,3,3,2,3,1,3,5,4,2,5,1,4,1,3,1,1,2,2,5,2,2,5,5,4,3,3,2,1,2,4,2,9,1,2,5,5,3,7,4,6,2,9,4,5,5,7,3,7,1,1,2,3,3,5,4,3,4,5,6,5,2,2,4,5,3,4,4,2,2,9,4,2,3,4,4,3,1,4,3,2,7,2,8,3,3,3,2,7,7,3,2,2,3,5,3,1,2,4,3,5,5,5,2,1,7,3,2,5,3,1,2,6,5,5,3,4,3,1,5,3,4,3,6,2,1,1,4,3,9,3,2,3,2,3,5,2,2,5,4,4,3,5,1,3,1,4,4,2,1,2,3,2,3,7,3,2,4,2,1,4,2,10,3,6,5,8,4,4,9,5,5,7,1,6,2,11,3,6,3,6,5,2,3,2,2,2,2,5,7,1,1,5,2,3,9,2,2,3,1,2,2,3,2,3,2,3,4,1,6,9,3,3,2,3,3,2,2,3,10,3,4,5,1,4,1,4,6,5,9,3,5,10,7,5,7,1,3,3,10,3,2,4,6,1,5,4,3,2,2,5,2,2,3,2,3,4,7,3,3,3,1,5,1,7,7,3,1,1,1,5,1,3,4,2,3,3,3,1,2,7,2,9,2,5,2,4,4,3,5,5,2,3,6,1,3,9,3,4,3,1,3,2,1,5,4,3,2,3,6,3,1,6,1,2,2,6,3,5,8,2,2,4,3,3,1,13,3,6,1,7,3,3,2,6,7,7,4,6,2,2,5,5,6,1,9,2,6,3,2,3,2,2,2,6,5,2,1,4,4,3,7,5,2,4,3,1,2,11,3,6,2,5,2,3,1,4,2,3,5,2,7,2,4,3,1,4,3,9,3],"type":"histogram","name":"Storage","visible":false,"marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[7,3,5,2,4,2,3,5,3,7,3,2,3,3,14,2,4,7,4,3,5,3,3,9,3,8,3,4,2,4,1,3,1,8,1,4,2,1,1,5,7,3,4,9,3,3,3,4,1,3,3,1,8,3,2,2,3,7,5,3,4,5,3,3,1,3,3,2,3,6,5,11,4,2,7,1,2,2,2,4,2,1,3,5,2,6,1,7,6,4,2,6,5,5,7,4,3,2,3,9,2,3,2,9,2,2,3,2,4,2,6,2,4,1,2,3,1,3,2,3,1,1,2,5,3,2,6,3,1,8,6,3,3,2,1,5,3,3,2,4,3,4,2,4,4,3,2,2,2,6,2,5,3,2,13,2,2,2,5,3,7,2,2,3,2,5,4,8,2,2,9,5,1,7,5,2,2,4,1,4,2,2,3,5,3,4,2,5,3,2,3,4,5,7,6,3,3,2,3,7,5,1,3,1,5,8,2,6,3,1,1,5,2,2,7,6,3,5,4,5,2,6,8,7,4,8,7,2,9,2,8,8,3,7,6,8,5,3,3,1,2,4,3,2,2,8,3,6,5,1,2,3,7,4,3,1,2,6,4,3,8,5,5,3,6,2,6,1,4,2,4,11,2,7,1,3,4,1,7,3,2,2,6,2,2,4,1,3,3,3,3,2,5,2,2,3,5,2,5,3,2,2,3,7,5,3,2,3,2,5,5,3,3,3,2,3,7,5,3,1,4,3,3,3,9,7,4,4,2,3,2,3,6,2,2,4,3,4,3,2,4,5,7,4,3,2,2,4,2,1,2,2,3,4,3,2,2,6,3,9,2,1,5,6,4,4,1,2,2,2,1,3,3,3,8,4,3,5,2,3,6,11,11,5,6,5,3,4,4,2,3,5,3,5,2,3,3,9,5,5,3,11,4,2,3,2,4,6,2,3,1,5,2,5,3,5,2,5,1,4,2,1,2,4,6,4,3,1,5,3,4,3,3,8,3,2,3,4,3,2,2,3,1,4,2,3,3,1,9,5,1,3,9,3,3,2,3,3,4,9,3,2,2,5,7,3,4,9,3,6,3,9,8,4,2,4,3,2,2,5,7,1,3,2,4,4,2,1,2,5,2,2,1,2,6,1,4,6,2,3,5,6,2,2,3,2,2,3,5,1,5,2,2,2,2,6,1,2,2,2,11,2,3,4,5,14,2,4,3,6,3,2,2,1,7,3,4,3,5,1,4,4,2,2,4,3,3,5,3,2,4,3,3,4,5,1,2,4,3,6,3,4,3,2,7,4,3,3,2,3,4,1,3,5,3,8,2,3,3,3,9,2,3,3,4,3,8,3,3,8,3,5,2,8,3,3,3,3,4,5,5,4,2,4,3,3,4,3,5,7,2,6,4,3,4,5,2,3,5,3,3,6,2,2,5,4,7,6,2,4,6,3,4,6,5,5,2,4,3,1,2,2,5,3,8,3,3,2,1,4,6,4,2,2,2,1,5,4,3,7,2,1,3,2,3,3,4,2,5,5,6,2,2,5,3,2,4,8,7,7,2,5,8,7,2,3,7,1,2,5,2,2,6,2,3,3,2,14,5,1,3,8,1,3,2,5,1,5,7,4,2,6,3,3,5,3,3,2,6,3,6,3,9,3,2,3,9,4,4,3,4,3,3,3,2,3,3,2,6,2,4,3,5,1,5,1,2,3,6,5,3,5,7,3,2,3,6,2,3,9,1,1,2,6,5,3,5,3,3,2,5,3,9,6,3,1,4,2,3,5,3,2,4,3,2,3,2,4,3,5,1,5,2,3,3,2,5,4,2,2,5,10,5,4,2,5,3,10,7,2,6,1,14,6,1,4,4,2,6,1,3,3,2,2,5,7,1,3,4,5,3,1,4,2,3,3,1,2,3,2,2,10,4,12,9,3,3,2,3,5,2,3,2,5,5,3,2,2,7,6,3,3,3,3,4,7,3,4,5,2,3,4,2,2,2,1,2,3,9,2,3,2,3,1,4,3,4,4,2,8,2,1,3,4,8,2,1,5,3,5,5,2,5,2,3,3,5,3,7,5,2,2,3,5,5,3,4,2,6,3,3,3,4,8,4,2,2,2,2,3,2,1,2,7,7,4,7,5,2,5,4,2,2,5,3,2,3,3,7,5,3,3,3,5,1,3,2],"type":"histogram","name":"Furnishings","visible":false,"marker":{"color":"rgba(140,86,75,1)","line":{"color":"rgba(140,86,75,1)"}},"error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[4,2,7,6,2,1,8,5,3,1,2,4,3,3,3,6,1,5,2,3,2,1,2,3,1,3,6,1,4,4,3,2,4,2,1,1,6,8,4,6,3,6,3,3,5,2,2,1,3,3,3,2,4,3,2,9,9,5,8,1,7,2,7,3,4,2,3,4,2,6,2,2,4,4,4,3,3,2,3,1,3,2,3,7,3,5,2,3,7,7,9,4,3,7,3,1,7,2,3,2,7,1,2,2,1,6,2,2,3,3,3,3,4,3,6,7,3,5,3,2,2,2,6,2,3,7,5,4,8,9,5,6,2,2,3,5,1,3,4,7,4,3,6,3,5,3,3,5,4,3,2,3,3,2,5,4,3,2,5,3,5,1,3,3,5,3,2,3,3,2,2,7,7,3,1,7,5,3,5,4,3,4,3,9,4,1,1,3,2,3,3,4,2,8,8,2,5,5,5,1,2,7,6,2,9,2,6,5,6,3,2,3,9,1,4,2,1,3,3,5,4,3,9,5,3,1,2,10,7,4,1,2,7,3,3,1,2,3,5,4,1,3,1,2,5,5,8,2,6,5,3,3,7,7,1,3,3,6,7,7,2,2,9,3,4,5,3,4,2,3,7,2,9,3,5,4,5,1,4,2,10,2,2,1,4,3,2,1,2,1,5,4,3,6,3,5,8,3,2,7,2,1,1,3,6,3,4,5,3,4,3,2,7,3,5,2,4,2,3,3,3,4,4,6,1,1,2,4,7,3,9,3,1,6,7,3,3,2,2,5,2,7,1,1,2,1,2,1,2,3,3,2,4,3,4,10,2,2,3,3,2,2,3,6,3,3,3,1,7,5,9,4,4,3,4,3,3,5,2,5,3,8,3,5,4,3,2,2,2,2,3,1,3,4,1,4,5,3,2,3,11,1,2,8,7,3,2,3,2,2,7,2,5,2,5,2,3,7,3,3,5,3,5,2,9,5,3,2,1,2,4,2,5,5,3,5,5,2,2,3,2,4,1,3,2,2,3,2,1,2,4,5,2,5,3,2,5,5,6,1,4,1,4,2,9,1,2,3,1,7,3,2,2,2,2,1,3,7,2,5,2,3,3,5,3,9,4,3,4,6,4,4,2,10,6,7,4,6,5,3,4,3,2,7,3,2,6,5,3,5,1,2,7,2,5,5,3,6,10,5,3,5,2,3,6,6,3,7,6,3,2,7,6,5,5,3,6,2,3,3,5,1,2,5,4,2,3,4,3,2,3,3,2,2,7,5,3,3,2,2,2,5,4,2,4,2,2,2,3,4,3,3,8,5,2,2,2,5,3,3,7,2,5,7,7,5,2,8,3,2,1,1,4,3,3,5,3,2,4,2,1,4,2,5,5,9,1,3,4,7,3,2,3,7,2,3,1,3,4,5,5,3,2,3,3,4,3,9,3,2,1,3,5,3,2,3,3,3,3,3,5,6,9,8,1,3,2,3,9,3,4,4,5,6,5,4,8,2,7,5,1,3,2,2,2,1,2,5,3,9,7,1,8,2,2,2,7,5,7,2,3,3,3,12,2,3,2,2,5,5,6,2,3,2,8,4,4,5,4,2,2,2,2,5,4,2,4,3,3,5,5,5,7,4,9,2,8,5,5,3,2,2,3,2,2,6,2,7,1,5,8,3,4,7,3,2,3,1,7,3,3,3,5,2,2,6,4,1,2,1,6,5,3,2,3,4,6,7,3,9,1,2,3,9,14,2,5,5,4,2,3,5,9,4,7,3,6,4,3,4,8,2,3,2,2,4,3,2,2,2,2,3,7,2,5,7],"type":"histogram","name":"Art","visible":false,"marker":{"color":"rgba(227,119,194,1)","line":{"color":"rgba(227,119,194,1)"}},"error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[6,4,3,7,4,4,2,5,4,2,1,7,5,11,3,2,7,3,4,5,6,4,2,3,3,2,6,4,7,2,6,3,2,12,3,2,4,4,6,5,6,1,3,5,8,1,3,3,3,2,4,2,5,3,4,2,3,9,10,1,4,3,3,1,2,1,1,3,3,5,2,4,2,1,3,7,2,3,8,3,7,4,1,1,3,7,2,3,2,5,2,3,5,12,3,3,2,2,5,7,1,1,3,7,5,8,5,7,8,4,4,3,3,2,3,5,3,7,2,1,3,5,4,2,5,3,3,2,7,5,8,9,2,3,4,7,2,1,3,3,2,5,4,5,2,2,5,4,1,3,5,3,4,3,2,2,2,5,6,3,3,2,3,7,7,3,2,8,1,4,3,3,3,2,2,9,3,3,1,3,3,5,4,1,5,3,7,2,4,7,4,2,5,3,9,7,4,7,4,2,1,4,3,3,3,2,3,1,1,4,4,7,10,3,4,5,2,6,1,4,4,7,5,3,1,4,1,5,7,2,13,2,3,2,3,4,8,1,1,3,11,1,3,3,2,3,5,7,2,3,2,3,5,2,2,4,14,4,5,3,3,3,3,3,4,1,3,2,2,1,4,5,2,3,8,3,3,7,5,2,2,4,1,3,2,2,7,1,3,4,8,9,2,2,3,7,5,2,2,1,2,1,1,3,6,2,3,2,3,3,4,3,2,2,4,5,2,4,2,1,2,4,5,1,2,2,3,6,3,4,8,6,1,3,1,1,8,7,3,3,5,1,7,2,1,5,3,2,3,5,1,5,3,5,2,5,1,2,3,3,5,2,3,3,2,2,5,2,5,3,4,2,3,7,9,6,3,2,3,5,2,3,3,5,3,3,7,2,9,3,13,5,7,3,3,6,4,3,2,3,5,2,3,2,5,2,7,3,2,2,2,7,4,3,7,2,1,2,4,1,9,9,2,2,3,4,3,8,2,5,1,2,4,5,6,3,2,2,2,2,2,3,2,1,4,3,6,4,1,6,6,4,3,2,2,3,2,2,7,4,1,3,3,3,2,2,2,2,8,5,3,5,3,3,8,2,2,5,2,1,3,3,14,3,5,5,2,2,3,6,1,3,4,2,3,3,5,4,4,1,1,2,3,2,3,3,3,6,7,1,1,3,3,7,2,5,3,4,2,3,4,4,4,4,3,4,2,3,3,1,4,9,3,10,7,3,3,8,5,3,2,3,4,3,2,2,3,5,3,4,2,3,8,3,6,2,3,4,5,3,2,1,2,3,3,5,1,5,5,4,3,2,2,6,1,2,4,5,3,1,4,3,5,3,3,1,5,2,5,4,6,7,2,1,1,3,6,7,4,5,4,5,14,4,4,7,3,2,3,7,5,2,6,3,3,5,1,3,5,2,2,8,2,2,2,7,1,2,5,5,3,2,2,1,5,3,9,6,9,1,2,4,2,5,3,2,3,3,2,1,3,3,1,5,5,2,1,5,1,4,8,6,3,2,5,3,1,3,6,2,2,2,4,6,3,1,2,9,2,6,6,7,6,1,7,3,5,5,7,1,4,3,5,5,2,3,3,4,2,4,4,1,2,2,4,3,2,2,12,5,5,1,3,4,1,1,4,3,3,5,4,2,7,1,3,4,3,6,4,4,2,5,2,8,2,8,2,4,2,2,7,3,10,2,2,4,2,3,2,2,3,5,2,3,2,2,1,1,2,3,3,3,3,4,7,5,6,2,2,3,8,8,4,6,2,2,3,3,5,7,5,4,5,2,5,2,2,1,2,1,2,2,3,3,3,7,9,3,4,3,2,5,2,2,2,3,2,2,6,3,2,2,7,5,2,5,5,4,9,3,2,3,2,5,4,7,4,4,2,3,2,3,3,1,7,1,5,9,2,6,3,5,4,2,4,2,1,6,2,2,7,3,3,3,4,3,3,2,6,3,9,3,5,5,9,4,3,5,5,2,5,5,1,3,2,4,3,1,8,4,3,5,2,3,5,2,2,5,2],"type":"histogram","name":"Phones","visible":false,"marker":{"color":"rgba(127,127,127,1)","line":{"color":"rgba(127,127,127,1)"}},"error_y":{"color":"rgba(127,127,127,1)"},"error_x":{"color":"rgba(127,127,127,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[3,3,3,4,2,2,6,2,6,4,6,1,3,3,2,1,3,3,3,6,1,4,2,3,5,2,2,2,4,4,7,2,5,3,5,7,5,1,3,6,6,2,3,1,4,2,10,1,4,4,5,4,3,4,3,3,8,2,2,3,5,3,8,2,2,3,5,5,9,5,7,4,6,3,7,7,7,7,3,3,4,2,2,9,5,5,3,4,2,2,3,3,3,2,3,8,5,3,6,4,5,2,3,1,3,3,2,5,1,5,2,4,8,7,3,3,4,4,4,6,5,7,4,3,3,7,3,3,2,4,3,3,2,6,2,5,2,2,2,3,2,2,2,2,7,3,2,2,3,3,3,4,4,2,5,4,2,5,7,1,7,3,3,5,2,2,2,2,7,3,2,3,5,4,5,4,6,7,4,3,3,2,2,1,1,5,3,3,4,3,8,1,7,4,4,2,2,3,6,3,6,3,8,5,6,10,6,14,4,1,4,7,2,9,2,5,6,5,2,3,1,3,5,3,9,2,2,3,5,3,3,5,4,2,3,7,7,3,2,5,9,4,2,1,3,2,6,2,6,2,3,2,3,3,2,2,5,3,2,3,2,2,4,8,6,6,4,5,7,2,3,8,6,1,10,2,4,9,8,2,2,4,2,6,5,2,4,9,8,3,3,4,2,3,4,3,2,3,5,2,4,3,4,2,7,2,6,3,4,2,3,1,2,3,8,1,3,5,3,3,4,9,4,2,3,7,3,3,5,7,2,3,2,7,10,1,13,4,2,1,7,5,5,2,1,3,4,5,7,3,4,5,12,3,2,6,2,5,5,4,4,4,2,5,3,1,4,4,5,3,3,5,2,5,1,4,4,5,4,3,6,4,2,5,5,8,3,1,6,13,10,5,3,3,3,3,2,2,2,7,2,5,4,9,2,5,3,2,2,1,3,5,3,5,3,7,5,5,5,2,2,5,3,3,6,6,5,2,3,3,2,3,4,2,2,7,3,14,1,4,5,8,5,4,4,7,4,4,2,5,4,3,3,5,2,6,5,11,2,7,7,2,2,1,4,7,3,7,5,2,3,5,2,2,5,6,2,2,3,4,7,3,3,7,3,3,1,1,3,13,3,2,2,7,5,8,7,1,3,3,6,5,3,5,1,9,5,5,4,2,1,2,2,4,6,6,6,1,1,8,2,2,2,4,4,3,6,2,1,2,4,2,2,5,4,5,3,4,2,8,1,2,4,5,2,3,1,1,3,3,5,2,2,7,7,2,5,2,4,4,6,3,9,6,2,7,3,2,5,4,2,3,2,3,3,2,6,3,2,3,3,6,9,2,2,4,8,3,3,3,7,5,4,5,4,4,4,5,1,2,3,6,7,8,5,7,8,3,3,3,3,9,4,2,1,3,3,3,3,3,5,2,2,2,5,2,8,2,5,5,6,9,3,4,3,6,3,2,2,9,5,7,1,4,2,3,6,2,9,1,4,3,6,4,2,3,3,3,1,5,3,5,3,2,3,3,2,2,5,6,2,8,7,5,5,3,3,1,1,8,4,6,1,4,2,4,1,12,2,5,3,4,5,2,6,7,2,3,7,2,3,1,6,6,2,1,3,6,2,4,3,4,2,9,10,4,2,2,5,4,5,1,2,7,2,2,2,3,2,2,7,2,2,3,3,3,3,2,8,2,6,4,3,3,5,4,2,3,2,3,3,2,1,3,11,1,3,5,8,6,4,8,5,2,3,2,2,7,2,7,2,4,5,2,2,3,5,4,4,1,3,3,2,8,7,3,7,9,2,2,3,2,3,2,3,3,9,4,2,1,1,4,2,2,3,3,7,3,7,5,6,2,7,2,3,1,2,2,2,4,8,6,3,4,2,5,4,3,2,3,8,5,9,3,7,3,4,1,1,3,7,2,3,4,5,2,13,2,6,10,3,1,4,4,6,3,3,3,2,6,2,1,4,4,2,1,7,2,6,2,7,5,5,5,4,7,14,1,3,9,1,3,3,3,1,1,3,7,3,2,3,4,4,5,3,3,2,1,6,7,3,7,3,2,1,9,2,3,5,6,2,2,2,1,7,2,1,4,6,9,5,7,1,3,6,6,2,3,3,6,1,4,2,5,3,5,2,6,5,9,5,4,1,2,1,1,4,3,7,3,5,5,3,6,1,3,3,3,5,5,5,2,2,1,1,5,5,5,4,1,2,1,3,5,1,7,2,3,3,9,6,3,3,1,4,5,5,3,3,5,1,3,4,3,2,5,1,3,3,5,11,6,6,7,7,2,2,2,4,11,3,3,3,4,8,4,3,4,1,2,7,3,2,1,2,5,3,1,1,2,4,3,5,2,7,3,7,2,5,3,3,6,2,3,6,2,2,4,7,3,4,5,5,2,4,5,4,5,4,2,2,5,4,3,3,3,5,3,9,2,3,2,4,7,5,5,6,2,5,3,2,2,1,2,1,5,4,1,5,5,3,2,3,5,4,4,12,3,2,2,3,6,2,2,6,3,3,2,3,2,3,5,2,2,7,1,7,6,5,8,3,2,3,3,1,5,3,2,5,3,6,5,5,5,1,4,2,4,5,2,4,2,4,2,6,3,3,8,5,1,3,3,3,7,4,9,5,1,4,4,2,4,5,7,1,3,9,1,4,3,2,2,4,2,2,2,2,3,3,1,3,5,5,2,7,3,3,3,2,4,3,5,2,6,10,2,3,3,4,3,8,9,5,3,2,2,8,2,3,1,5,4,3,6,5,1,2,6,9,3,5,1,5,2,2,5,14,1,8,7,2,11,3,2,7,3,6,1,7,5,6,4,1,2,3,2,2,6,1,4,7,3,2,3,4,7,2,2,4,7,4,9,4,5,5,1,6,3,5,5,4,5,8,2,11,4,1,3,3,3,5,2,4,5,8,1,6,9,2,2,3,4,5,2,3,7,13,2,7,2,4,3,1,3,3,6,2,6,3,5,6,7,3,1,4,8,5,1,2,5,3,2,3,3,2,3,1,2,5,2,4,9,3,3,2,10,2,2,3,2,3,5,4,5,2,5,4,3,8,2,4,6,4,3,2,7,5,2,2,2,1,2,4,5,3,4,2,1,3,13,2,2,4,13,2,4,4,3,3,1,2,6,10,3,9,7,2,2,3,4,3,5,3,3,3,2,7,1,3,3,6,2,4,3,6,1,3,6,1,8,2,2,3,3,7,6,3,7,3,3,1,6,2,1,8,3,1,6,7,5,4,5,6,2,1,2,2,2,6,5,6,1,3,3,5,8,9,2,5,3,5,6,2,2,5,2,3,5,6,5,9,2,2,3,2,3,2,2,1,7,9,5,3,3,2,2,13,2,1,6,5,1,2,2,5,8,4,5,2,3,3,3,2,8,2,5,2,4,3,3,2,5,3,2,3,5,3,3,7,7,3,3,8,2,3,2,2,3,5,2,2,4,14],"type":"histogram","name":"Binders","visible":false,"marker":{"color":"rgba(188,189,34,1)","line":{"color":"rgba(188,189,34,1)"}},"error_y":{"color":"rgba(188,189,34,1)"},"error_x":{"color":"rgba(188,189,34,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[5,5,7,1,6,3,5,5,2,4,1,2,5,2,2,8,3,3,4,2,3,5,3,2,5,2,3,2,2,2,3,3,2,5,6,9,4,3,2,5,2,2,4,9,3,2,2,2,2,3,4,13,3,13,2,5,2,2,3,2,3,6,3,5,2,2,14,5,3,2,4,2,2,6,7,1,2,4,1,3,2,6,5,2,2,7,4,3,3,3,6,2,2,1,6,3,2,7,2,5,2,4,6,7,9,3,2,4,3,4,2,4,4,4,3,3,2,3,2,4,1,5,5,1,8,2,7,2,3,1,7,4,1,3,3,2,1,5,5,4,4,2,2,5,3,5,11,2,3,3,4,7,3,3,2,5,2,7,5,2,6,4,8,3,7,4,9,3,3,2,1,4,2,7,3,5,3,3,6,2,1,1,3,4,4,4,1,2,1,6,2,5,6,3,4,3,3,2,3,2,2,2,3,2,5,3,2,7,4,2,3,7,2,2,8,6,5,1,1,2,1,2,1,4,3,4,2,7,4,2,7,3,8,3,1,5,2,4,12,6,2,5,5,3,3,2,4,3,3,2,5,5,3,3,4,3,4,2,2,1,3,2,3,6,3,2,5,2,2,4,5,2,8,2,5,2,2,6,2,2,1,6,4,1,3,2,7,4,2,5,1,4,2,2,5,6,3,2,3,2,4,5,4,5,2,7,4,5,2,3,4,3,1,3,2,3,9,3,3,7,8,4,7,2,3,4,5,3,2,6,4,3,8,2,5,3,8,1,5,6,2,3,1,3,6,3,1,2,1,4,2,2,4,3,1,7,2,9,4,4,4,4,10,3,3,5,7,6,2,5,3,9,4,6,6,3,2,5,5,3,6,2,3,2,6,1,2,3,1,3,4,5,2,4,2,3,2,7,8,2,4,2,3,4,6,3,2,4,3,1,7,4,1,5,5,3,5,4,3,2,7,3,5,5,2,2,3,5,1,7,5,5,2,4,4,3,1,2,6,5,3,1,4,3,3,1,4,1,6,2,8,2,4,4,7,3,2,2,2,3,5,3,3,8,7,2],"type":"histogram","name":"Appliances","visible":false,"marker":{"color":"rgba(23,190,207,1)","line":{"color":"rgba(23,190,207,1)"}},"error_y":{"color":"rgba(23,190,207,1)"},"error_x":{"color":"rgba(23,190,207,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[3,3,5,2,3,2,3,1,2,7,4,3,2,3,1,3,7,4,1,3,2,3,8,3,3,6,2,5,6,4,1,2,2,4,5,6,5,3,3,2,2,4,5,5,5,4,7,2,2,5,1,1,7,1,7,8,4,1,7,5,1,2,2,5,8,3,14,4,4,2,3,2,3,1,10,2,3,8,5,3,5,2,1,3,8,1,1,4,9,3,4,1,4,7,2,2,8,1,8,4,2,6,2,1,3,2,5,6,1,8,3,2,3,3,3,8,3,2,2,5,3,6,3,2,4,3,5,3,3,5,5,3,3,5,3,2,3,4,1,1,5,3,2,5,2,1,3,2,1,3,2,4,4,4,3,4,2,2,3,3,5,5,7,6,4,1,8,7,3,3,4,8,9,3,7,2,1,5,4,5,6,4,2,7,2,4,7,1,1,3,9,5,8,2,3,4,4,2,3,3,1,3,3,4,4,1,2,2,3,3,2,2,2,2,3,3,1,2,5,2,2,6,8,2,4,3,2,2,2,11,9,2,4,1,3,7,3,1,6,7,2,6,5,2,6,1,2,7,2,1,1,7,3,2,1,5,2,4,5,3,4,3,4,2,6,3,3,2,3,3,3,1,13,5,5,7,6,3,4,3,1,7,1,4,3,3,6,3,3,2,2,9,8,4,3,1,3,2,3,3,2,1,2,2,1,7,3,2,4,3,3,2,5,5,1,4,4,5,2,7,4,4,9,5,2,1,7,5,2,2,4,3,1,5,3,4,6,2,2,2,2,5,8,4,2,3,2,3,3,3,4,3,4,6,2,3,1,3,2,3,5,3,2,4,3,3,4,4,7,2,5,2,1,2,3,6,2,9,8,6,2,3,7,4,7,4,3,2,5,5,2,5,7,5,7,2,7,5,5,3,6,4,4,2,4,3,3,4,5,2,1,2,8,7,6,2,3,2,6,3,1,8,6,4,5,3,9,3,13,2,6,4,8,5,2,4,7,2,1,2,5,5,8,3,9,9,4,3,2,3,3,2,6,4,6,2,9,2,8,4,6,9,14,2,2,1,9,3,2,7,2,2,3,2,3,9,7,7,8,3,7,4,2,1,3,1,5,1,3,2,5,2,2,3,1,1,3,2,2,3,6,5,5,2,1,9,3,7,5,2,2,3,3,3,1,2,2,3,7,2,3,2,3,2,3,2,6,5,1,3,5,3,1,2,2,10,9,2,1,4,2,5,5,2,4,5,4,3,4,3,9,3,5,8,3,3,6,3,3,3,3,3,6,3,2,3,5,3,1,5,6,7,2,2,3,2,2,1,3,6,3,2,3,3,2,3,2,5,3,5,9,3,3,1,2,2,2,6,7,2,3,3,3,2,4,5,6,1,5,3,2,3,2,5,3,3,3,7,6,2,2,5,5,5,2,3,4,11,1,4,7,5,4,3,9,5,4,2,2,5,2,2,7,7,2,6,3,5,3,4,5,3,3,4,6,2,10,4,3,3,2,6,7,5,2,1,2,7,2,6,3,3,2,2,3,2,2,2,2,3,5,4,2,3,5,2,4,5,4,3,4,2,1,3,6,4,3,3,2,9,5,3,3,3,3,7,7,5,5,3,3,2,4,2,6,5,3,2,3,4,3,4,2,6,2,4,2,3,3,1,7,5,9,4,2,3,3,2,3,5,2,7,4,4,7,5,1,2,6,4,3,3,3,2,2,2,4,3,5,12,2,3,3,2,7,1,3,3,3,9,5,9,3,5,1,2,2,2,2,1,3,5,5,6,3,2,4,2,2,4,3,4,1,4,2,2,3,4,3,4,5,5,2,2,3,3,4,9,2,1,5,3,4,5,2,3,4,4,4,2,1,4,2,2,6,6,4,4,3,5,3,1,2,7,7,3,8,5,3,3,1,9,2,4,2,5,6,5,3,3,2,2,4,5,5,7,2,7,3,11,1,9,2,9,4,3,1,3,1,3,2,6,2,5,4,4,1,8,2,2,2,3,2,1,3,2,5,2,2,3,4,14,5,3,4,5,3,7,7,6,1,3,2,1,2,1,1,2,3,7,4,5,2,4,5,4,3,3,1,2,4,5,4,4,6,3,2,5,6,4,4,7,2,3,4,2,2,3,2,2,9,1,1,5,5,3,7,4,5,4,7,1,2,3,3,2,9,9,5,3,4,2,1,3,3,6,9,5,2,2,3,1,6,9,1,2,1,3,5,9,6,2,2,3,7,3,3,5,7,3,2,1,3,3,4,2,3,4,5,3,4,2,3,6,7,2,2,3,3,5,3,3,3,3,5,5,9,7,5,2,4,2,1,2,5,2,8,3,1,5,2,3,2,6,2,4,6,3,4,4,3,5,6,2,4,3,2,2,6,4,6,3,5,4,3,2,5,2,3,5,2,4,3,2,4,7,3,2,2,5,8,5,2,1,6,11,5,2,2,4,4,3,2,2,2,6,2,5,3,8,2,5,2,4,8,4,2,3,2,3,6,2,5,3,3,5,2,3,4,2,1,5,2,3,4,4,3,2,3,4,3,9,3,6,2,3,1,6,2,10,1,1,4,9,3,9,6,5,3,5,3,1,3,4,5,1,2,3,3,2,2,7,2,4,10,3,2,3,4,8,2,1,2,2,2,3,8,2,2,4,7,4,2,5,4,6,3,2,2,1,3,2,3,1,6,7,4,2,3,5,3,7,6,3,3,4,8,3,8,3,2,2,4,6,6,4,2,5,7,2,5,2,4,6,11,3,4,4,2,9,8,2,3,3,3,2,7,2,5,2,7,3,1,3,4,2,13,4,3,5,3,5,2,7,4,5,1,3,6,13,1,14,2,1,3,2,2,2,8,3,5,4,9,7,5,2,3,4,1,3,3,2,8,3,3,3,2,2,2,3,4,4,1,2,3,2,3,7,2,2,6,3,2,2,7,9,1,3,10,2,6,3,2,5,2,2,2,2,7,2,1,3,2,2,8,5,6,4,2,7,2,2,2,6,2,5,6,3,1,2,1,4,1,6,4,5,5,1,5,4,5,7,10,3,1,5,2,2,6,1,1,3,2,2,2,1,2,2,5,7,1,1,5,4,2,2,1,2,7,4],"type":"histogram","name":"Paper","visible":false,"marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[3,2,3,2,2,1,3,6,8,5,2,7,2,8,2,2,3,13,3,2,7,5,2,4,1,1,8,10,2,3,2,2,5,6,7,5,5,4,9,3,2,2,2,2,1,2,6,2,3,5,3,4,4,8,3,3,3,1,1,4,3,3,2,4,6,2,2,3,2,7,3,4,3,7,6,1,3,5,7,9,3,5,1,7,1,2,1,2,1,2,5,9,3,9,3,3,1,8,1,3,4,1,6,3,4,2,3,3,3,2,3,4,3,3,4,3,1,4,3,2,3,2,2,4,3,2,2,2,4,4,4,2,5,7,2,6,3,6,5,2,7,3,5,2,3,5,2,8,4,2,3,5,6,4,7,3,5,7,2,5,1,9,4,3,7,2,3,7,3,3,5,2,5,7,3,1,2,4,7,4,5,3,7,3,1,4,9,2,2,9,5,1,7,5,3,8,5,6,6,4,2,4,4,2,1,4,7,3,4,1,3,5,6,2,4,2,1,4,3,3,1,7,3,3,4,3,4,3,4,1,4,7,6,4,3,3,5,2,5,2,5,6,2,3,2,3,1,5,3,1,1,3,2,3,8,2,5,1,2,3,3,2,5,7,3,2,1,2,2,5,9,4,5,3,3,3,8,3,3,4,2,4,6,9,2,2,1,7,6,1,10,10,4,7,1,5,2,3,3,7,2,1,3,5,7,2,6,9,2,8,7,5,2,2,2,5,6,9,4,6,10,3,1,4,4,1,2,7,4,6,3,4,5,3,1,6,3,2,4,2,5,3,1,2,3,3,3,4,6,7,3,3,2,12,3,3,3,3,2,4,5,4,6,5,9,6,2,9,4,1,3,3,2,3,3,2,5,2,5,3,4,1,3,4,2,2,4,6,7,2,3,5,4,4,5,1,6,2,5,1,1,6,3,2,2,1,3,2,5,3,1,5,5,2,4,2,2,4,4,6,3,3,7,3,3,2,3,2,9,5,4,2,3,3,3,3,4,5,1,5,3,4,9,3,3,3,6,1,4,5,3,3,1,2,10,3,2,12,5,3,2,2,2,6,2,2,2,2,3,5,5,3,3,12,2,2,3,3,2,7,3,3,3,1,2,8,6,7,3,7,7,1,2,2,2,14,1,5,4,3,8,3,1,2,1,5,3,4,3,3,5,6,9,3,2,2,2,3,11,3,3,4,7,4,3,4,2,2,2,2,4,4,3,6,9,4,4,3,5,2,4,3,5,2,3,10,3,7,4,1,4,2,2,7,4,2,2,5,9,9,3,5,2,3,4,2,10,2,5,3,2,3,4,8,3,3,3,4,3,1,2,5,3,2,3,2,4,2,2,6,8,2,2,3,2,3,3,2,2,5,6,8,1,6,2,4,3,3,5,3,2,2,2,5,5,3,5,4,3,3,5,8,7,2,5,4,5,6,3,5,3,2,3,6,2,4,2,3,3,5,11,2,3,2,3,8,7,2,5,3,2,3,2,5,3,5,5,5,2,4,2,5,3,7,5,5,3,7,5,3,4,4,3,3,3,2,3,6,3,7,3,3,2,3,14,2,3,1,1,5,2,1,6,2,2,3,4,4,3,5,5,2,2,5,3,3,2,2,7,2,2,2,9,3,4,4,4,3,5,2,2,4,1,2,3,9,3,2,4,3,2,6,5,2,4,5,3,4,7,5,2,3,7,2,2,1,5,2,5,3,3,2,3,9,1,2,4,7,4,4,13,3,2,1,7,11,2,4,14,3,3,1,1,1,1],"type":"histogram","name":"Accessories","visible":false,"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2,9,7,2,6,9,3,5,7,4,3,2,1,2,3,2,6,2,7,4,2,2,3,3,2,2,3,2,4,1,3,2,3,2,3,6,5,8,1,2,2,9,2,3,5,4,1,3,7,3,1,2,3,5,6,3,3,5,2,6,2,2,3,9,3,2,2,2,5,3,2,3,5,2,2,5,1,5,4,2,2,5,2,2,5,3,3,4,6,3,3,1,3,3,3,3,1,5,6,4,4,4,3,3,3,3,4,2,7,2,2,1,2,2,5,5,3,2,2,2,2,2,3,7,9,2,1,3,3,2,2,3,1,8,2,3,1,6,7,3,2,3,1,2,9,2,4,6,1,7,1,5,3,3,4,5,3,5,2,7,3,7,4,1,4,4,3,3,2,3,2,1,8,3,3,5,2,2,4,5,5,3,5,7,9,3,1,2,2,5,3,5,3,8,7,4,3,1,2,7,6,3,5,7,3,2,4,9,3,3,3,3,4,5,1,2,5,6,3,1,3,9,2,7,3,3,2,8,2,3,5,3,2,5,3,1,2,7,2,2,1,4,2,3,6,2,4,6,2,2,1,1,7,2],"type":"histogram","name":"Envelopes","visible":false,"marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[7,14,9,2,9,2,6,7,3,2,4,13,5,3,2,4,5,3,7,2,3,3,7,1,12,4,2,7,2,4,5,2,2,7,3,6,3,5,2,2,2,3,5,4,4,2,2,3,3,2,5,7,7,6,2,2,1,1,3,2,2,2,13,7,3,3,2,2,3,3,5,1,4,3,8,3,2,7,3,3,4,3,1,2,2,2,6,4,5,3,2,3,5,2,3,2,3,5,4,9,7,4,3,4,5,4,7,6,3,4,3,4,9,1,9,7,2,4,2,2,3,2,9,5,3,3,5,1,1,4,8,3,5,1,5,7,5,5,7,5,2,2,6,2,4,3,8,6,2,6,3,5,3,6,6,3,5,3,5,4,2,4,4,6,3,8,1,3,4,4,3,1,6,6,3,3,8,5,5,5,5,12,1,3,4,2,2,6,5,4,3,4,3,4,11,5,2,5,1,5,3,6,4,5,7,5,5,5,3,7,2,6,4,2,2,3,7],"type":"histogram","name":"Fasteners","visible":false,"marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[6,5,5,2,4,2,1,5,2,4,2,2,3,7,5,4,4,2,10,2,1,3,3,5,1,1,7,1,2,4,7,5,4,1,3,2,5,2,1,5,7,2,4,4,5,3,4,6,4,2,5,3,2,5,2,2,1,4,5,5,2,5,2,2,2,2,7,1,3,3,1,3,5,2,9,2,3,3,5,7,3,3,2,3,3,7,1,3,5,2,3,1,8,3,2,2,4,3,5,2,3,6,3,3,3,3,6,2,3,3,3,3,2,5,8,2,3,3,2,7,2,1,2,2,5,2,3,2,3,5,2,2,1,2,2,2,2,2,5,2,2,7,2,4,3,3,2,7,7,7,2,4,2,4,2,2,2,2,5,5,2,3,2,5,2,3,3,2,4,2,2,7,6,3,4,6,5,2,3,5,1,2,2,2,7,2,4,5,2,4],"type":"histogram","name":"Supplies","visible":false,"marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[8,9,4,3,7,2,4,1,3,4,1,2,3,8,7,2,2,2,8,4,4,3,3,5,3,10,3,7,3,4,6,3,2,3,5,3,2,11,3,2,2,4,6,3,2,3,3,6,7,3,3,2,5,7,4,2,3,7,2,7,4,4,6,2,2,3,3,6,3,1,3,4,1,6,8,3,4,2,3,2,1,2,2,11,3,5,3,2,4,3,5,6,2,5,5,3,7,4,2,4,5,5,1,2,2,2,4,3,2,3,4,2,1,3,2],"type":"histogram","name":"Machines","visible":false,"marker":{"color":"rgba(140,86,75,1)","line":{"color":"rgba(140,86,75,1)"}},"error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2,3,3,5,3,3,2,2,1,7,4,2,2,4,4,2,5,6,1,3,2,2,5,2,3,2,1,2,2,6,8,4,1,5,2,7,5,1,1,5,4,4,4,2,5,5,2,5,5,4,5,2,9,2,4,4,2,1,3,2,3,2,5,2,7,3,3,5],"type":"histogram","name":"Copiers","visible":false,"marker":{"color":"rgba(227,119,194,1)","line":{"color":"rgba(227,119,194,1)"}},"error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div></div>
<div id="8760705a-c181-45b5-b3cc-641027edec75" class="cell markdown">
<p>The histograms show that the quantities a right-skewed distributed. This is to be expected since most orders contain only a small number of items. We will not remove the outliers with large quantities since they appear valid..</p>
<section id="data-visualization" class="level2">
<h2 class="anchored" data-anchor-id="data-visualization">3 Data Visualization</h2>
</section>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [20]:</pre></div><div id="8c1ef4fa-d5ff-480c-882b-d9395b11dfa6" class="cell raw">
<hr>
</div></div>
<div id="198704ff-484d-4753-863b-973e27cc49ef" class="cell markdown">
<section id="forecasting-method-evaluation" class="level2">
<h2 class="anchored" data-anchor-id="forecasting-method-evaluation">4 Forecasting Method Evaluation</h2>
<section id="forecasting-top-3-product-categories-4a" class="level3">
<h3 class="anchored" data-anchor-id="forecasting-top-3-product-categories-4a">Forecasting top 3 product categories (4a)</h3>
<p>Let’s forecast sold quantities for the three most sold sub-categories:</p>
<p>The steps taken for data preparation were:</p>
<ul>
<li>Identifying Top Subcategories: The top three subcategories are selected from our dataset based on their sold quantities. The top three were: Binders, furnishing and paper.</li>
<li>The sold quantities are aggregated monthly to create a time series object which we can use in the forecasting.</li>
<li>A KPSS showed that the data is non stationary. First-order differencing is applied to transform the data from non-stationary to stationary. The KPSS results in a p-value &gt;0.05 showing the stationarity.</li>
</ul>
</section>
</section>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [22]:</pre></div><div id="194370af-df92-4cef-9254-ff3ef5545d0f" class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find top 3 most sold product names</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>top_categories <span class="op">&lt;-</span> data <span class="op">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  group_by(Sub_Category) <span class="op">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  summarise(Total_Quantity <span class="op">=</span> <span class="bu">sum</span>(Quantity)) <span class="op">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  arrange(desc(Total_Quantity))</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>top_3_subcategories <span class="op">&lt;-</span> top_categories$Sub_Category[<span class="dv">0</span>:<span class="dv">3</span>]</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data for  top 3 products</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>top_3_data <span class="op">&lt;-</span> data <span class="op">%&gt;%</span> <span class="bu">filter</span>(Sub_Category <span class="op">%</span><span class="kw">in</span><span class="op">%</span> top_3_subcategories)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate sales per month</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>top_3_data <span class="op">&lt;-</span> top_3_data <span class="op">%&gt;%</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  mutate(Month <span class="op">=</span> floor_date(Order_Date, unit <span class="op">=</span> <span class="st">"month"</span>))</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate data by month for each product</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>top_3_data_aggregated <span class="op">&lt;-</span> top_3_data <span class="op">%&gt;%</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  group_by(Month, Sub_Category) <span class="op">%&gt;%</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  summarise(Sales_Count <span class="op">=</span> n(), .groups <span class="op">=</span> <span class="st">'drop'</span>)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a time series object for each product</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>ts_data <span class="op">&lt;-</span> top_3_data_aggregated <span class="op">%&gt;%</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  pivot_wider(names_from <span class="op">=</span> Sub_Category, values_from <span class="op">=</span> Sales_Count, values_fill <span class="op">=</span> <span class="dv">0</span>) <span class="op">%&gt;%</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  select(<span class="op">-</span>Month) <span class="op">%&gt;%</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>  <span class="im">as</span>.matrix()</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a time series object</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>ts_data <span class="op">&lt;-</span> ts(ts_data, start <span class="op">=</span> c(<span class="dv">2014</span>, <span class="dv">1</span>), end <span class="op">=</span> c(<span class="dv">2017</span>, <span class="dv">12</span>), frequency <span class="op">=</span> <span class="dv">12</span>)</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a time series list for each subcategory</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>ts_list <span class="op">&lt;-</span> <span class="bu">list</span>()</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (subcategory <span class="kw">in</span> top_3_subcategories) {</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter data for the subcategory</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>  subcategory_data <span class="op">&lt;-</span> top_3_data_aggregated <span class="op">%&gt;%</span> <span class="bu">filter</span>(Sub_Category <span class="op">==</span> subcategory)</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a time series object (assuming monthly data from January 2014 to December 2017)</span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>  ts_list[[subcategory]] <span class="op">&lt;-</span> ts(subcategory_data$Sales_Count,</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>                                start <span class="op">=</span> c(<span class="dv">2014</span>, <span class="dv">1</span>),</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>                                end <span class="op">=</span> c(<span class="dv">2017</span>, <span class="dv">12</span>),</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>                                frequency <span class="op">=</span> <span class="dv">12</span>)</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a><span class="co">#### 4 A</span></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Apply forecasting methods to the top 3 sub-categories</span></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>forecast_results <span class="op">&lt;-</span> <span class="bu">list</span>()  <span class="co"># Store results</span></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (subcategory <span class="kw">in</span> names(ts_list)) {</span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>  ts_current <span class="op">&lt;-</span> ts_list[[subcategory]]</span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Split the data into training and validation sets (70% training, 30% testing)</span></span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>  train_size <span class="op">&lt;-</span> floor(<span class="fl">0.7</span> <span class="op">*</span> length(ts_current))</span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a>  train_ts <span class="op">&lt;-</span> window(ts_current, end <span class="op">=</span> c(<span class="dv">2014</span> <span class="op">+</span> (train_size <span class="op">-</span> <span class="dv">1</span>) <span class="op">%/%</span> <span class="dv">12</span>, (train_size <span class="op">-</span> <span class="dv">1</span>) <span class="op">%%</span> <span class="dv">12</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>  test_ts <span class="op">&lt;-</span> window(ts_current, start <span class="op">=</span> c(<span class="dv">2014</span> <span class="op">+</span> train_size <span class="op">%/%</span> <span class="dv">12</span>, train_size <span class="op">%%</span> <span class="dv">12</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1. ARIMA</span></span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>  arima_model <span class="op">&lt;-</span> auto.arima(train_ts)</span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a>  arima_forecast <span class="op">&lt;-</span> forecast(arima_model, h <span class="op">=</span> length(test_ts))</span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a>  arima_accuracy <span class="op">&lt;-</span> accuracy(arima_forecast, test_ts)</span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2. Holt-Winters</span></span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a>  hw_model <span class="op">&lt;-</span> HoltWinters(train_ts)</span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a>  hw_forecast <span class="op">&lt;-</span> forecast(hw_model, h <span class="op">=</span> length(test_ts))</span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a>  hw_accuracy <span class="op">&lt;-</span> accuracy(hw_forecast, test_ts)</span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3. ETS</span></span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a>  ets_model <span class="op">&lt;-</span> ets(train_ts)</span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a>  ets_forecast <span class="op">&lt;-</span> forecast(ets_model, h <span class="op">=</span> length(test_ts))</span>
<span id="cb14-68"><a href="#cb14-68" aria-hidden="true" tabindex="-1"></a>  ets_accuracy <span class="op">&lt;-</span> accuracy(ets_forecast, test_ts)</span>
<span id="cb14-69"><a href="#cb14-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-70"><a href="#cb14-70" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store results</span></span>
<span id="cb14-71"><a href="#cb14-71" aria-hidden="true" tabindex="-1"></a>  forecast_results[[subcategory]] <span class="op">&lt;-</span> <span class="bu">list</span>(</span>
<span id="cb14-72"><a href="#cb14-72" aria-hidden="true" tabindex="-1"></a>    ARIMA <span class="op">=</span> <span class="bu">list</span>(Model <span class="op">=</span> arima_model, Forecast <span class="op">=</span> arima_forecast, Accuracy <span class="op">=</span> arima_accuracy),</span>
<span id="cb14-73"><a href="#cb14-73" aria-hidden="true" tabindex="-1"></a>    HoltWinters <span class="op">=</span> <span class="bu">list</span>(Model <span class="op">=</span> hw_model, Forecast <span class="op">=</span> hw_forecast, Accuracy <span class="op">=</span> hw_accuracy),</span>
<span id="cb14-74"><a href="#cb14-74" aria-hidden="true" tabindex="-1"></a>    ETS <span class="op">=</span> <span class="bu">list</span>(Model <span class="op">=</span> ets_model, Forecast <span class="op">=</span> ets_forecast, Accuracy <span class="op">=</span> ets_accuracy)</span>
<span id="cb14-75"><a href="#cb14-75" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb14-76"><a href="#cb14-76" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-77"><a href="#cb14-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-78"><a href="#cb14-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-79"><a href="#cb14-79" aria-hidden="true" tabindex="-1"></a><span class="co"># For formatting, we ommitted almost all output. You can uncomment the code and check your output if you like.</span></span>
<span id="cb14-80"><a href="#cb14-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-81"><a href="#cb14-81" aria-hidden="true" tabindex="-1"></a><span class="co"># # Step 5: Print results</span></span>
<span id="cb14-82"><a href="#cb14-82" aria-hidden="true" tabindex="-1"></a><span class="co">#  for (subcategory in names(forecast_results)) {</span></span>
<span id="cb14-83"><a href="#cb14-83" aria-hidden="true" tabindex="-1"></a><span class="co">#   cat("\n\nResults for Sub_Category:", subcategory, "\n")</span></span>
<span id="cb14-84"><a href="#cb14-84" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb14-85"><a href="#cb14-85" aria-hidden="true" tabindex="-1"></a><span class="co">#   cat("\nARIMA Accuracy:\n")</span></span>
<span id="cb14-86"><a href="#cb14-86" aria-hidden="true" tabindex="-1"></a><span class="co">#   print(forecast_results[[subcategory]]$ARIMA$Accuracy)</span></span>
<span id="cb14-87"><a href="#cb14-87" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb14-88"><a href="#cb14-88" aria-hidden="true" tabindex="-1"></a><span class="co">#   cat("\nHolt-Winters Accuracy:\n")</span></span>
<span id="cb14-89"><a href="#cb14-89" aria-hidden="true" tabindex="-1"></a><span class="co">#   print(forecast_results[[subcategory]]$HoltWinters$Accuracy)</span></span>
<span id="cb14-90"><a href="#cb14-90" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb14-91"><a href="#cb14-91" aria-hidden="true" tabindex="-1"></a><span class="co">#   cat("\nETS Accuracy:\n")</span></span>
<span id="cb14-92"><a href="#cb14-92" aria-hidden="true" tabindex="-1"></a><span class="co">#   print(forecast_results[[subcategory]]$ETS$Accuracy)</span></span>
<span id="cb14-93"><a href="#cb14-93" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div id="f16aadf2-dd1b-4cbd-98cc-5a009da93060" class="cell markdown">
<p>Three models are applied to each subcategory to forecast it. The models we use are: ARIMA, Holt-Winters and ETS. We have chosen these models because of their level of suitability for discrete time series data with all different levels of trend and seasonality. To evaluate the methods and its effectiveness , the data is split into a training set (70%) and testing set (30%).</p>
<p>To assess the results, we use the following performance metrics: ME, RMSE, MAE and MAPE. They are calculated for the training and testing phases of the forecast.</p>
<p>As we can see on the forecasting results ARIMA performed well for binders. We can state this because of the lowest RMSE if you compare it to the other models.</p>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [24]:</pre></div><div id="0b8e76a5-8d72-4855-9fea-a068725354d2" class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lets plot the results</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (subcategory <span class="kw">in</span> names(forecast_results)) {</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  ts_current <span class="op">&lt;-</span> ts_list[[subcategory]]</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  train_size <span class="op">&lt;-</span> floor(<span class="fl">0.7</span> <span class="op">*</span> length(ts_current))</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  test_ts <span class="op">&lt;-</span> window(ts_current, start <span class="op">=</span> c(<span class="dv">2014</span> <span class="op">+</span> train_size <span class="op">%/%</span> <span class="dv">12</span>, train_size <span class="op">%%</span> <span class="dv">12</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  arima_forecast <span class="op">&lt;-</span> forecast_results[[subcategory]]$ARIMA$Forecast</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  hw_forecast <span class="op">&lt;-</span> forecast_results[[subcategory]]$HoltWinters$Forecast</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  ets_forecast <span class="op">&lt;-</span> forecast_results[[subcategory]]$ETS$Forecast</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combined plot</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  plot(arima_forecast$mean, col <span class="op">=</span> <span class="st">"blue"</span>, lwd <span class="op">=</span> <span class="dv">2</span>, </span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>       ylim <span class="op">=</span> <span class="bu">range</span>(c(arima_forecast$mean, hw_forecast$mean, ets_forecast$mean, test_ts)),</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>       main <span class="op">=</span> paste(<span class="st">"Combined Forecasts for"</span>, subcategory, <span class="st">"before differencing"</span>),</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>       xlab <span class="op">=</span> <span class="st">"Time"</span>, ylab <span class="op">=</span> <span class="st">"Forecasted Values"</span>)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  lines(test_ts, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="dv">2</span>, lwd <span class="op">=</span> <span class="dv">2</span>)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  lines(hw_forecast$mean, col <span class="op">=</span> <span class="st">"green"</span>, lwd <span class="op">=</span> <span class="dv">2</span>)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  lines(ets_forecast$mean, col <span class="op">=</span> <span class="st">"purple"</span>, lwd <span class="op">=</span> <span class="dv">2</span>)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  legend(<span class="st">"topleft"</span>, legend <span class="op">=</span> c(<span class="st">"ARIMA"</span>, <span class="st">"Holt-Winters"</span>, <span class="st">"ETS"</span>, <span class="st">"Test Data"</span>),</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>         col <span class="op">=</span> c(<span class="st">"blue"</span>, <span class="st">"green"</span>, <span class="st">"purple"</span>, <span class="st">"red"</span>), lty <span class="op">=</span> c(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>), lwd <span class="op">=</span> <span class="dv">2</span>)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index.out%203_files/figure-html/cell-13-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="index.out%203_files/figure-html/cell-13-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index.out%203_files/figure-html/cell-13-output-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="index.out%203_files/figure-html/cell-13-output-2.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index.out%203_files/figure-html/cell-13-output-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="index.out%203_files/figure-html/cell-13-output-3.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [25]:</pre></div><div id="596e7327-50ff-4199-b948-9223f91c9eda" class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>options(warn <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># # Step 6: Visualization of Forecasts</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># for (subcategory in names(forecast_results)) {</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot(forecast_results[[subcategory]]$ARIMA$Forecast, main = paste("ARIMA Forecast for", subcategory))</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   lines(test_ts, col = "red", lty = 2)</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot(forecast_results[[subcategory]]$HoltWinters$Forecast, main = paste("Holt-Winters Forecast for", subcategory))</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   lines(test_ts, col = "red", lty = 2)</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot(forecast_results[[subcategory]]$ETS$Forecast, main = paste("ETS Forecast for", subcategory))</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   lines(test_ts, col = "red", lty = 2)</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co">#more stationary tests</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform KPSS Test for the top 3 subcategories</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="co"># top_3_subcategories &lt;- top_categories$Sub_Category[0:3]</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="co"># for (subcategory in top_3_subcategories) {</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   if (subcategory %in% names(ts_list)) {</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="co">#     ts_current &lt;- ts_list[[subcategory]]</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="co">#     cat("\nKPSS Test for Sub-Category:", subcategory, "\n")</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="co">#     print(kpss.test(ts_current))</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="co">#   } else {</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="co">#     cat("\nSub-Category not found in ts_list:", subcategory, "\n")</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a><span class="co">#   }</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a><span class="co">#Because the all the 3 subcategory are non stationary because of a P value which is &lt;=0.05 we need to use differencing</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply differencing to each of the top 3 subcategories</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>differenced_series <span class="op">&lt;-</span> <span class="bu">list</span>()</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (subcategory <span class="kw">in</span> top_3_subcategories) {</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (subcategory <span class="op">%</span><span class="kw">in</span><span class="op">%</span> names(ts_list)) {</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>    ts_current <span class="op">&lt;-</span> ts_list[[subcategory]]  <span class="co"># Get the time series for the subcategory</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>    ts_diff <span class="op">&lt;-</span> diff(ts_current, differences <span class="op">=</span> <span class="dv">1</span>)  <span class="co"># Apply first-order differencing</span></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>    differenced_series[[subcategory]] <span class="op">&lt;-</span> ts_diff  <span class="co"># Store the differenced series</span></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Recheck stationarity with KPSS test</span></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>    <span class="co">#cat("\nKPSS Test for Differenced Sub-Category:", subcategory, "\n")</span></span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(kpss.test(ts_diff))</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>    <span class="co">#cat("\nSub-Category not found in ts_list:", subcategory, "\n")</span></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    KPSS Test for Level Stationarity

data:  ts_diff
KPSS Level = 0.10182, Truncation lag parameter = 3, p-value = 0.1


    KPSS Test for Level Stationarity

data:  ts_diff
KPSS Level = 0.061982, Truncation lag parameter = 3, p-value = 0.1


    KPSS Test for Level Stationarity

data:  ts_diff
KPSS Level = 0.098438, Truncation lag parameter = 3, p-value = 0.1</code></pre>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [26]:</pre></div><div id="72b9e3ea-fbd1-40ad-8276-b2facc7721b6" class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Time differenced plots</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># # Now P value is larger then 0.05 so we have stationary data</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># # Plot the differenced series for each subcategory</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># for (subcategory in top_3_subcategories) {</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   if (subcategory %in% names(differenced_series)) {</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     ts_diff &lt;- differenced_series[[subcategory]]</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     cat("\nPlotting Differenced Series for Sub-Category:", subcategory, "\n")</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     plot(ts_diff, main = paste("Differenced Series for Sub-Category:", subcategory),</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co">#          ylab = "Differenced Values", xlab = "Time")</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   }</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine differenced series plots for all top subcategories</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>combined_diff_plot <span class="op">&lt;-</span> function(differenced_series, top_3_subcategories) {</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  plot(NULL, xlim <span class="op">=</span> <span class="bu">range</span>(time(differenced_series[[top_3_subcategories[<span class="dv">1</span>]]])), </span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>       ylim <span class="op">=</span> <span class="bu">range</span>(sapply(differenced_series[top_3_subcategories], <span class="bu">range</span>, na.rm <span class="op">=</span> TRUE)),</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>       xlab <span class="op">=</span> <span class="st">"Time"</span>, ylab <span class="op">=</span> <span class="st">"Differenced Values"</span>,</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>       main <span class="op">=</span> <span class="st">"Differenced Series for Top Subcategories"</span>)</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  colors <span class="op">&lt;-</span> c(<span class="st">"blue"</span>, <span class="st">"green"</span>, <span class="st">"purple"</span>)</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="kw">in</span> seq_along(top_3_subcategories)) {</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    subcategory <span class="op">&lt;-</span> top_3_subcategories[i]</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (subcategory <span class="op">%</span><span class="kw">in</span><span class="op">%</span> names(differenced_series)) {</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>      ts_diff <span class="op">&lt;-</span> differenced_series[[subcategory]]</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>      lines(ts_diff, col <span class="op">=</span> colors[i], lwd <span class="op">=</span> <span class="dv">2</span>, lty <span class="op">=</span> i)</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>  legend(<span class="st">"topright"</span>, legend <span class="op">=</span> top_3_subcategories, </span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>         col <span class="op">=</span> colors, lty <span class="op">=</span> <span class="dv">1</span>:length(top_3_subcategories), lwd <span class="op">=</span> <span class="dv">2</span>)</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>combined_diff_plot(differenced_series, top_3_subcategories)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="">
<figure class="figure">
<p class=""><a href="index.out%203_files/figure-html/cell-15-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="index.out%203_files/figure-html/cell-15-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [27]:</pre></div><div id="38533140-1656-47b0-94e9-8f3ec3b1675d" class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#NEW FORECASTING FOR 4A with stationary data</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Apply forecasting methods to the differenced top 3 sub-categories</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>forecast_results <span class="op">&lt;-</span> <span class="bu">list</span>()  <span class="co"># Store results</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (subcategory <span class="kw">in</span> names(differenced_series)) {</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  ts_current <span class="op">&lt;-</span> differenced_series[[subcategory]]  <span class="co"># Use the differenced series</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Split the data into training and validation sets (70% training, 30% testing)</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  train_size <span class="op">&lt;-</span> floor(<span class="fl">0.7</span> <span class="op">*</span> length(ts_current))</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  train_ts <span class="op">&lt;-</span> window(ts_current, end <span class="op">=</span> c(<span class="dv">2014</span> <span class="op">+</span> (train_size <span class="op">-</span> <span class="dv">1</span>) <span class="op">%/%</span> <span class="dv">12</span>, (train_size <span class="op">-</span> <span class="dv">1</span>) <span class="op">%%</span> <span class="dv">12</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  test_ts <span class="op">&lt;-</span> window(ts_current, start <span class="op">=</span> c(<span class="dv">2014</span> <span class="op">+</span> train_size <span class="op">%/%</span> <span class="dv">12</span>, train_size <span class="op">%%</span> <span class="dv">12</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1. ARIMA</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  arima_model <span class="op">&lt;-</span> auto.arima(train_ts)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  arima_forecast <span class="op">&lt;-</span> forecast(arima_model, h <span class="op">=</span> length(test_ts))</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  arima_accuracy <span class="op">&lt;-</span> accuracy(arima_forecast, test_ts)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2. Holt-Winters</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>  hw_model <span class="op">&lt;-</span> HoltWinters(train_ts)</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>  hw_forecast <span class="op">&lt;-</span> forecast(hw_model, h <span class="op">=</span> length(test_ts))</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>  hw_accuracy <span class="op">&lt;-</span> accuracy(hw_forecast, test_ts)</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3. ETS</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>  ets_model <span class="op">&lt;-</span> ets(train_ts)</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>  ets_forecast <span class="op">&lt;-</span> forecast(ets_model, h <span class="op">=</span> length(test_ts))</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>  ets_accuracy <span class="op">&lt;-</span> accuracy(ets_forecast, test_ts)</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store results</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>  forecast_results[[subcategory]] <span class="op">&lt;-</span> <span class="bu">list</span>(</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>    ARIMA <span class="op">=</span> <span class="bu">list</span>(Model <span class="op">=</span> arima_model, Forecast <span class="op">=</span> arima_forecast, Accuracy <span class="op">=</span> arima_accuracy),</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>    HoltWinters <span class="op">=</span> <span class="bu">list</span>(Model <span class="op">=</span> hw_model, Forecast <span class="op">=</span> hw_forecast, Accuracy <span class="op">=</span> hw_accuracy),</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>    ETS <span class="op">=</span> <span class="bu">list</span>(Model <span class="op">=</span> ets_model, Forecast <span class="op">=</span> ets_forecast, Accuracy <span class="op">=</span> ets_accuracy)</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a><span class="co"># # Step 5: Print results</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a><span class="co"># for (subcategory in names(forecast_results)) {</span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a><span class="co">#   cat("\n\nResults for Sub_Category:", subcategory, "\n")</span></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a><span class="co">#   cat("\nARIMA Accuracy:\n")</span></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a><span class="co">#   print(forecast_results[[subcategory]]$ARIMA$Accuracy)</span></span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a><span class="co">#   cat("\nHolt-Winters Accuracy:\n")</span></span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a><span class="co">#   print(forecast_results[[subcategory]]$HoltWinters$Accuracy)</span></span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a><span class="co">#   cat("\nETS Accuracy:\n")</span></span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a><span class="co">#   print(forecast_results[[subcategory]]$ETS$Accuracy)</span></span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a><span class="co"># # Step 6: Visualization of Forecasts</span></span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a><span class="co"># for (subcategory in names(forecast_results)) {</span></span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot(forecast_results[[subcategory]]$ARIMA$Forecast,</span></span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a><span class="co">#        main = paste("ARIMA Forecast for", subcategory),</span></span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a><span class="co">#        ylab = "Differenced Values", xlab = "Time")</span></span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a><span class="co">#   lines(test_ts, col = "red", lty = 2)</span></span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot(forecast_results[[subcategory]]$HoltWinters$Forecast,</span></span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a><span class="co">#        main = paste("Holt-Winters Forecast for", subcategory),</span></span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a><span class="co">#        ylab = "Differenced Values", xlab = "Time")</span></span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a><span class="co">#   lines(test_ts, col = "red", lty = 2)</span></span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb19-62"><a href="#cb19-62" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot(forecast_results[[subcategory]]$ETS$Forecast,</span></span>
<span id="cb19-63"><a href="#cb19-63" aria-hidden="true" tabindex="-1"></a><span class="co">#        main = paste("ETS Forecast for", subcategory),</span></span>
<span id="cb19-64"><a href="#cb19-64" aria-hidden="true" tabindex="-1"></a><span class="co">#        ylab = "Differenced Values", xlab = "Time")</span></span>
<span id="cb19-65"><a href="#cb19-65" aria-hidden="true" tabindex="-1"></a><span class="co">#   lines(test_ts, col = "red", lty = 2)</span></span>
<span id="cb19-66"><a href="#cb19-66" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb19-67"><a href="#cb19-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-68"><a href="#cb19-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Lets plot the results</span></span>
<span id="cb19-69"><a href="#cb19-69" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (subcategory <span class="kw">in</span> names(forecast_results)) {</span>
<span id="cb19-70"><a href="#cb19-70" aria-hidden="true" tabindex="-1"></a>  ts_current <span class="op">&lt;-</span> ts_list[[subcategory]]</span>
<span id="cb19-71"><a href="#cb19-71" aria-hidden="true" tabindex="-1"></a>  train_size <span class="op">&lt;-</span> floor(<span class="fl">0.7</span> <span class="op">*</span> length(ts_current))</span>
<span id="cb19-72"><a href="#cb19-72" aria-hidden="true" tabindex="-1"></a>  test_ts <span class="op">&lt;-</span> window(ts_current, start <span class="op">=</span> c(<span class="dv">2014</span> <span class="op">+</span> train_size <span class="op">%/%</span> <span class="dv">12</span>, train_size <span class="op">%%</span> <span class="dv">12</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb19-73"><a href="#cb19-73" aria-hidden="true" tabindex="-1"></a>  arima_forecast <span class="op">&lt;-</span> forecast_results[[subcategory]]$ARIMA$Forecast</span>
<span id="cb19-74"><a href="#cb19-74" aria-hidden="true" tabindex="-1"></a>  hw_forecast <span class="op">&lt;-</span> forecast_results[[subcategory]]$HoltWinters$Forecast</span>
<span id="cb19-75"><a href="#cb19-75" aria-hidden="true" tabindex="-1"></a>  ets_forecast <span class="op">&lt;-</span> forecast_results[[subcategory]]$ETS$Forecast</span>
<span id="cb19-76"><a href="#cb19-76" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-77"><a href="#cb19-77" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combined plot</span></span>
<span id="cb19-78"><a href="#cb19-78" aria-hidden="true" tabindex="-1"></a>  plot(arima_forecast$mean, col <span class="op">=</span> <span class="st">"blue"</span>, lwd <span class="op">=</span> <span class="dv">2</span>, </span>
<span id="cb19-79"><a href="#cb19-79" aria-hidden="true" tabindex="-1"></a>       ylim <span class="op">=</span> <span class="bu">range</span>(c(arima_forecast$mean, hw_forecast$mean, ets_forecast$mean, test_ts)),</span>
<span id="cb19-80"><a href="#cb19-80" aria-hidden="true" tabindex="-1"></a>       main <span class="op">=</span> paste(<span class="st">"Combined Forecasts for"</span>, subcategory, <span class="st">"before differencing"</span>),</span>
<span id="cb19-81"><a href="#cb19-81" aria-hidden="true" tabindex="-1"></a>       xlab <span class="op">=</span> <span class="st">"Time"</span>, ylab <span class="op">=</span> <span class="st">"Forecasted Values"</span>)</span>
<span id="cb19-82"><a href="#cb19-82" aria-hidden="true" tabindex="-1"></a>  lines(test_ts, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="dv">2</span>, lwd <span class="op">=</span> <span class="dv">2</span>)</span>
<span id="cb19-83"><a href="#cb19-83" aria-hidden="true" tabindex="-1"></a>  lines(hw_forecast$mean, col <span class="op">=</span> <span class="st">"green"</span>, lwd <span class="op">=</span> <span class="dv">2</span>)</span>
<span id="cb19-84"><a href="#cb19-84" aria-hidden="true" tabindex="-1"></a>  lines(ets_forecast$mean, col <span class="op">=</span> <span class="st">"purple"</span>, lwd <span class="op">=</span> <span class="dv">2</span>)</span>
<span id="cb19-85"><a href="#cb19-85" aria-hidden="true" tabindex="-1"></a>  legend(<span class="st">"topleft"</span>, legend <span class="op">=</span> c(<span class="st">"ARIMA"</span>, <span class="st">"Holt-Winters"</span>, <span class="st">"ETS"</span>, <span class="st">"Test Data"</span>),</span>
<span id="cb19-86"><a href="#cb19-86" aria-hidden="true" tabindex="-1"></a>         col <span class="op">=</span> c(<span class="st">"blue"</span>, <span class="st">"green"</span>, <span class="st">"purple"</span>, <span class="st">"red"</span>), lty <span class="op">=</span> c(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>), lwd <span class="op">=</span> <span class="dv">2</span>)</span>
<span id="cb19-87"><a href="#cb19-87" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index.out%203_files/figure-html/cell-16-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="index.out%203_files/figure-html/cell-16-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index.out%203_files/figure-html/cell-16-output-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="index.out%203_files/figure-html/cell-16-output-2.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index.out%203_files/figure-html/cell-16-output-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="index.out%203_files/figure-html/cell-16-output-3.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [28]:</pre></div><div id="14790817-b195-457d-8181-b6e891d34c1f" class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># final KPSS test</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform KPSS Test for the differenced series in the top 3 subcategories</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (subcategory <span class="kw">in</span> top_3_subcategories) {</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (subcategory <span class="op">%</span><span class="kw">in</span><span class="op">%</span> names(differenced_series)) {</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    ts_current <span class="op">&lt;-</span> differenced_series[[subcategory]]  <span class="co"># Get the differenced series</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    cat(<span class="st">"</span><span class="ch">\n</span><span class="st">KPSS Test for Differenced Sub-Category:"</span>, subcategory, <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(kpss.test(ts_current))</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    cat(<span class="st">"</span><span class="ch">\n</span><span class="st">Sub-Category not found in differenced_series:"</span>, subcategory, <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
KPSS Test for Differenced Sub-Category: Binders 

    KPSS Test for Level Stationarity

data:  ts_current
KPSS Level = 0.10182, Truncation lag parameter = 3, p-value = 0.1


KPSS Test for Differenced Sub-Category: Paper 

    KPSS Test for Level Stationarity

data:  ts_current
KPSS Level = 0.061982, Truncation lag parameter = 3, p-value = 0.1


KPSS Test for Differenced Sub-Category: Furnishings 

    KPSS Test for Level Stationarity

data:  ts_current
KPSS Level = 0.098438, Truncation lag parameter = 3, p-value = 0.1</code></pre>
</div>
</div></div>
<div id="15a4b7ad-7b28-495d-9b2c-b4098cc03abf" class="cell markdown">
<p>As we can see on the forecasting results ARIMA performed well for binders. We can state this because of the lowest RMSE. - ARIMA Binders: - Forecasting results Binders:</p>
<p>For the subcategory furnishings we can see that the ETS forecasting method is the most stable across the training and testing phase. - ETS furnishings - Forecasting results Furnishings:</p>
<p>For the last subcategory and product paper the ETS model is again the most consistent, comparing the statistics for training and test set. The high variability in the test data leads to larger forecasting errors in all the 3 models.</p>
<ul>
<li>ETS Furnishings:</li>
<li>Forecasting results:</li>
</ul>
<p>Residual Diagnostics: - The checks show no real autocorrelation for ARIMA models. Which indicates a good fitting forecast.</p>
<section id="conclusion-4a" class="level3">
<h3 class="anchored" data-anchor-id="conclusion-4a">Conclusion (4a)</h3>
<p>The most effective model is not the same in all the subcategories. Each model was validated based on its ability to capture seasonality and trend. ARIMA performed better for Binders, while ETS performed better for Furnishings and Paper.</p>
</section>
<section id="clustering-4b" class="level3">
<h3 class="anchored" data-anchor-id="clustering-4b">Clustering (4b)</h3>
</section>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [30]:</pre></div><div id="bf29c8e5-bcc9-450b-bc92-2e1e28b56b43" class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4B</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 4B: Group Products into Clusters and Apply Forecasting Techniques</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Extract Time-Series Features for Clustering</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>time_series_features <span class="op">&lt;-</span> data.frame()</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (subcategory <span class="kw">in</span> names(ts_list)) {</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  ts_current <span class="op">&lt;-</span> ts_list[[subcategory]]</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Decompose the time series to extract features</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  decomposition <span class="op">&lt;-</span> decompose(ts_current)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  trend_strength <span class="op">&lt;-</span> var(decomposition$trend, na.rm <span class="op">=</span> TRUE) <span class="op">/</span> var(ts_current, na.rm <span class="op">=</span> TRUE)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  seasonal_strength <span class="op">&lt;-</span> var(decomposition$seasonal, na.rm <span class="op">=</span> TRUE) <span class="op">/</span> var(ts_current, na.rm <span class="op">=</span> TRUE)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  random_strength <span class="op">&lt;-</span> var(decomposition$random, na.rm <span class="op">=</span> TRUE) <span class="op">/</span> var(ts_current, na.rm <span class="op">=</span> TRUE)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store extracted features</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>  time_series_features <span class="op">&lt;-</span> rbind(time_series_features,</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>                                data.frame(SubCategory <span class="op">=</span> subcategory,</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>                                           TrendStrength <span class="op">=</span> trend_strength,</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>                                           SeasonalStrength <span class="op">=</span> seasonal_strength,</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>                                           RandomStrength <span class="op">=</span> random_strength))</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Normalize the Features for Clustering</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>time_series_features_scaled <span class="op">&lt;-</span> time_series_features <span class="op">%&gt;%</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>  select(<span class="op">-</span>SubCategory) <span class="op">%&gt;%</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>  scale()</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a><span class="co"># verify rows</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a><span class="co"># nrow(time_series_features_scaled)</span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Perform K-Means Clustering</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine the number of clusters dynamically</span></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>k <span class="op">&lt;-</span> <span class="bu">min</span>(<span class="dv">3</span>, nrow(time_series_features_scaled))  <span class="co"># Set k to the smaller of 3 or the number of rows</span></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Hierarchical Clustering</span></span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>distance_matrix <span class="op">&lt;-</span> dist(time_series_features_scaled)  <span class="co"># Calculate distance matrix</span></span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>hc <span class="op">&lt;-</span> hclust(distance_matrix)  <span class="co"># Perform hierarchical clustering</span></span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>time_series_features$Cluster <span class="op">&lt;-</span> cutree(hc, k <span class="op">=</span> k)  <span class="co"># Cut tree into 'k' clusters</span></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cluster information to the original data</span></span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>time_series_features$Cluster <span class="op">&lt;-</span> cutree(hc, k <span class="op">=</span> k)</span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Apply Forecasting Techniques to Each Cluster</span></span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>forecast_results_by_cluster <span class="op">&lt;-</span> <span class="bu">list</span>()</span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (cluster_id <span class="kw">in</span> unique(time_series_features$Cluster)) {</span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get subcategories in the current cluster</span></span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>  subcategories_in_cluster <span class="op">&lt;-</span> time_series_features$SubCategory[time_series_features$Cluster <span class="op">==</span> cluster_id]</span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize storage for cluster results</span></span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a>  cluster_forecast_results <span class="op">&lt;-</span> <span class="bu">list</span>()</span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (subcategory <span class="kw">in</span> subcategories_in_cluster) {</span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (subcategory <span class="op">%</span><span class="kw">in</span><span class="op">%</span> names(ts_list)) {</span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a>      ts_current <span class="op">&lt;-</span> ts_list[[subcategory]]  <span class="co"># Access the time series</span></span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-55"><a href="#cb22-55" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Split the data into training and validation sets (70% training, 30% testing)</span></span>
<span id="cb22-56"><a href="#cb22-56" aria-hidden="true" tabindex="-1"></a>      train_size <span class="op">&lt;-</span> floor(<span class="fl">0.7</span> <span class="op">*</span> length(ts_current))</span>
<span id="cb22-57"><a href="#cb22-57" aria-hidden="true" tabindex="-1"></a>      train_ts <span class="op">&lt;-</span> window(ts_current, end <span class="op">=</span> c(<span class="dv">2014</span> <span class="op">+</span> (train_size <span class="op">-</span> <span class="dv">1</span>) <span class="op">%/%</span> <span class="dv">12</span>, (train_size <span class="op">-</span> <span class="dv">1</span>) <span class="op">%%</span> <span class="dv">12</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb22-58"><a href="#cb22-58" aria-hidden="true" tabindex="-1"></a>      test_ts <span class="op">&lt;-</span> window(ts_current, start <span class="op">=</span> c(<span class="dv">2014</span> <span class="op">+</span> train_size <span class="op">%/%</span> <span class="dv">12</span>, train_size <span class="op">%%</span> <span class="dv">12</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb22-59"><a href="#cb22-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-60"><a href="#cb22-60" aria-hidden="true" tabindex="-1"></a>      <span class="co"># 1. ARIMA</span></span>
<span id="cb22-61"><a href="#cb22-61" aria-hidden="true" tabindex="-1"></a>      arima_model <span class="op">&lt;-</span> auto.arima(train_ts)</span>
<span id="cb22-62"><a href="#cb22-62" aria-hidden="true" tabindex="-1"></a>      arima_forecast <span class="op">&lt;-</span> forecast(arima_model, h <span class="op">=</span> length(test_ts))</span>
<span id="cb22-63"><a href="#cb22-63" aria-hidden="true" tabindex="-1"></a>      arima_accuracy <span class="op">&lt;-</span> accuracy(arima_forecast, test_ts)</span>
<span id="cb22-64"><a href="#cb22-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-65"><a href="#cb22-65" aria-hidden="true" tabindex="-1"></a>      <span class="co"># 2. Holt-Winters</span></span>
<span id="cb22-66"><a href="#cb22-66" aria-hidden="true" tabindex="-1"></a>      hw_model <span class="op">&lt;-</span> HoltWinters(train_ts)</span>
<span id="cb22-67"><a href="#cb22-67" aria-hidden="true" tabindex="-1"></a>      hw_forecast <span class="op">&lt;-</span> forecast(hw_model, h <span class="op">=</span> length(test_ts))</span>
<span id="cb22-68"><a href="#cb22-68" aria-hidden="true" tabindex="-1"></a>      hw_accuracy <span class="op">&lt;-</span> accuracy(hw_forecast, test_ts)</span>
<span id="cb22-69"><a href="#cb22-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-70"><a href="#cb22-70" aria-hidden="true" tabindex="-1"></a>      <span class="co"># 3. ETS</span></span>
<span id="cb22-71"><a href="#cb22-71" aria-hidden="true" tabindex="-1"></a>      ets_model <span class="op">&lt;-</span> ets(train_ts)</span>
<span id="cb22-72"><a href="#cb22-72" aria-hidden="true" tabindex="-1"></a>      ets_forecast <span class="op">&lt;-</span> forecast(ets_model, h <span class="op">=</span> length(test_ts))</span>
<span id="cb22-73"><a href="#cb22-73" aria-hidden="true" tabindex="-1"></a>      ets_accuracy <span class="op">&lt;-</span> accuracy(ets_forecast, test_ts)</span>
<span id="cb22-74"><a href="#cb22-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-75"><a href="#cb22-75" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Store results for the subcategory</span></span>
<span id="cb22-76"><a href="#cb22-76" aria-hidden="true" tabindex="-1"></a>      cluster_forecast_results[[subcategory]] <span class="op">&lt;-</span> <span class="bu">list</span>(</span>
<span id="cb22-77"><a href="#cb22-77" aria-hidden="true" tabindex="-1"></a>        ARIMA <span class="op">=</span> <span class="bu">list</span>(Model <span class="op">=</span> arima_model, Forecast <span class="op">=</span> arima_forecast, Accuracy <span class="op">=</span> arima_accuracy),</span>
<span id="cb22-78"><a href="#cb22-78" aria-hidden="true" tabindex="-1"></a>        HoltWinters <span class="op">=</span> <span class="bu">list</span>(Model <span class="op">=</span> hw_model, Forecast <span class="op">=</span> hw_forecast, Accuracy <span class="op">=</span> hw_accuracy),</span>
<span id="cb22-79"><a href="#cb22-79" aria-hidden="true" tabindex="-1"></a>        ETS <span class="op">=</span> <span class="bu">list</span>(Model <span class="op">=</span> ets_model, Forecast <span class="op">=</span> ets_forecast, Accuracy <span class="op">=</span> ets_accuracy)</span>
<span id="cb22-80"><a href="#cb22-80" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb22-81"><a href="#cb22-81" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb22-82"><a href="#cb22-82" aria-hidden="true" tabindex="-1"></a>      cat(<span class="st">"</span><span class="ch">\n</span><span class="st">Sub-Category not found in ts_list:"</span>, subcategory, <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb22-83"><a href="#cb22-83" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb22-84"><a href="#cb22-84" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb22-85"><a href="#cb22-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-86"><a href="#cb22-86" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store results for the cluster</span></span>
<span id="cb22-87"><a href="#cb22-87" aria-hidden="true" tabindex="-1"></a>  forecast_results_by_cluster[[paste0(<span class="st">"Cluster_"</span>, cluster_id)]] <span class="op">&lt;-</span> cluster_forecast_results</span>
<span id="cb22-88"><a href="#cb22-88" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-89"><a href="#cb22-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-90"><a href="#cb22-90" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Print Forecasting Accuracy for Each Cluster</span></span>
<span id="cb22-91"><a href="#cb22-91" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (cluster_id <span class="kw">in</span> names(forecast_results_by_cluster)) {</span>
<span id="cb22-92"><a href="#cb22-92" aria-hidden="true" tabindex="-1"></a>  cat(<span class="st">"</span><span class="ch">\n\n</span><span class="st">Results for"</span>, cluster_id, <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb22-93"><a href="#cb22-93" aria-hidden="true" tabindex="-1"></a>  cluster_results <span class="op">&lt;-</span> forecast_results_by_cluster[[cluster_id]]</span>
<span id="cb22-94"><a href="#cb22-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-95"><a href="#cb22-95" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (subcategory <span class="kw">in</span> names(cluster_results)) {</span>
<span id="cb22-96"><a href="#cb22-96" aria-hidden="true" tabindex="-1"></a>    cat(<span class="st">"</span><span class="ch">\n</span><span class="st">Sub-Category:"</span>, subcategory, <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb22-97"><a href="#cb22-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-98"><a href="#cb22-98" aria-hidden="true" tabindex="-1"></a>    cat(<span class="st">"</span><span class="ch">\n</span><span class="st">ARIMA Accuracy:</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb22-99"><a href="#cb22-99" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(cluster_results[[subcategory]]$ARIMA$Accuracy)</span>
<span id="cb22-100"><a href="#cb22-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-101"><a href="#cb22-101" aria-hidden="true" tabindex="-1"></a>    cat(<span class="st">"</span><span class="ch">\n</span><span class="st">Holt-Winters Accuracy:</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb22-102"><a href="#cb22-102" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(cluster_results[[subcategory]]$HoltWinters$Accuracy)</span>
<span id="cb22-103"><a href="#cb22-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-104"><a href="#cb22-104" aria-hidden="true" tabindex="-1"></a>    cat(<span class="st">"</span><span class="ch">\n</span><span class="st">ETS Accuracy:</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb22-105"><a href="#cb22-105" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(cluster_results[[subcategory]]$ETS$Accuracy)</span>
<span id="cb22-106"><a href="#cb22-106" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb22-107"><a href="#cb22-107" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>

Results for Cluster_1 

Sub-Category: Binders 

ARIMA Accuracy:
                    ME      RMSE      MAE        MPE     MAPE      MASE
Training set 0.7706014  4.643476 2.982256  0.6865304 12.91204 0.4854835
Test set     5.9407398 10.783528 7.616473 10.3681817 17.32927 1.2398909
                   ACF1 Theil's U
Training set 0.04429472        NA
Test set     0.04929320 0.3573866

Holt-Winters Accuracy:
                    ME     RMSE      MAE        MPE     MAPE      MASE
Training set 0.8668058 5.215491 3.789990 -0.4040374 15.36545 0.6169751
Test set     2.2473496 8.712049 6.243226  0.1597635 16.02219 1.0163391
                     ACF1 Theil's U
Training set -0.389045966        NA
Test set     -0.001830843 0.2777843

ETS Accuracy:
                   ME      RMSE      MAE       MPE     MAPE      MASE
Training set 0.743354  4.712561 3.656409  1.358692 15.41708 0.5952293
Test set     7.439784 12.216161 8.825094 10.667088 20.93561 1.4366433
                   ACF1 Theil's U
Training set -0.2225537        NA
Test set      0.0608554 0.3767484


Results for Cluster_2 

Sub-Category: Paper 

ARIMA Accuracy:
                    ME      RMSE       MAE        MPE     MAPE      MASE
Training set  1.117384  6.309464  3.827714   1.702165 14.32157 0.5468163
Test set     -9.014128 12.230774 10.375521 -30.103886 31.89519 1.4822173
                     ACF1 Theil's U
Training set -0.007064333        NA
Test set      0.108516273 0.6984566

Holt-Winters Accuracy:
                     ME     RMSE       MAE        MPE     MAPE      MASE
Training set   1.509544  7.27986  4.854547   3.325281 16.41309 0.6935067
Test set     -12.036865 14.48061 13.347292 -39.791842 41.51609 1.9067560
                    ACF1 Theil's U
Training set -0.02710216        NA
Test set      0.10006713  0.845232

ETS Accuracy:
                     ME      RMSE      MAE         MPE     MAPE      MASE
Training set 0.60941117  6.204628 4.474990 -1.66197953 18.73240 0.6392842
Test set     0.08500424 11.304488 8.247017 -0.08462612 20.47598 1.1781453
                    ACF1 Theil's U
Training set 0.005205508        NA
Test set     0.341519997  0.582549


Results for Cluster_3 

Sub-Category: Furnishings 

ARIMA Accuracy:
                    ME     RMSE      MAE       MPE     MAPE      MASE
Training set 0.0050974 3.873555 2.567868 -6.624673 20.20958 0.5559302
Test set     3.9523810 7.782677 6.238095 10.720079 22.75340 1.3505155
                    ACF1 Theil's U
Training set -0.20160077        NA
Test set     -0.03570035 0.6102339

Holt-Winters Accuracy:
                    ME     RMSE      MAE      MPE     MAPE      MASE
Training set 0.9137655 4.164677 3.475419 7.490317 24.75583 0.7524103
Test set     3.6371987 7.200985 5.673333 9.724318 20.50134 1.2282474
                    ACF1 Theil's U
Training set -0.43317305        NA
Test set      0.01804785 0.5689788

ETS Accuracy:
                    ME     RMSE      MAE        MPE     MAPE     MASE
Training set 0.7370579 3.466690 2.851745  0.4301648 20.85220 0.617388
Test set     6.0973038 8.354163 6.690832 20.7276401 23.55317 1.448531
                   ACF1 Theil's U
Training set -0.2087083        NA
Test set      0.3729315 0.7455977</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index.out%203_files/figure-html/cell-18-output-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="index.out%203_files/figure-html/cell-18-output-2.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Residual Diagnostics for Sub-Category: Binders </code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index.out%203_files/figure-html/cell-18-output-4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="index.out%203_files/figure-html/cell-18-output-4.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from ARIMA(0,1,2)(0,1,0)[12]
Q* = 2.6295, df = 5, p-value = 0.7569

Model df: 2.   Total lags used: 7


Residual Diagnostics for Sub-Category: Paper </code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index.out%203_files/figure-html/cell-18-output-6.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="index.out%203_files/figure-html/cell-18-output-6.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from ARIMA(0,1,1)(0,1,0)[12]
Q* = 6.6676, df = 6, p-value = 0.3527

Model df: 1.   Total lags used: 7


Residual Diagnostics for Sub-Category: Furnishings </code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index.out%203_files/figure-html/cell-18-output-8.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="index.out%203_files/figure-html/cell-18-output-8.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from ARIMA(0,0,0)(0,1,0)[12] with drift
Q* = 9.5952, df = 7, p-value = 0.2127

Model df: 0.   Total lags used: 7    Cluster  MeanRMSE MeanMAPE
1 Cluster_1 10.783528 17.32927
2 Cluster_2 12.230774 31.89519
3 Cluster_3  7.782677 22.75340</code></pre>
</div>
</div></div>
<div id="9bc621d0-f2f0-42a6-bbe7-a0cb7bdef128" class="cell markdown">
<p>Cluster 1 (e.g., Binders): ARIMA outperformed other methods due to significant autocorrelation and trend components.</p>
<p>Cluster 2 (e.g., Furnishings): ETS was the most accurate method, effectively balancing trend and seasonality.</p>
<p>Cluster 3 (e.g., Paper): ETS also performed best, with ARIMA showing higher error rates due to variability in random components.</p>
<p>Residual diagnostics were performed for all ARIMA models, confirming no significant autocorrelation (p &gt; 0.05).</p>
<p>Cluster-Level Metrics based on mean RMSE and MAPE show: - Cluster 1 had the lowest RMSE using ARIMA. - Cluster 2 and 3 were better modeled with ETS</p>
<section id="conclusion-4b" class="level3">
<h3 class="anchored" data-anchor-id="conclusion-4b">Conclusion (4b)</h3>
<p>Clustering allows for tailored forecasting strategies. We conclude that for the given data set ARIMA is more effective for clusters with strong trends, while ETS is preferable for clusters with mixed seasonal and trend characteristics. The approach aligns with lecture notes, emphasizing the importance of adapting models based on time series characteristics.</p>
</section>
<section id="forecasting-future-values" class="level2">
<h2 class="anchored" data-anchor-id="forecasting-future-values">5 Forecasting future values</h2>
<section id="forecasting-3-products-5a" class="level3">
<h3 class="anchored" data-anchor-id="forecasting-3-products-5a">Forecasting 3 products (5a)</h3>
<p>In this session, we focused on evaluating different forecasting models (ARIMA, Holt-Winters, and ETS) for multiple sub-categories by analyzing their accuracy metrics, such as RMSE, MAPE, and residual diagnostics. Based on the evaluation results, we selected the best-performing model for each sub-category. We then used these models to forecast the future outcomes for each sub-category, projecting the data for the next year. Note: we may need to interpret the outcomes and explain why we pick the certain model</p>
</section>
</section>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [32]:</pre></div><div id="89e929d9-0e68-44f1-a16c-d502f69d6cf4" class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Binders-&gt;choose ARIMA</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>binders_ts <span class="op">&lt;-</span> ts_list[[<span class="st">"Binders"</span>]]</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>arima_model <span class="op">&lt;-</span> auto.arima(binders_ts)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>summary(arima_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: binders_ts 
ARIMA(1,1,1)(0,1,0)[12] 

Coefficients:
          ar1      ma1
      -0.4781  -0.4819
s.e.   0.2324   0.2426

sigma^2 = 51.18:  log likelihood = -117.97
AIC=241.94   AICc=242.72   BIC=246.61

Training set error measures:
                   ME     RMSE      MAE       MPE     MAPE     MASE        ACF1
Training set 0.864453 5.931761 4.092168 -1.363101 15.06142 0.558023 -0.03746012         Point Forecast    Lo 80     Hi 80     Lo 95     Hi 95
Jan 2018       32.48390 23.31571  41.65208 18.462370  46.50543
Feb 2018       23.77181 14.59632  32.94731  9.739103  37.80452
Mar 2018       45.85265 35.59989  56.10541 30.172412  61.53289
Apr 2018       46.20475 35.63662  56.77287 30.042185  62.36730
May 2018       44.08009 32.93968  55.22051 27.042295  61.11789
Jun 2018       44.61784 33.06359  56.17210 26.947139  62.28855
Jul 2018       40.36072 28.34867  52.37277 21.989869  58.73157
Aug 2018       44.48366 32.05796  56.90937 25.480189  63.48714
Sep 2018       73.42488 60.58630  86.26346 53.789962  93.05979
Oct 2018       51.45299 38.22024  64.68573 31.215253  71.69072
Nov 2018       72.43955 58.82134  86.05775 51.612293  93.26680
Dec 2018       89.44597 75.45417 103.43777 68.047363 110.84458</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index.out%203_files/figure-html/cell-19-output-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="index.out%203_files/figure-html/cell-19-output-2.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>ETS(M,N,A) 

Call:
ets(y = paper_ts)

  Smoothing parameters:
    alpha = 0.3075 
    gamma = 1e-04 

  Initial states:
    l = 22.5954 
    s = 17.4472 16.5763 -4.1253 15.2986 0.421 -5.102
           -0.6145 -0.0341 -7.985 -2.6766 -15.6576 -13.5481

  sigma:  0.2365

     AIC     AICc      BIC 
365.1517 380.1517 393.2197 

Training set error measures:
                   ME     RMSE      MAE     MPE     MAPE      MASE       ACF1
Training set 1.450303 6.386648 4.166875 1.75373 14.03399 0.5245018 0.03600045         Point Forecast    Lo 80    Hi 80    Lo 95    Hi 95
Jan 2018       30.45588 21.22661 39.68516 16.34092 44.57085
Feb 2018       28.34651 19.27484 37.41819 14.47258 42.22044
Mar 2018       41.32776 28.18367 54.47185 21.22561 61.42990
Apr 2018       36.01933 23.73891 48.29976 17.23804 54.80062
May 2018       43.97017 29.09477 58.84557 21.22021 66.72013
Jun 2018       43.39031 28.07408 58.70653 19.96616 66.81445
Jul 2018       38.90220 24.12853 53.67588 16.30782 61.49659
Aug 2018       44.42410 27.84663 61.00158 19.07104 69.77717
Sep 2018       59.30522 38.44478 80.16566 27.40193 91.20850
Oct 2018       39.87917 22.81850 56.93984 13.78712 65.97122
Nov 2018       60.58102 38.27853 82.88352 26.47230 94.68975
Dec 2018       61.45110 38.17748 84.72473 25.85717 97.04504</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index.out%203_files/figure-html/cell-19-output-4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="index.out%203_files/figure-html/cell-19-output-4.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>ETS(M,A,A) 

Call:
ets(y = furnishings_ts)

  Smoothing parameters:
    alpha = 0.0438 
    beta  = 0.0437 
    gamma = 2e-04 

  Initial states:
    l = 15.4275 
    b = -0.1137 
    s = 13.3158 15.6269 -2.2962 10.1503 -5.0017 -2.448
           -3.4406 -1.0728 -1.1262 -4.3688 -11.689 -7.6497

  sigma:  0.2527

     AIC     AICc      BIC 
338.8888 359.2888 370.6992 

Training set error measures:
                    ME     RMSE      MAE        MPE    MAPE      MASE
Training set 0.6402485 3.793384 2.884208 -0.8302416 16.2441 0.5352139
                   ACF1
Training set 0.04613441         Point Forecast    Lo 80    Hi 80     Lo 95    Hi 95
Jan 2018       21.37433 14.45350 28.29515 10.789837 31.95882
Feb 2018       18.56644 12.52244 24.61044  9.322944 27.80994
Mar 2018       27.11574 18.26943 35.96205 13.586481 40.64500
Apr 2018       31.58782 21.22159 41.95404 15.734048 47.44158
May 2018       32.87189 21.95559 43.78819 16.176845 49.56693
Jun 2018       31.73384 20.95052 42.51717 15.242170 48.22551
Jul 2018       33.95710 22.18459 45.72960 15.952604 51.96159
Aug 2018       32.63192 20.83816 44.42569 14.594916 50.66893
Sep 2018       49.01546 31.92061 66.11032 22.871140 75.15979
Oct 2018       37.79884 23.38308 52.21460 15.751844 59.84584
Nov 2018       56.95159 36.44698 77.45621 25.592490 88.31070
Dec 2018       55.87232 34.96477 76.77986 23.896983 87.84765</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index.out%203_files/figure-html/cell-19-output-6.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="index.out%203_files/figure-html/cell-19-output-6.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div></div>
<div id="f8eeee18-be73-42bd-a9af-4a2e0c6ca7f1" class="cell markdown">
<section id="applying-to-all-data-5b" class="level3">
<h3 class="anchored" data-anchor-id="applying-to-all-data-5b">Applying to all data (5b)</h3>
<p>In this session, we first grouped the sub-categories into clusters based on key time-series features, including trend strength, seasonal strength, and random strength, using hierarchical clustering. Once the clusters were formed, we applied and evaluated multiple forecasting models—ARIMA, Holt-Winters, and ETS—on each sub-category within its respective cluster, comparing their accuracy metrics such as RMSE and MAPE. Based on the evaluation results, we selected the best-performing model for each sub-category and used it to forecast the future outcomes within a year, leveraging the clustering to enhance the accuracy and relevance of our predictions.</p>
</section>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [34]:</pre></div><div id="ab64e665-6b42-459c-bccf-024372777cd5" class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Cluster_Binders-&gt;Holt-Winters</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>cluster_id <span class="op">&lt;-</span> <span class="dv">1</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>subcategory <span class="op">&lt;-</span> <span class="st">"Binders"</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>hw_model <span class="op">&lt;-</span> forecast_results_by_cluster[[paste0(<span class="st">"Cluster_"</span>, cluster_id)]][[subcategory]]$HoltWinters$Model</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>hw_forecast <span class="op">&lt;-</span> forecast(hw_model, h <span class="op">=</span> <span class="dv">12</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(hw_forecast)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>plot(hw_forecast, main <span class="op">=</span> <span class="st">"Holt-Winters Forecast for Binders (Next 12 Months)"</span>, xlab <span class="op">=</span> <span class="st">"Time"</span>, ylab <span class="op">=</span> <span class="st">"Forecasted Values"</span>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Cluster_paper-&gt;ETS</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>cluster_id <span class="op">&lt;-</span> <span class="dv">2</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>subcategory <span class="op">&lt;-</span> <span class="st">"Paper"</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>ets_model <span class="op">&lt;-</span> forecast_results_by_cluster[[paste0(<span class="st">"Cluster_"</span>, cluster_id)]][[subcategory]]$ETS$Model</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>ets_forecast <span class="op">&lt;-</span> forecast(ets_model, h <span class="op">=</span> <span class="dv">12</span>)</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ets_forecast)</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>plot(ets_forecast, main <span class="op">=</span> <span class="st">"ETS Forecast for Paper (Next 12 Months)"</span>, xlab <span class="op">=</span> <span class="st">"Time"</span>, ylab <span class="op">=</span> <span class="st">"Forecasted Values"</span>)</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Cluster_Furnishings-&gt;Holt-Winters</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>cluster_id <span class="op">&lt;-</span> <span class="dv">3</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>subcategory <span class="op">&lt;-</span> <span class="st">"Furnishings"</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>hw_model <span class="op">&lt;-</span> forecast_results_by_cluster[[paste0(<span class="st">"Cluster_"</span>, cluster_id)]][[subcategory]]$HoltWinters$Model</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>hw_forecast <span class="op">&lt;-</span> forecast(hw_model, h <span class="op">=</span> <span class="dv">12</span>)</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(hw_forecast)</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>plot(hw_forecast, main <span class="op">=</span> <span class="st">"Holt-Winters Forecast for Furnishings (Next 12 Months)"</span>, xlab <span class="op">=</span> <span class="st">"Time"</span>, ylab <span class="op">=</span> <span class="st">"Forecasted Values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div id="a31e24f8-005c-4a87-a208-e094cf300cba" class="cell markdown">
<section id="forecast-interpretation" class="level2">
<h2 class="anchored" data-anchor-id="forecast-interpretation">6 Forecast interpretation</h2>
<p>Lorem Ipsum</p>
<p><br></p>
</section>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [36]:</pre></div><div id="9e0e90ef-3751-4197-9787-b5c58c1e9c6f" class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for missing values</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>missing_values <span class="op">&lt;-</span> colSums(<span class="kw">is</span>.na(data))</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(missing_values)  <span class="co"># Print missing values for reference</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># heat map</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>library(Amelia)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>missmap(data, main <span class="op">=</span> <span class="st">"Missing Data Pattern"</span>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co">#distribution of key variables</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co">#plot Quantity</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>ggplot(data, aes(x <span class="op">=</span> Quantity)) <span class="op">+</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  geom_histogram(binwidth <span class="op">=</span> <span class="dv">1</span>, fill <span class="op">=</span> <span class="st">"steelblue"</span>) <span class="op">+</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  labs(title <span class="op">=</span> <span class="st">"Distribution of Quantity"</span>, x <span class="op">=</span> <span class="st">"Quantity"</span>, y <span class="op">=</span> <span class="st">"Frequency"</span>) <span class="op">+</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  theme_minimal()</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="co">#plot sales</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>ggplot(data, aes(x <span class="op">=</span> Sales)) <span class="op">+</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  geom_histogram(binwidth <span class="op">=</span> <span class="dv">50</span>, fill <span class="op">=</span> <span class="st">"tomato"</span>) <span class="op">+</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>  labs(title <span class="op">=</span> <span class="st">"Distribution of Sales"</span>, x <span class="op">=</span> <span class="st">"Sales"</span>, y <span class="op">=</span> <span class="st">"Frequency"</span>) <span class="op">+</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>  theme_minimal()</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a><span class="co"># plot profit</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>ggplot(data, aes(x <span class="op">=</span> Profit)) <span class="op">+</span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>  geom_histogram(binwidth <span class="op">=</span> <span class="dv">10</span>, fill <span class="op">=</span> <span class="st">"purple"</span>) <span class="op">+</span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>  labs(title <span class="op">=</span> <span class="st">"Distribution of Profit"</span>, x <span class="op">=</span> <span class="st">"Profit"</span>, y <span class="op">=</span> <span class="st">"Frequency"</span>) <span class="op">+</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>  theme_minimal()</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a><span class="co"># time based trends</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>data$Order_Date <span class="op">&lt;-</span> <span class="im">as</span>.Date(data$Order_Date, <span class="bu">format</span> <span class="op">=</span> <span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st">"</span>)  <span class="co"># Ensure date format</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>time_series <span class="op">&lt;-</span> data <span class="op">%&gt;%</span></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>  group_by(Order_Date) <span class="op">%&gt;%</span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>  summarize(total_sales <span class="op">=</span> <span class="bu">sum</span>(Sales), total_profit <span class="op">=</span> <span class="bu">sum</span>(Profit), total_quantity <span class="op">=</span> <span class="bu">sum</span>(Quantity))</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>ggplot(time_series, aes(x <span class="op">=</span> Order_Date)) <span class="op">+</span></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>  geom_line(aes(y <span class="op">=</span> total_sales, color <span class="op">=</span> <span class="st">"Sales"</span>)) <span class="op">+</span></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>  geom_line(aes(y <span class="op">=</span> total_profit, color <span class="op">=</span> <span class="st">"Profit"</span>)) <span class="op">+</span></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>  geom_line(aes(y <span class="op">=</span> total_quantity, color <span class="op">=</span> <span class="st">"Quantity"</span>)) <span class="op">+</span></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>  labs(title <span class="op">=</span> <span class="st">"Sales, Profit, and Quantity Over Time"</span>, x <span class="op">=</span> <span class="st">"Date"</span>, y <span class="op">=</span> <span class="st">"Value"</span>) <span class="op">+</span></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>  theme_minimal() <span class="op">+</span></span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>  scale_color_manual(name <span class="op">=</span> <span class="st">"Metrics"</span>, values <span class="op">=</span> c(<span class="st">"Sales"</span> <span class="op">=</span> <span class="st">"blue"</span>, <span class="st">"Profit"</span> <span class="op">=</span> <span class="st">"green"</span>, <span class="st">"Quantity"</span> <span class="op">=</span> <span class="st">"red"</span>))</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a><span class="co">#sales by category and sub category</span></span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>category_sales <span class="op">&lt;-</span> data <span class="op">%&gt;%</span></span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>  group_by(Category, Sub_Category) <span class="op">%&gt;%</span></span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>  summarize(total_sales <span class="op">=</span> <span class="bu">sum</span>(Sales))</span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a>ggplot(category_sales, aes(x <span class="op">=</span> reorder(Sub_Category, <span class="op">-</span>total_sales), y <span class="op">=</span> total_sales, fill <span class="op">=</span> Category)) <span class="op">+</span></span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a>  geom_bar(stat <span class="op">=</span> <span class="st">"identity"</span>) <span class="op">+</span></span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a>  labs(title <span class="op">=</span> <span class="st">"Sales by Category and Sub-Category"</span>, x <span class="op">=</span> <span class="st">"Sub-Category"</span>, y <span class="op">=</span> <span class="st">"Total Sales"</span>) <span class="op">+</span></span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a>  theme_minimal() <span class="op">+</span></span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a>  coord_flip()</span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a><span class="co">#Outliers detection</span></span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a><span class="co">#Quantity</span></span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a>ggplot(data, aes(x <span class="op">=</span> Category, y <span class="op">=</span> Quantity)) <span class="op">+</span></span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a>  geom_boxplot() <span class="op">+</span></span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a>  labs(title <span class="op">=</span> <span class="st">"Boxplot of Quantity by Category"</span>, x <span class="op">=</span> <span class="st">"Category"</span>, y <span class="op">=</span> <span class="st">"Quantity"</span>)</span>
<span id="cb33-53"><a href="#cb33-53" aria-hidden="true" tabindex="-1"></a><span class="co">#sales</span></span>
<span id="cb33-54"><a href="#cb33-54" aria-hidden="true" tabindex="-1"></a>ggplot(data, aes(x <span class="op">=</span> Category, y <span class="op">=</span> Sales)) <span class="op">+</span></span>
<span id="cb33-55"><a href="#cb33-55" aria-hidden="true" tabindex="-1"></a>  geom_boxplot() <span class="op">+</span></span>
<span id="cb33-56"><a href="#cb33-56" aria-hidden="true" tabindex="-1"></a>  labs(title <span class="op">=</span> <span class="st">"Boxplot of Sales by Category"</span>, x <span class="op">=</span> <span class="st">"Category"</span>, y <span class="op">=</span> <span class="st">"Sales"</span>)</span>
<span id="cb33-57"><a href="#cb33-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-58"><a href="#cb33-58" aria-hidden="true" tabindex="-1"></a><span class="co">#profit</span></span>
<span id="cb33-59"><a href="#cb33-59" aria-hidden="true" tabindex="-1"></a>ggplot(data, aes(x <span class="op">=</span> Category, y <span class="op">=</span> Profit)) <span class="op">+</span></span>
<span id="cb33-60"><a href="#cb33-60" aria-hidden="true" tabindex="-1"></a>  geom_boxplot() <span class="op">+</span></span>
<span id="cb33-61"><a href="#cb33-61" aria-hidden="true" tabindex="-1"></a>  labs(title <span class="op">=</span> <span class="st">"Boxplot of Profit by Category"</span>, x <span class="op">=</span> <span class="st">"Category"</span>, y <span class="op">=</span> <span class="st">"Profit"</span>)</span>
<span id="cb33-62"><a href="#cb33-62" aria-hidden="true" tabindex="-1"></a><span class="co">#Geo visualization</span></span>
<span id="cb33-63"><a href="#cb33-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-64"><a href="#cb33-64" aria-hidden="true" tabindex="-1"></a>us_map <span class="op">&lt;-</span> map_data(<span class="st">"state"</span>)</span>
<span id="cb33-65"><a href="#cb33-65" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="st">"State"</span> <span class="op">%</span><span class="kw">in</span><span class="op">%</span> colnames(data)) {</span>
<span id="cb33-66"><a href="#cb33-66" aria-hidden="true" tabindex="-1"></a>  state_sales <span class="op">&lt;-</span> data <span class="op">%&gt;%</span></span>
<span id="cb33-67"><a href="#cb33-67" aria-hidden="true" tabindex="-1"></a>    group_by(State) <span class="op">%&gt;%</span></span>
<span id="cb33-68"><a href="#cb33-68" aria-hidden="true" tabindex="-1"></a>    summarize(total_sales <span class="op">=</span> <span class="bu">sum</span>(Sales))</span>
<span id="cb33-69"><a href="#cb33-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-70"><a href="#cb33-70" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert state names to lowercase to match map data</span></span>
<span id="cb33-71"><a href="#cb33-71" aria-hidden="true" tabindex="-1"></a>  state_sales$State <span class="op">&lt;-</span> tolower(state_sales$State)</span>
<span id="cb33-72"><a href="#cb33-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-73"><a href="#cb33-73" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Merge state sales data with map data</span></span>
<span id="cb33-74"><a href="#cb33-74" aria-hidden="true" tabindex="-1"></a>  state_sales_map <span class="op">&lt;-</span> merge(us_map, state_sales, by.x <span class="op">=</span> <span class="st">"region"</span>, by.y <span class="op">=</span> <span class="st">"State"</span>, <span class="bu">all</span>.x <span class="op">=</span> TRUE)</span>
<span id="cb33-75"><a href="#cb33-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-76"><a href="#cb33-76" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot sales by state</span></span>
<span id="cb33-77"><a href="#cb33-77" aria-hidden="true" tabindex="-1"></a>  ggplot(state_sales_map, aes(<span class="bu">long</span>, lat, group <span class="op">=</span> group, fill <span class="op">=</span> total_sales)) <span class="op">+</span></span>
<span id="cb33-78"><a href="#cb33-78" aria-hidden="true" tabindex="-1"></a>    geom_polygon(color <span class="op">=</span> <span class="st">"white"</span>) <span class="op">+</span></span>
<span id="cb33-79"><a href="#cb33-79" aria-hidden="true" tabindex="-1"></a>    scale_fill_continuous(low <span class="op">=</span> <span class="st">"lightblue"</span>, high <span class="op">=</span> <span class="st">"darkblue"</span>, na.value <span class="op">=</span> <span class="st">"gray90"</span>) <span class="op">+</span></span>
<span id="cb33-80"><a href="#cb33-80" aria-hidden="true" tabindex="-1"></a>    labs(title <span class="op">=</span> <span class="st">"Sales by State"</span>, fill <span class="op">=</span> <span class="st">"Total Sales"</span>) <span class="op">+</span></span>
<span id="cb33-81"><a href="#cb33-81" aria-hidden="true" tabindex="-1"></a>    theme_void() <span class="op">+</span></span>
<span id="cb33-82"><a href="#cb33-82" aria-hidden="true" tabindex="-1"></a>    coord_fixed(<span class="fl">1.3</span>)</span>
<span id="cb33-83"><a href="#cb33-83" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-84"><a href="#cb33-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-85"><a href="#cb33-85" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation matrix</span></span>
<span id="cb33-86"><a href="#cb33-86" aria-hidden="true" tabindex="-1"></a>numerical_data <span class="op">&lt;-</span> data <span class="op">%&gt;%</span> select(where(<span class="kw">is</span>.numeric))</span>
<span id="cb33-87"><a href="#cb33-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-88"><a href="#cb33-88" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="op">&lt;-</span> cor(numerical_data, use <span class="op">=</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb33-89"><a href="#cb33-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-90"><a href="#cb33-90" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the correlation matrix to a long format</span></span>
<span id="cb33-91"><a href="#cb33-91" aria-hidden="true" tabindex="-1"></a>cor_data <span class="op">&lt;-</span> <span class="im">as</span>.data.frame(<span class="im">as</span>.table(cor_matrix))</span>
<span id="cb33-92"><a href="#cb33-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-93"><a href="#cb33-93" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the correlation matrix using ggplot2</span></span>
<span id="cb33-94"><a href="#cb33-94" aria-hidden="true" tabindex="-1"></a>ggplot(cor_data, aes(Var1, Var2, fill <span class="op">=</span> Freq)) <span class="op">+</span></span>
<span id="cb33-95"><a href="#cb33-95" aria-hidden="true" tabindex="-1"></a>  geom_tile(color <span class="op">=</span> <span class="st">"white"</span>) <span class="op">+</span></span>
<span id="cb33-96"><a href="#cb33-96" aria-hidden="true" tabindex="-1"></a>  scale_fill_gradient2(low <span class="op">=</span> <span class="st">"blue"</span>, high <span class="op">=</span> <span class="st">"red"</span>, mid <span class="op">=</span> <span class="st">"white"</span>,</span>
<span id="cb33-97"><a href="#cb33-97" aria-hidden="true" tabindex="-1"></a>                       midpoint <span class="op">=</span> <span class="dv">0</span>, limit <span class="op">=</span> c(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), space <span class="op">=</span> <span class="st">"Lab"</span>,</span>
<span id="cb33-98"><a href="#cb33-98" aria-hidden="true" tabindex="-1"></a>                       name<span class="op">=</span><span class="st">"Correlation"</span>) <span class="op">+</span></span>
<span id="cb33-99"><a href="#cb33-99" aria-hidden="true" tabindex="-1"></a>  geom_text(aes(label <span class="op">=</span> <span class="bu">round</span>(Freq, <span class="dv">2</span>)), color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="dv">4</span>) <span class="op">+</span></span>
<span id="cb33-100"><a href="#cb33-100" aria-hidden="true" tabindex="-1"></a>  theme_minimal() <span class="op">+</span></span>
<span id="cb33-101"><a href="#cb33-101" aria-hidden="true" tabindex="-1"></a>  theme(axis.text.x <span class="op">=</span> element_text(angle <span class="op">=</span> <span class="dv">45</span>, vjust <span class="op">=</span> <span class="dv">1</span>,</span>
<span id="cb33-102"><a href="#cb33-102" aria-hidden="true" tabindex="-1"></a>                                   size <span class="op">=</span> <span class="dv">12</span>, hjust <span class="op">=</span> <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb33-103"><a href="#cb33-103" aria-hidden="true" tabindex="-1"></a>  coord_fixed() <span class="op">+</span></span>
<span id="cb33-104"><a href="#cb33-104" aria-hidden="true" tabindex="-1"></a>  labs(title <span class="op">=</span> <span class="st">"Correlation Matrix of Key Variables"</span>, x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div id="9eb81adb-f195-4fb7-99c2-5bec9dafa4f3" class="cell markdown">
<section id="forecasting" class="level3">
<h3 class="anchored" data-anchor-id="forecasting">Forecasting??</h3>
</section>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [38]:</pre></div><div id="bfdcbb8b-b0e8-4f36-b5d0-064849e1bbe0" class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Aggregate sales per month</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>monthly_sales <span class="op">&lt;-</span> data <span class="op">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  mutate(Month <span class="op">=</span> floor_date(Order_Date, <span class="st">"month"</span>)) <span class="op">%&gt;%</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  group_by(Month) <span class="op">%&gt;%</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  summarize(total_sales <span class="op">=</span> <span class="bu">sum</span>(Sales))</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Convert to time series</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>sales_ts <span class="op">&lt;-</span> ts(monthly_sales$total_sales, frequency <span class="op">=</span> <span class="dv">12</span>, start <span class="op">=</span> c(year(<span class="bu">min</span>(monthly_sales$Month)), month(<span class="bu">min</span>(monthly_sales$Month))))</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Arima model</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>arima_model <span class="op">&lt;-</span> auto.arima(sales_ts)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>arima_forecast <span class="op">&lt;-</span> forecast(arima_model, h <span class="op">=</span> <span class="dv">12</span>)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>autoplot(arima_forecast) <span class="op">+</span> labs(title <span class="op">=</span> <span class="st">"ARIMA Forecast for Monthly Sales"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index.out%203_files/figure-html/cell-22-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="index.out%203_files/figure-html/cell-22-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index.out%203_files/figure-html/cell-22-output-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img src="index.out%203_files/figure-html/cell-22-output-2.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index.out%203_files/figure-html/cell-22-output-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img src="index.out%203_files/figure-html/cell-22-output-3.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div></div>
     </main>
<!-- /main column -->  <script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>  </div> <!-- /content -->  <script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script> 
  
</body></html>